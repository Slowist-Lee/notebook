好的，这是一份根据您提供的课件整理的关于 **信号空间 (Signal Space)** 的 Obsidian Markdown 笔记。笔记涵盖了课件中的所有知识点，并使用了相应的格式。

---

# Lecture 9: 信号空间 (Signal Space)

> 讲师: Prof. An Liu
> 单位: College of ISEE, Zhejiang University

## 教学安排

**M元数字传输 (M-ary Digital Transmission)**
- 引言 (Introduction)
- **信号空间概念 (Signal Space Concepts)**
- 基向量/基函数 (Basis Vectors/functions)
- 正交基的确定 (Determination of an orthogonal basis set)
    - **格拉姆-施密特正交化 (Gram-Schmidt Orthogonalization)**

---

## 1. 信号空间概念与信号表示

### 核心思想

> [!note] 核心思想
> 分析和理解数字传输性能的关键在于认识到：通信中使用的**信号**可以被**图形化地表示和可视化**。

因此，我们需要理解信号空间概念在数字通信中的应用。

### 总体目标

- 从**基本观点**分析数字信号检测问题。
- 从**几何角度**理解数字调制与解调。
    - 更易于理解。
    - 无需复杂的数学推导即可获得有用的设计思路。
    - 引入**信号空间**的概念。

### 信号空间概念的优势

信号空间概念提供了一种更通用的方式来审视调制方案。通过为信号星座图选择一组适当的坐标轴，我们可以：
- 设计具有期望特性的调制类型。
- 为给定的调制技术构建最优接收机。
- 使用非常通用的技术分析调制方案的性能。

### 时域与几何域的转换

信号的表示方法可以从时域转换到几何域，反之亦然。

- **时域表示**: $s(t)$
- **几何域表示**: $\mathbf{s}$

![[Pasted image 20240521150000.png]]
*图：信号的几何表示*

---

## 2. 信号的表示方法

### (1) 时域 (Time Domain)

- 信号由时间函数 $s(t)$ 表示。
- 可以观察到信号的**波形**。
- **周期信号**:
    - 定义: $S(t+T) = s(t)$，其中 $T$ 是周期。
    - 频率: $f = 1/T$ (Hz)。

![[Pasted image 20240521150100.png]]
*图：时域中的正弦信号*

### (2) 频域 (Frequency Domain)

- 信号也可以由频率函数 $S(f)$ 表示。
- 对于非周期信号，可以分解为不同“sin”和“cos”分量的组合。
- 每个分量有不同的**幅度、频率和相位**。
- **傅里叶变换 (Fourier Transform)**:
    - 变换方程 (正变换):
    $$
    F(f) = \int_{-\infty}^{\infty} f(t) \exp(-j2\pi ft) dt
    $$
    - 分析方程 (逆变换):
    $$
    f(t) = \int_{-\infty}^{\infty} F(f) \exp(j2\pi ft) df
    $$

### (3) 几何域 (Geometric Domain / Signal Space)

- 信号 $s(t)$ 被表示为一个带坐标的“向量” $\mathbf{s}$。
- 为了使向量有意义，我们首先需要定义**空间**，即需要一个**参考系 (frame-of-reference)**，由 "x轴", "y轴" 等定义。

#### 信号的几何表示步骤

> [!summary] 两步法
> 1. **定义空间**: 给定一个包含 $M$ 个信号的集合 $\{s_1(t), s_2(t), ..., s_M(t)\}$，定义一个由基函数 $\{\phi_1(t), \phi_2(t), ..., \phi_D(t)\}$ 张成的 D 维信号空间。
> 2. **确定坐标**: 计算每个信号在该空间中的坐标。
>    - $s_i(t) \rightarrow \mathbf{s_i} = (s_{i1}, s_{i2}, ..., s_{iD})$
>    - 坐标计算公式:
>      $$
>      s_{ij} = \int_{0}^{T_s} s_i(t) \phi_j(t) dt
>      $$

### 不同域的统一性

时域 ($x(t)$), 频域 ($X(f)$), 和几何域 ($\mathbf{x}$) 只是观察同一个事物的不同视角。无论从哪个域计算，其物理特性（如能量）都是相同的。

- **时域能量**:
$$
E = \int_{0}^{T} |x(t)|^2 dt
$$
- **频域能量 (Parseval 定理)**:
$$
E = \int_{-\infty}^{\infty} |X(f)|^2 df
$$
- **几何域能量**:
$$
E = \langle \mathbf{x}, \mathbf{x} \rangle = ||\mathbf{x}||^2
$$

---

## 3. 信号空间与基函数

### 示例

#### 示例 1

- **问题**: 考虑下图所示的4个信号，找到包含这4个信号的信号空间的一组标准正交基函数。

![[Pasted image 20240521150200.png]]

- **解**:
    - **基函数**:
      ![[Pasted image 20240521150300.png]]
    - **星座图**:
      ![[Pasted image 20240521150400.png]]

#### 示例 2

- **问题**: 考虑以下信号集:
  ![[Pasted image 20240521150500.png]]
- **解**:
    - 通过观察，信号可以由以下两个**基函数**表示：
    $$
    f_1(t) = \text{rect}(t-0.5)
    $$
    $$
    f_2(t) = \text{rect}(t-3/2)
    $$
    - **星座图 (Constellation Diagram)**:
      ![[Pasted image 20240521150600.png]]

### 关键结论

- 两个完全不同的信号集可以有**相同的几何表示**。
- 信号集的**内在几何结构**决定了其**性能**和**接收机结构**。
- 在前面的例子中，我们靠观察“猜出”了正确的基函数。
- **问题**: 对于任意信号集，是否有系统的方法来找到一个完备的标准正交基？
- **答案**: **格拉姆-施密特正交化 (Gram-Schmidt Orthogonalization, GSO) 过程**。

---

## 4. 向量空间理论基础

### 向量空间 (Vector Space)

> [!abstract] 定义：向量空间
> 在域 $F$ 上的向量空间 $V$ 是一组称为“向量”的“抽象对象”的集合。
> - $V$ 的元素称为**向量 (Vectors)**。
> - $F$ 的元素称为**标量 (Scalars)**。
> - 空间内定义了两种基本运算：向量加法和标量乘法，并满足以下公理：
>   - **加法结合律**: $u + (v + w) = (u + v) + w$
>   - **加法交换律**: $u + v = v + u$
>   - **加法单位元**: 存在 $0 \in V$，使得对所有 $u \in V$，有 $0 + u = u$。
>   - **加法逆元**: 对每个 $v \in V$，存在 $-v \in V$，使得 $v + (-v) = 0$。
>   - **标量乘法对向量加法的分配律**: $a(u+v) = au + av$
>   - **标量乘法对域加法的分配律**: $(a + b)u = au + bu$
>   - **标量乘法兼容性**: $a(bv) = (ab)v$
>   - **标量乘法单位元**: 存在 $1 \in F$，使得对所有 $v \in V$，有 $1v = v$。

**示例**:
- **实数坐标空间**: $V = \{(a_1, ..., a_n): a_i \in \mathbb{R}\}$
- **复数坐标空间**: $V = \{(a_1, ..., a_n): a_i \in \mathbb{C}\}$
- **函数空间 (信号空间)**: 从任意固定域到域 $F$ 的函数集合也构成一个向量空间。例如，时间函数 $t \rightarrow \mathbb{R}$。

### 内积空间 (Inner Product Space)

- 普通的向量空间 $(V, F)$ 没有几何（或拓扑）概念，如距离、角度等。
- 这些概念需要引入“**范数 (norm)**”和“**内积 (inner product)**”。

> [!abstract] 定义：内积空间
> 一个带有“内积”运算的向量空间 $(V, F)$ 称为内积空间。
> - **内积**是一个映射 $\langle u,v \rangle: V \times V \rightarrow F$，满足以下公理：
>   - $\langle u,v \rangle = \langle v,u \rangle^*$ (*表示共轭)
>   - $\langle u+v, w \rangle = \langle u,w \rangle + \langle v,w \rangle$
>   - $\langle au,v \rangle = a\langle u,v \rangle$
>   - $\langle u,u \rangle \ge 0$ 且 $\langle u,u \rangle = 0$ 当且仅当 $u = 0$。

### 内积空间中的几何概念

- **向量长度 (范数)**: $||\mathbf{v}||^2 = \langle \mathbf{v},\mathbf{v} \rangle$
- **两向量间距离**: $||\mathbf{v}-\mathbf{w}||^2 = \langle (\mathbf{v}-\mathbf{w}),(\mathbf{v}-\mathbf{w}) \rangle$
- **两向量间夹角**: $\cos \theta = \frac{\langle \mathbf{v},\mathbf{w} \rangle}{||\mathbf{v}|| \cdot ||\mathbf{w}||}$
- **正交向量**: $\langle \mathbf{v},\mathbf{w} \rangle = 0$
- **球**: $(\mathbf{x}_c, r): ||\mathbf{x} - \mathbf{x}_c || = r$

### 向量空间定义与性质

- **n维空间**: 由n个基向量 $(\mathbf{e}_1, \mathbf{e}_2, ..., \mathbf{e}_n)$ 张成 (span)。空间中任意向量 $\mathbf{a}$ 可写为:
$$
\mathbf{a} = \sum_{i=1}^{n} a_i \mathbf{e}_i
$$
- **坐标表示**: $\mathbf{a} = \sum a_i \mathbf{e}_i \Leftrightarrow \mathbf{a} = (a_1, a_2, ..., a_n)$
- **内积**: $\langle \mathbf{a}, \mathbf{b} \rangle = \mathbf{a} \cdot \mathbf{b} = \sum_{i=1}^{n} a_i b_i$
- **正交**: $\mathbf{a} \cdot \mathbf{b} = 0$
- **范数**: $||\mathbf{a}|| = \sqrt{\langle \mathbf{a}, \mathbf{a} \rangle} = \sqrt{\sum a_i^2}$
- **标准正交基 (Orthonormal basis)**: 向量集中的向量两两相互正交，且每个向量的范数为1。
- **线性无关 (Independent)**: 向量组 $(\mathbf{a}_1, ..., \mathbf{a}_n)$ 是线性无关的，如果不存在不全为零的常数 $\alpha_1, ..., \alpha_n$ 使得 $\alpha_1 \mathbf{a}_1 + ... + \alpha_n \mathbf{a}_n = 0$。
- **三角不等式**: $||\mathbf{a}+\mathbf{b}|| \le ||\mathbf{a}|| + ||\mathbf{b}||$
- **柯西-施瓦茨不等式**: $|\mathbf{a} \cdot \mathbf{b}| \le ||\mathbf{a}|| \cdot ||\mathbf{b}||$
- **勾股定理**: 如果 $\mathbf{a} \perp \mathbf{b}$，则 $||\mathbf{a}+\mathbf{b}||^2 = ||\mathbf{a}||^2 + ||\mathbf{b}||^2$

---

## 5. 信号空间的构建

### 基本思想

> [!idea]
> 任何可以用n元组表示的实体都是一个n维向量。如果一个有限时长信号可以表示为n元组，那么它就是一个向量。

- 假设有一组有限时长 ($T_s$) 的基函数 $\{\phi_1(t), ..., \phi_n(t)\}$。
- 一个有限时长信号 $x(t)$ 可以表示为:
$$
x(t) = \sum_{i=1}^{n} x_i \phi_i(t)
$$
- 这建立了函数 $x(t)$ 与其坐标向量 $\mathbf{x} = (x_1, ..., x_n)$ 之间的一一对应关系。

### 信号的内积

> [!definition] 信号内积
> 对于信号 $x(t)$ 和 $y(t)$，其内积（点积）定义为：
> $$
> \langle x(t), y(t) \rangle = \int_{0}^{T_s} x(t) y^*(t) dt
> $$

- **正交基集**: $\{\phi_k(t)\}$ 是正交的，如果：
$$
\int_{-\infty}^{\infty} \phi_j(t) \phi_k(t) dt = \begin{cases} 0 & j \neq k \\ k_j & j = k \end{cases}
$$
- **标准正交基集 (Orthonormal)**: 如果对所有 $j$ 都有 $k_j = 1$，则该基集是标准正交的。
- 在标准正交基下：
    - **坐标计算**:
    $$
    x_k = \int_{-\infty}^{\infty} x(t) \phi_k(t) dt
    $$
    - **信号重构**:
    $$
    x(t) = \sum_{i=1}^{n} x_i \phi_i(t)
    $$
    - **向量表示**:
    $$
    \mathbf{x} = (x_1, x_2, ..., x_n)
    $$

### 关键性质总结

对于由标准正交基 $\{\phi_1(t), ..., \phi_n(t)\}$ 张成的信号空间 $S$：
1.  **内积计算**:
    若 $x(t) \Leftrightarrow \mathbf{x}$ 且 $y(t) \Leftrightarrow \mathbf{y}$，则
    $$
    \langle x(t), y(t) \rangle = \sum_{i=1}^{n} x_i y_i
    $$
2.  **能量计算**:
    - **时域法**: $E_s = \int_{0}^{T_s} |x(t)|^2 dt$
    - **频域法**: $E_s = \int_{-\infty}^{\infty} |X(f)|^2 df$
    - **几何域法**: $E_s = ||\mathbf{x}||^2 = \langle x(t), x(t) \rangle$

---

## 6. 格拉姆-施密特正交化 (Gram-Schmidt Orthogonalization)

解决之前提出的两个问题：
1.  如何找到包含信号集 $\{s_1(t), ..., s_M(t)\}$ 的信号空间（即基函数）？
2.  如何找到每个信号的坐标？

### 步骤 1: GSO求标准正交基

G-S过程可以从一个 $M$ 个信号（向量）的集合 $\{x_1, ..., x_M\}$ 中，找到一个能包含所有信号的最小维度的**标准正交基** $\{\phi_1, ..., \phi_D\}$。

> [!example] GSO 流程 (以向量为例)
> - **Step 1**:
> $$
> \tilde{\mathbf{v}}_1 = \mathbf{x}_1, \quad \mathbf{\phi}_1 = \frac{\tilde{\mathbf{v}}_1}{||\tilde{\mathbf{v}}_1||}
> $$
> - **Step 2**:
> $$
> \tilde{\mathbf{v}}_2 = \mathbf{x}_2 - \langle \mathbf{x}_2, \mathbf{\phi}_1 \rangle \mathbf{\phi}_1, \quad \mathbf{\phi}_2 = \frac{\tilde{\mathbf{v}}_2}{||\tilde{\mathbf{v}}_2||}
> $$
> - **Step m**:
> $$
> \tilde{\mathbf{v}}_m = \mathbf{x}_m - \sum_{i=1}^{m-1} \langle \mathbf{x}_m, \mathbf{\phi}_i \rangle \mathbf{\phi}_i, \quad \mathbf{\phi}_m = \frac{\tilde{\mathbf{v}}_m}{||\tilde{\mathbf{v}}_m||}
> $$
> (其中 $\langle \mathbf{x}_m, \mathbf{\phi}_i \rangle \mathbf{\phi}_i$ 是 $\mathbf{x}_m$ 在 $\mathbf{\phi}_i$ 上的投影)
> - 这个过程持续进行，直到 $m=M$ 或者 $\tilde{\mathbf{v}}_m = \mathbf{0}$。

> [!info] GSO for Signals
> 对于信号空间，流程完全相同，只需将向量内积替换为信号内积：
> $$
> \langle x(t), y(t) \rangle = \int x(t)y^*(t)dt
> $$

#### GSO 总结

1.  第一个基函数是第一个信号的归一化版本。
2.  后续的基函数通过从下一个信号中减去其在**已找到的所有基函数**上的投影分量，然后对结果进行归一化得到。
3.  重复此过程，直到找到所有基函数。

### 步骤 2: 计算坐标

一旦找到了包含 $M$ 个有限时长信号 $\{s_1(t), ..., s_M(t)\}$ 的标准正交基 $\{\phi_1(t), ..., \phi_D(t)\}$，每个信号 $s_i(t)$ 对应的坐标向量 $\mathbf{s}_i = (s_{i1}, ..., s_{iD})$ 就可以通过内积计算得出：

$$
s_{ij} = \langle s_i(t), \phi_j(t) \rangle = \int_{0}^{T_s} s_i(t) \phi_j^*(t) dt
$$

---

## 7. 综合示例

### 示例 1: 正弦信号

- **问题**:
    1.  考虑两个在 $[0, T)$ 上定义的信号：$s_0(t) = A\cos(2\pi f_c t)$ 和 $s_1(t) = A\sin(2\pi f_c t)$，其中 $f_c = n/T$ (n为整数)。求这两个信号的一组标准正交基。
    2.  如果现在有M元信号:
        $$
        s_i(t) = A\cos(\omega_c t + \frac{2\pi(m-1)}{M}) \quad m=1,2,...,M
        $$
        - 产生的信号空间的维度是多少？
        - 用基函数表示 $s_i(t)$ 并计算信号能量 $E_s$。

### 示例 2: 脉冲信号

![[Pasted image 20240521150700.png]]

- **问题**:
    a. 使用格拉姆-施密特过程找到上图所示信号对应的一组标准正交基函数。
    b. 用在(a)中找到的标准正交基函数表示信号 x1, x2, 和 x3。
    c. 绘制这些信号的星座图。    c. 绘制这些信号的星座图。