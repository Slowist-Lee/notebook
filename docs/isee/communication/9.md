好的，这是一份根据您提供的PPT精心制作的、面向新手的中文Markdown学习笔记。笔记内容完全遵循PPT的逻辑和内容，并使用Obsidian的callout语法来突出重点和例题，同时加入了您提供的习题作为实践案例，希望能帮助您跟着笔记一步步学会数字解调。

---

# Lecture 8: 数字解调


## 1. 课程回顾与引言

在深入探讨**数字解调 (Digital Demodulation)** 之前，我们先回顾一下它在整个数字通信系统中的位置。

![](Pasted%20image%2020251207223633.png)

一个完整的数字通信系统流程如下：
1.  **信源 (Source)** 产生模拟信号。
2.  通过 **A-D转换** 变成二进制比特流 (Bit sequence)。
3.  **数字调制** 将比特流转换成适合在信道中传输的波形。
4.  信号通过 **信道 (Channel)** 传输。
5.  **数字解调 (Digital Demodulation)** 在接收端，从接收到的波形中恢复出原始的比特流。
6.  通过 **D-A转换** 恢复成模拟信号，送达 **用户 (User)**。

本章的焦点是椭圆形框出的部分：**数字基带解调** 和 **数字带通解调**。

### 1.1 数字解调的核心任务

![](Pasted%20image%2020251207223627.png)

从上图可以看出，数字解调模块的输入是**“被破坏的数字波形 (Corrupted Digital waveform)”**，输出是恢复出的**比特序列 $\{\hat{b}_i\}$**。

> [!question] 本章要解决的核心问题
> 1.  **信号损坏的来源是什么？(What are the sources of signal corruption?)**
> 2.  **如何检测信号才能恢复出原始比特序列？(How to detect the signal?)**
> 3.  **如何评估恢复的保真度/性能？(How to evaluate the fidelity performance?)**

---

## 2. 信号损坏的来源：噪声

*请在这里插入第 4 页的图片*

假设我们已经合理选择了信道带宽，使得发送信号 $s(t)$ 的大部分频率分量都能通过信道。那么，信号损坏最主要的来源就是**热噪声 (Thermal Noise)**。

> [!important] 什么是热噪声？
> 热噪声是由电子设备内部电子的随机热运动引起的。它是一种普遍存在、无法避免的噪声源。

接收到的信号 $y(t)$ 可以表示为发送信号 $s(t)$ 和噪声 $n(t)$ 的叠加：
$$ y(t) = s(t) + n(t) $$

### 2.1 热噪声的数学模型 (AWGN)

为了分析和设计系统，我们需要一个数学模型来描述热噪声。

![|550](Pasted%20image%2020251207223649.png)
1.  **广义平稳过程 (WSS process)**: 热噪声 $n(t)$ 被建模为一个广义平稳随机过程。
2.  **加性 (Added/Superimposed)**: 噪声是“加”在信号上的，如上面的公式所示。
3.  **高斯性 (Gaussian)**: 在任意一个采样时刻 $t_0$，噪声的瞬时值 $n(t_0)$ 是一个服从高斯（正态）分布的随机变量。通常是**零均值**的，其概率密度函数为：
    $$ f_n(x) = \frac{1}{\sqrt{2\pi}\sigma_0} \exp\left(-\frac{x^2}{2\sigma_0^2}\right) $$
    其中 $\sigma_0^2$ 是噪声的方差，也代表了噪声的**功率**。
    
> [!tip] Q函数
> 在通信中，我们经常关心噪声值超过某个门限的概率，这通常用Q函数表示。
> $$ \text{Pr}\{X > a\} = \int_a^\infty f_n(x)dx = Q\left(\frac{a}{\sigma_0}\right) $$
> Q函数是标准正态分布的右尾概率。

![](Pasted%20image%2020251207223659.png)

4.  **白噪声 (White)**: 热噪声的功率谱密度 $G_n(f)$ 在一个非常宽的频率范围内（从直流到约 $10^{12}$ Hz）是**恒定**的。我们可以近似认为它在所有频率上都是常数。
    $$ G_n(f) = \frac{N_0}{2} $$
    这里的 $N_0/2$ 被称为**双边功率谱密度 (Two-sided Power Spectral Density)**。

> [!summary] AWGN 模型
> 综上所述，通信系统中最常用的噪声模型是**加性白高斯噪声 (Additive White Gaussian Noise, AWGN)**。它完美地概括了噪声的三个核心特性：
> *   **A**dditive: 加性
> *   **W**hite: 白噪声（频谱恒定）
> *   **G**aussian: 高斯分布

---

## 3. 数字信号的检测过程

有了被噪声污染的信号 $y(t) = s(t) + n(t)$，我们如何恢复出原始的比特呢？

![|475](Pasted%20image%2020251207223709.png)

> [!note] 三步检测法
> 1.  **滤波 (Filtering)**: 将接收信号 $y(t)$ 通过一个滤波器。这一步的主要目的是**尽可能地滤除信号频带外的噪声**，同时**最大化信号的幅度**，以提高信噪比。
> 2.  **采样 (Sampling)**: 在每个码元周期的特定时刻（最佳判决时刻）对滤波后的信号进行采样，得到一个采样值。
> 3.  **门限比较 (Threshold Comparison)**: 将采样值与一个或多个预设的门限（判决门限）进行比较，从而判断发送的原始比特是 "1" 还是 "0"。例如：
>     *   如果 `Sample > 0`，判为 `1`
>     *   如果 `Sample < 0`，判为 `0`

### 3.1 性能评估：误比特率 (BER)

![|550](Pasted%20image%2020251207223720.png)

我们的检测过程不可能百分之百正确，总会因为噪声的干扰而发生错误。评估解调器性能的核心指标就是**误比特率 (Bit Error Rate, BER)**。

> [!important] 误比特率 (BER)
> *   **比特错误 (Bit Error)**: 发送的比特 $b_i$ 和判决出的比特 $\hat{b}_i$ 不相等的情况。即发送'1'判成'0'，或发送'0'判成'1'。
>     $$ \{\hat{b}_i \neq b_i\} = \{\hat{b}_i=1 \text{ but } b_i = 0\} \cup \{\hat{b}_i=0 \text{ but } b_i = 1\} $$
> *   **误比特率 (BER, $P_b$)**: 发生比特错误的概率。
>     $$ P_b = \text{Pr}\{\hat{b}_i=1, b_i = 0\} + \text{Pr}\{\hat{b}_i=0, b_i = 1\} $$

![|475](Pasted%20image%2020251207223730.png)

> [!question] 核心设计目标
> 我们的终极目标是：
> **如何设计滤波器、采样时刻和判决门限，来最小化误比特率 (BER)？**

---

## 4. 最佳二元检测器 (Optimal Binary Detector)

现在，我们来系统地解决上面提出的问题。我们以二元检测（发送的信号只有两种可能，$s_1(t)$ 代表 '1', $s_2(t)$ 代表 '0'）为例进行分析。

### 4.1 接收机结构与信号分析

*请在这里插入第 11 和 12 页的图片*

1.  **输入**: 接收信号 $y(t) = s(t) + n(t)$。其中 $s(t)$ 是 $s_1(t)$ 或 $s_2(t)$， $n(t)$ 是双边功率谱密度为 $N_0/2$ 的白噪声。
2.  **滤波器**: $y(t)$ 通过一个冲激响应为 $h(t)$ 的滤波器，输出为 $z(t)$。
    $$ z(t) = y(t) * h(t) = (s(t)+n(t))*h(t) = s_o(t) + n_o(t) $$
    *   $s_o(t) = s(t)*h(t)$ 是信号分量。
    *   $n_o(t) = n(t)*h(t)$ 是噪声分量。
3.  **采样**: 在时刻 $t_0$ 对 $z(t)$ 采样，得到 $z(t_0)$。
4.  **判决**: 比较 $z(t_0)$ 和门限 $\lambda$。
    *   $z(t_0) > \lambda \implies \hat{b}_i = 1$
    *   $z(t_0) < \lambda \implies \hat{b}_i = 0$

> [!warning] 滤波后的噪声
> 原始噪声 $n(t)$ 是白噪声，但经过滤波器 $h(t)$ 之后，输出的噪声 $n_o(t)$ **不再是白噪声了**！因为滤波器的频率响应不是平坦的，它会改变噪声的功率谱。但是，$n_o(t)$ 仍然是高斯过程。

*请在这里插入第 13 页的图片*

在采样时刻 $t_0$，采样值 $z(t_0) = s_o(t_0) + n_o(t_0)$ 是一个高斯随机变量。
*   它的均值取决于发送的是 $s_1(t)$ 还是 $s_2(t)$。
*   它的方差 $\sigma_o^2$ 由滤波器 $h(t)$ 和输入噪声功率 $N_0/2$ 共同决定。

因此，我们可以得到条件概率分布：
*   **当发送'1'时**: $z(t_0)|_{b_i=1} \sim \mathcal{N}(s_{o,1}(t_0), \sigma_o^2)$
*   **当发送'0'时**: $z(t_0)|_{b_i=0} \sim \mathcal{N}(s_{o,2}(t_0), \sigma_o^2)$

### 4.2 误比特率 (BER) 计算

*请在这里插入第 14 页的图片*

假设发送 '1' 和 '0' 的概率相等，即 $\text{Pr}\{b_i=1\}=\text{Pr}\{b_i=0\}=1/2$。
$$
\begin{aligned}
P_b &= \text{Pr}\{\hat{b}_i=1, b_i=0\} + \text{Pr}\{\hat{b}_i=0, b_i=1\} \\
&= \text{Pr}\{z(t_0) > \lambda | b_i=0\}\text{Pr}\{b_i=0\} + \text{Pr}\{z(t_0) < \lambda | b_i=1\}\text{Pr}\{b_i=1\} \\
&= \frac{1}{2} \left[ \text{Pr}\{z(t_0) > \lambda | b_i=0\} + \text{Pr}\{z(t_0) < \lambda | b_i=1\} \right]
\end{aligned}
$$

*请在这里插入第 15 页的图片*

上图非常直观地展示了BER的来源。图中画出了发送'0'和'1'时，采样值 $z(t_0)$ 的两个条件概率密度函数。
*   当发送'0'时，理想情况下采样值应落在左边高斯分布的中心 $s_{o,2}(t_0)$ 附近。但如果因为噪声的巨大影响，采样值跑到了 $\lambda$ 的右边，就会被误判为'1'。这个错误的概率就是左边高斯分布在 $\lambda$ 右侧的面积。
*   同理，当发送'1'时，采样值落到 $\lambda$ 左边的概率（右边高斯分布在 $\lambda$ 左侧的面积）就是误判为'0'的概率。

总的BER就是图中**黄色区域面积**的一半。使用Q函数，我们可以把BER写成：
$$ P_b = \frac{1}{2} \left[ Q\left(\frac{\lambda - s_{o,2}(t_0)}{\sigma_o}\right) + Q\left(\frac{s_{o,1}(t_0) - \lambda}{\sigma_o}\right) \right] $$

### 4.3 寻找最佳判决门限 $\lambda^*$

*请在这里插入第 16 页的图片*

为了最小化BER，也就是最小化上图中的黄色区域面积，我们应该把门限 $\lambda$ 设在什么位置呢？
直观上看，当门限 $\lambda$ 恰好位于两个高斯分布交点处时，总的错误面积最小。这个位置就是两个均值的中点。

> [!important] 最佳判决门限
> $$ \lambda^* = \frac{s_{o,1}(t_0) + s_{o,2}(t_0)}{2} $$

将这个最佳门限代入BER公式，由于Q函数是偶对称的，两项会相等：
$$ P_b(\lambda^*) = \frac{1}{2} \left[ Q\left(\frac{s_{o,1}(t_0) - s_{o,2}(t_0)}{2\sigma_o}\right) + Q\left(\frac{s_{o,1}(t_0) - s_{o,2}(t_0)}{2\sigma_o}\right) \right] $$
> [!summary] 最佳门限下的BER
> $$ P_b(\lambda^*) = Q\left(\frac{s_{o,1}(t_0) - s_{o,2}(t_0)}{2\sigma_o}\right) $$

*请在这里插入第 17 页的图片*

将信号和方差的表达式代入，我们得到：
$$ P_b(\lambda^*) = Q\left( \frac{\left| \int_0^{t_0} [s_1(x)-s_2(x)]h(t_0-x)dx \right|}{2 \sqrt{\frac{N_0}{2} \int_0^{t_0} h^2(t_0-x)dx}} \right) = Q\left( \sqrt{ \frac{\left( \int_0^{t_0} [s_1(x)-s_2(x)]h(t_0-x)dx \right)^2}{2 N_0 \int_0^{t_0} h^2(t_0-x)dx} } \right) $$
> [!note]
> 此时，误码率 $P_b$ 只和**滤波器 $h(t)$** 和**采样时刻 $t_0$** 有关。下一步就是选择最优的 $h(t)$ 和 $t_0$ 来最小化 $P_b$。

### 4.4 寻找最佳滤波器 $h(t)$：匹配滤波器

最小化 $P_b$ 等价于最大化Q函数括号里的内容，也就是最大化在采样时刻 $t_0$ 的输出信噪比(SNR)。
$$ \text{SNR}_{out}(t_0) = \frac{|s_o(t_0)|^2}{\sigma_o^2} = \frac{\left| \int_0^{t_0} [s_1(x)-s_2(x)]h(t_0-x)dx \right|^2}{\frac{N_0}{2} \int_0^{t_0} h^2(t_0-x)dx} $$
我们令 $g(t) = s_1(t) - s_2(t)$ 为信号差，问题就变成了：找到 $h(t)$ 来最大化下面的表达式：

$$ \eta = \frac{\left| \int_{-\infty}^{\infty} G(f)H(f) e^{j2\pi f t_0} df \right|^2}{\frac{N_0}{2} \int_{-\infty}^{\infty} |H(f)|^2 df} $$
*请在这里插入第 18 页的图片*

这里可以使用**施瓦茨不等式 (Schwarz's inequality)** 来求解。
> [!abstract] 施瓦茨不等式
> 对于两个函数 $A(f)$ 和 $B(f)$，有：
> $$ \left| \int_{-\infty}^{\infty} A(f)B(f)df \right|^2 \le \int_{-\infty}^{\infty} |A(f)|^2 df \cdot \int_{-\infty}^{\infty} |B(f)|^2 df $$
> 等号成立的条件是 $A(f) = k \cdot B^*(f)$，其中 $k$ 是常数，$B^*(f)$ 是 $B(f)$ 的共轭。

通过巧妙地构造 $A(f)$ 和 $B(f)$，我们可以得到使 $\eta$ 最大的条件，即最佳滤波器的频率响应 $H_{opt}(f)$：
$$ H_{opt}(f) = k \cdot G^*(f) e^{-j2\pi f t_0} = k \cdot [S_1^*(f) - S_2^*(f)] e^{-j2\pi f t_0} $$
对其进行傅里叶反变换，得到最佳滤波器的时域冲激响应：
$$ h_{opt}(t) = k \cdot [s_1(t_0 - t) - s_2(t_0 - t)] $$

> [!important] 匹配滤波器 (Matched Filter)
> 这个最佳滤波器被称为**匹配滤波器**。它的冲激响应是**输入信号差 $g(t)=s_1(t)-s_2(t)$ 的时间反转、平移和缩放**。
>
> 它的名字由来是，滤波器的形状与期望信号的形状相“匹配”。

同时，可以证明，最佳的**采样时刻**应该是 $t_0 = \tau$ (码元结束的时刻)。
所以，最终的匹配滤波器为 (令 $k=1, t_0=\tau$):
$$ h(t) = s_1(\tau - t) - s_2(\tau - t), \quad 0 \le t \le \tau $$

*请在这里插入第 19 页的图片*

> [!example] 例题 9.11: 匹配滤波器的推导与实现
> (a) 假设输入为白噪声，使用施瓦茨不等式证明匹配滤波器的频率响应为 $H_m(f) = S^*(f) e^{-j2\pi f t_0}$。（注意：这里的 $S(f)$ 对应我们笔记里的 $G(f) = S_1(f)-S_2(f)$）。
>
> **解答 (a):**
> 我们的目标是最大化信噪比 $\eta$：
> $$ \eta = \frac{|s_o(t_0)|^2}{E[n_o^2(t)]} = \frac{|\int_{-\infty}^{\infty} S(f)H(f)e^{j2\pi f t_0}df|^2}{\frac{N_0}{2}\int_{-\infty}^{\infty}|H(f)|^2 df} $$
> 根据施瓦茨不等式 $\left|\int A(f)B(f)df\right|^2 \le \int|A(f)|^2 df \int|B(f)|^2 df$。
> 令 $A(f)=H(f)$ 和 $B(f)=S(f)e^{j2\pi f t_0}$。
> 那么分子 $|\int_{-\infty}^{\infty} H(f)[S(f)e^{j2\pi f t_0}]df|^2 \le \int_{-\infty}^{\infty}|H(f)|^2 df \cdot \int_{-\infty}^{\infty}|S(f)e^{j2\pi f t_0}|^2 df$。
> 因为 $|e^{j\theta}|=1$，所以 $\int|S(f)e^{j2\pi f t_0}|^2 df = \int|S(f)|^2 df$。
> 所以 $\eta \le \frac{\int|H(f)|^2 df \cdot \int|S(f)|^2 df}{\frac{N_0}{2}\int|H(f)|^2 df} = \frac{2}{N_0}\int|S(f)|^2 df = \frac{2E_s}{N_0}$ (其中$E_s$是信号$s(t)$的能量)。
> 这个最大值在等号成立时取到，条件是 $A(f)=k \cdot B^*(f)$，即：
> $$ H(f) = k \cdot [S(f)e^{j2\pi f t_0}]^* = k \cdot S^*(f)e^{-j2\pi f t_0} $$
> **证明完毕。** (取 $k=1$ 即可得到题中形式)
>
> (b) 证明(a)中频率响应对应的冲激响应为 $h_m(t) = s(t_0 - t)$。
>
> **解答 (b):**
> 我们对 $H_m(f) = S^*(f)e^{-j2\pi f t_0}$ 做傅里叶反变换。
> 我们知道 $\mathcal{F}^{-1}[S^*(f)] = s^*(-t)$。又根据傅里叶变换的时移性质 $\mathcal{F}[x(t-t_0)] = X(f)e^{-j2\pi f t_0}$。
> 所以 $\mathcal{F}^{-1}[S^*(f)e^{-j2\pi f t_0}]$ 是 $s^*(-t)$ 的时移，即 $s^*(t_0-t)$。
> 因为我们处理的信号 $s(t)$ 都是实信号，所以 $s^*(t)=s(t)$。
> 因此，$h_m(t) = s(t_0-t)$。 **证明完毕。**
>
> (c) 如果 $s(t)$ 在 $t>t_0$ 时不为零，则该滤波器是**非因果的 (noncausal)**，因为在 $t<0$ 时 $h_m(t)=s(t_0-t)$ 不为零，意味着在信号还没来的时候滤波器就有输出了。为了实现一个**可实现的 (realizable)** 滤波器，我们简单地将 $t<0$ 的部分截断：
> $$ h_{mr}(t) = \begin{cases} s(t_0-t), & t \ge 0 \\ 0, & t < 0 \end{cases} $$
> 现在考虑信号 $s(t)=A\Pi[(t-T/2)/T]$（一个从0到T，幅度为A的矩形脉冲），求在 $t_0$ 分别为 $0, T/2, T, 2T$ 时的可实现匹配滤波器冲激响应。
>
> **解答 (c):**
> $h_{mr}(t) = s(t_0-t)$ for $t \ge 0$.
> 信号 $s(x)$ 只在 $x \in [0, T]$ 区间内为 $A$。所以 $s(t_0-t)$ 不为零的条件是 $0 \le t_0-t \le T$，即 $t_0-T \le t \le t_0$。
> 结合 $t \ge 0$，可实现滤波器的非零区间是 $[\max(0, t_0-T), t_0]$。
> *   **Case 1: $t_0 = 0$**
>     $h_{mr}(t) = s(-t)$ for $t \ge 0$. 由于 $s(x)$ 只在 $x \ge 0$ 时有值，所以 $s(-t)$ 只在 $t=0$ 处有定义（作为边界）。$h_{mr}(t)=0$ for $t > 0$。
> *   **Case 2: $t_0 = T/2$**
>     $h_{mr}(t) = s(T/2-t)$ for $t \ge 0$. 非零区间为 $t \in [0, T/2]$。在此区间内，$h_{mr}(t)=A$。
> *   **Case 3: $t_0 = T$**
>     $h_{mr}(t) = s(T-t)$ for $t \ge 0$. 非零区间为 $t \in [0, T]$。在此区间内，$h_{mr}(t)=A$。（这就是标准的匹配滤波器）。
> *   **Case 4: $t_0 = 2T$**
>     $h_{mr}(t) = s(2T-t)$ for $t \ge 0$. 非零区间为 $t \in [T, 2T]$。在此区间内，$h_{mr}(t)=A$。
>
> (d) 找到(c)中所有情况的峰值输出信号，并画出它们与$t_0$的关系。
>
> **解答 (d):**
> 峰值输出信号发生在采样时刻 $t_0$，值为 $s_o(t_0) = \int_0^\infty s(x)h_{mr}(t_0-x)dx$。
> $h_{mr}(t_0-x) = s(t_0-(t_0-x)) = s(x)$，但只在 $t_0-x \ge 0$ 即 $x \le t_0$ 时成立。
> 所以 $s_o(t_0) = \int_0^{\min(t_0, T)} s(x)s(x)dx = \int_0^{\min(t_0, T)} A^2 dx = A^2 \min(t_0, T)$。
> *   **Case 1: $t_0 = 0$**, Peak output = $A^2 \cdot 0 = 0$.
> *   **Case 2: $t_0 = T/2$**, Peak output = $A^2 \cdot T/2$.
> *   **Case 3: $t_0 = T$**, Peak output = $A^2 \cdot T = E_s$ (信号能量)。
> *   **Case 4: $t_0 = 2T$**, Peak output = $A^2 \cdot T = E_s$。
>
> **结论**: 峰值输出（信噪比）在 $t_0 \ge T$ 时达到最大值。这意味着为了获得最佳性能，我们必须**等待整个信号脉冲完全进入滤波器后**再进行采样判决。当 $t_0 < T$ 时，由于滤波器是非因果的截断版本，性能会下降。$t_0 = \tau$ (或在此例中为T) 是实现因果性和最优性的最佳平衡点。

#### 匹配滤波器的相关器实现

*请在这里插入第 20 页的图片*

匹配滤波器的输出在采样时刻 $t=\tau$ 的值是：
$$ z(\tau) = \int_0^\tau y(t) h(\tau - t) dt = \int_0^\tau y(t) [s_1(t) - s_2(t)] dt $$
这个表达式的物理意义是：将接收信号 $y(t)$ 与信号差模板 $[s_1(t)-s_2(t)]$ 相乘，然后在整个码元周期内积分。这被称为**相关器 (Correlator)** 实现。

> [!tip] 滤波器 vs. 相关器
> 匹配滤波器和相关器在数学上是等价的，它们都能实现最佳检测。在实际系统中，根据具体情况选择更容易实现的一种。

### 4.5 最佳二元检测器的误码率

*请在这里插入第 21 页的图片*

我们将最佳滤波器 $h(t) = s_1(\tau-t) - s_2(\tau-t)$ 和最佳采样时刻 $t_0 = \tau$ 代入之前的BER公式，经过化简可以得到：
$$ P_b^* = Q\left( \sqrt{ \frac{\int_0^\tau (s_1(t)-s_2(t))^2 dt}{2N_0} } \right) $$

*请在这里插入第 22 和 23 页的图片*

为了让这个公式更具普适性，我们定义两个重要参数：
> [!abstract] 信号能量与相关性
> *   **每比特能量 (Energy per Bit) $E_b$**:
>     $$ E_b = \frac{1}{2}(E_1 + E_2) = \frac{1}{2} \left( \int_0^\tau s_1^2(t)dt + \int_0^\tau s_2^2(t)dt \right) $$
> *   **比特能量差 (Energy Difference per Bit) $E_d$**:
>     $$ E_d = \int_0^\tau (s_1(t) - s_2(t))^2 dt $$
> *   **互相关系数 (Cross-correlation coefficient) $\rho$**:
>     $$ \rho = \frac{1}{E_b} \int_0^\tau s_1(t)s_2(t) dt $$
>     $\rho$ 衡量了两个信号 $s_1(t)$ 和 $s_2(t)$ 的相似程度，取值范围是 $[-1, 1]$。
>     *   $\rho = 1$: 信号完全相同。
>     *   $\rho = -1$: 信号大小相等，极性相反（反极性信号）。
>     *   $\rho = 0$: 信号正交。

通过这些定义，可以证明 $E_d = 2E_b(1-\rho)$。

> [!summary] 最佳二元检测器通用误码率公式
> $$ P_b^* = Q\left( \sqrt{\frac{E_d}{2N_0}} \right) = Q\left( \sqrt{\frac{E_b(1-\rho)}{N_0}} \right) $$
> 这个公式是本章**最核心的公式之一**。它告诉我们，一个二元通信系统的性能由两个因素决定：
> 1.  **信噪比 $E_b/N_0$**: 每比特能量与噪声功率谱密度的比值。这个值越大，性能越好。
> 2.  **互相关系数 $\rho$**: 两个信号波形的相似性。$\rho$ 越小，性能越好。当 $\rho = -1$ 时（反极性信号），性能达到最佳。

---

## 5. 各种二元调制方案的性能分析

现在，我们可以利用上面的通用公式来分析各种具体调制方式的性能。

### 5.1 二元脉冲幅度调制 (Binary PAM)

*请在这里插入第 25 页的图片*

*   **信号**: $s_1(t) = A, s_2(t) = -A$ for $t \in [0, \tau]$。
*   **能量**: $E_1 = \int_0^\tau A^2 dt = A^2\tau$, $E_2 = \int_0^\tau (-A)^2 dt = A^2\tau$。
*   **每比特能量**: $E_{b,BPAM} = \frac{1}{2}(A^2\tau + A^2\tau) = A^2\tau$。
*   **互相关**: $\int_0^\tau s_1(t)s_2(t)dt = \int_0^\tau (A)(-A)dt = -A^2\tau$。
*   **相关系数**: $\rho = \frac{-A^2\tau}{A^2\tau} = -1$。这是**反极性信号**。
*   **最佳BER**:
    $$ P_{b,BPAM}^* = Q\left( \sqrt{\frac{E_b(1-(-1))}{N_0}} \right) = Q\left( \sqrt{\frac{2E_b}{N_0}} \right) $$

### 5.2 二元通断键控 (Binary OOK)

*请在这里插入第 26 页的图片*

*   **信号**: $s_1(t) = A, s_2(t) = 0$ for $t \in [0, \tau]$。
*   **能量**: $E_1 = A^2\tau$, $E_2 = 0$。
*   **每比特能量**: $E_{b,BOOK} = \frac{1}{2}(A^2\tau + 0) = \frac{1}{2}A^2\tau$。
*   **互相关**: $\int_0^\tau s_1(t)s_2(t)dt = \int_0^\tau (A)(0)dt = 0$。
*   **相关系数**: $\rho = 0$。这是**正交信号**。
*   **最佳BER**:
    $$ P_{b,BOOK}^* = Q\left( \sqrt{\frac{E_b(1-0)}{N_0}} \right) = Q\left( \sqrt{\frac{E_b}{N_0}} \right) $$

> [!note] PAM vs. OOK
> 比较公式可以发现，在相同的 $E_b/N_0$ 下，PAM的性能优于OOK，因为 $\sqrt{2E_b/N_0} > \sqrt{E_b/N_0}$。这意味着要达到相同的BER，OOK需要比PAM高3dB的信噪比。

*请在这里插入第 27 页的图片*
上图展示了PAM和OOK的最佳接收机（相关器形式）。注意它们的**最佳判决门限**不同：
*   **PAM**: $\lambda^* = \frac{1}{2}(E_1-E_2) = \frac{1}{2}(A^2\tau - A^2\tau) = 0$。
*   **OOK**: $\lambda^* = \frac{1}{2}(E_1-E_2) = \frac{1}{2}(A^2\tau - 0) = \frac{1}{2}A^2\tau$。

### 5.3 二元幅移键控 (Binary ASK)

*请在这里插入第 28 页的图片*
BASK本质上是OOK信号乘以一个载波，其基带等效形式就是OOK。因此，它们的$\rho$和BER性能公式完全一样。
*   **相关系数**: $\rho = 0$。
*   **最佳BER**:
    $$ P_{b,BASK}^* = Q\left( \sqrt{\frac{E_b}{N_0}} \right) $$

### 5.4 二元相移键控 (Binary PSK)

*请在这里插入第 29 页的图片*
BPSK的两个信号为 $s_1(t)=A\cos(2\pi f_c t)$ 和 $s_2(t)=A\cos(2\pi f_c t + \pi) = -A\cos(2\pi f_c t)$。这在形式上与PAM完全一样，是反极性信号。
*   **相关系数**: $\rho = -1$。
*   **最佳BER**:
    $$ P_{b,BPSK}^* = Q\left( \sqrt{\frac{2E_b}{N_0}} \right) $$

*请在这里插入第 30 页的图片*
BASK和BPSK的接收机被称为**相干接收机 (Coherent Receiver)**，因为它需要在本地产生一个与发射端载波**严格同步**（同频同相）的参考信号 $\cos(2\pi f_c t)$。

> [!example] 例题 9.6: 考虑有幅度不平衡的反极性信号
> 逻辑'1'发幅度为 $A_1$ 的矩形脉冲，逻辑'0'发幅度为 $-A_2$ 的矩形脉冲，其中 $A_1 \ge A_2 > 0$。接收门限仍为0。
> (a) 证明误码率为 $P_E = \frac{1}{2}Q\left(\sqrt{\frac{2}{1+\rho^2}\frac{2E}{N_0}}\right) + \frac{1}{2}Q\left(\sqrt{\frac{2\rho^2}{1+\rho^2}\frac{2E}{N_0}}\right)$，其中 $\rho=A_2/A_1$，$E = \frac{A_1^2+A_2^2}{2}T$ 是平均信号能量。
>
> **解答 (a):**
> 1.  当发送'1' (幅度$A_1$)时，接收到的信号通过匹配滤波器（或相关器）后的采样值为 $z_1 = A_1 T + n_0$。错误发生在 $z_1 < 0$ 时。错误概率为 $P(e|1) = Q(\frac{A_1 T}{\sigma_0})$。
> 2.  当发送'0' (幅度$-A_2$)时，采样值为 $z_0 = -A_2 T + n_0$。错误发生在 $z_0 > 0$ 时。错误概率为 $P(e|0) = Q(\frac{A_2 T}{\sigma_0})$。
> 3.  总误码率 $P_E = \frac{1}{2}P(e|1) + \frac{1}{2}P(e|0) = \frac{1}{2}Q\left(\frac{A_1 T}{\sigma_0}\right) + \frac{1}{2}Q\left(\frac{A_2 T}{\sigma_0}\right)$。
> 4.  噪声方差 $\sigma_0^2 = N_0 T/2$。（对于矩形脉冲匹配滤波器）。所以 $\sigma_0 = \sqrt{N_0 T/2}$。
> 5.  $P_E = \frac{1}{2}Q\left(\frac{A_1 T}{\sqrt{N_0 T/2}}\right) + \frac{1}{2}Q\left(\frac{A_2 T}{\sqrt{N_0 T/2}}\right) = \frac{1}{2}Q\left(\sqrt{\frac{2A_1^2 T}{N_0}}\right) + \frac{1}{2}Q\left(\sqrt{\frac{2A_2^2 T}{N_0}}\right)$。
> 6.  现在用 $E$ 和 $\rho$ 来表示 $A_1, A_2$。
>     $E = \frac{A_1^2(1+\rho^2)}{2}T \implies A_1^2 T = \frac{2E}{1+\rho^2}$。
>     $A_2 = \rho A_1 \implies A_2^2 T = \rho^2 A_1^2 T = \frac{2E\rho^2}{1+\rho^2}$。
> 7.  代入 $P_E$ 表达式：
>     $P_E = \frac{1}{2}Q\left(\sqrt{\frac{2}{N_0} \cdot \frac{2E}{1+\rho^2}}\right) + \frac{1}{2}Q\left(\sqrt{\frac{2}{N_0} \cdot \frac{2E\rho^2}{1+\rho^2}}\right)$。
>     令 $z = E/N_0$，则 $2E/N_0 = 2z$。
>     $P_E = \frac{1}{2}Q\left(\sqrt{\frac{4z}{1+\rho^2}}\right) + \frac{1}{2}Q\left(\sqrt{\frac{4z\rho^2}{1+\rho^2}}\right)$。
>     这与题目给出的第二行形式相符。**证明完毕。**
>
> **结论**: 当幅度不平衡时（$\rho < 1$），系统的性能会下降。当 $\rho=1$ 时（平衡的PAM），两个Q函数项合并，恢复到 $Q(\sqrt{2(2E/N_0)})$ 的形式（注意这里的$E$是平均能量，传统的$E_b$就是这个E），与标准公式 $Q(\sqrt{2E_b/N_0})$ 一致。

### 5.5 二元频移键控 (Binary FSK)

*请在这里插入第 31 页的图片*

*   **信号**: $s_1(t)=A\cos(2\pi(f_c+\Delta f)t)$, $s_2(t)=A\cos(2\pi(f_c-\Delta f)t)$。
*   **能量**: $E_1 \approx E_2 \approx \frac{1}{2}A^2\tau$。
*   **每比特能量**: $E_{b,BFSK} \approx \frac{1}{2}A^2\tau$。
*   **相关系数**:
    $$ \rho = \frac{\int_0^\tau s_1(t)s_2(t)dt}{E_b} \approx \frac{1}{\tau}\int_0^\tau 2\cos(2\pi(f_c+\Delta f)t)\cos(2\pi(f_c-\Delta f)t)dt $$
    利用积化和差公式，并忽略高频项，可以得到：
    $$ \rho \approx \frac{\sin(4\pi\Delta f \tau)}{4\pi\Delta f \tau} = \text{sinc}(4\Delta f \tau) $$
    为了获得好的性能，我们希望 $\rho$ 尽可能小。最好的情况是 $\rho=0$，即两个信号**正交**。
*   **正交条件**: 要使 $\rho=0$，需要 $\sin(4\pi\Delta f \tau)=0$，即 $4\pi\Delta f \tau = n\pi$，所以 $\Delta f = \frac{n}{4\tau} = \frac{n \cdot R_b}{4}$。
    最小的频率间隔是当 $n=1$ 时，$\min \Delta f = \frac{R_b}{4}$。
*   **最佳BER (正交条件下)**:
    $$ P_{b,BFSK}^* = Q\left( \sqrt{\frac{E_b(1-0)}{N_0}} \right) = Q\left( \sqrt{\frac{E_b}{N_0}} \right) $$

*请在这里插入第 32 页的图片*
上图是相干BFSK接收机的结构。它实际上由两个并行的相干ASK接收机组成，一个匹配频率 $f_c+\Delta f$，另一个匹配 $f_c-\Delta f$。最后比较哪个支路的输出更大来做判决。

### 5.6 二元调制总结

*请在这里插入第 34 页的图片*

> [!table] Summary I: Binary Modulation and Demodulation
| 调制方式 | 带宽效率 (90%) | BER (最佳接收机) |
| :--- | :--- | :--- |
| **Binary PAM** | 1 | $Q\left(\sqrt{\frac{2E_{b,BPAM}}{N_0}}\right)$ |
| **Binary OOK** | 1 | $Q\left(\sqrt{\frac{E_{b,BOOK}}{N_0}}\right)$ |
| **Coherent Binary ASK** | 0.5 | $Q\left(\sqrt{\frac{E_{b,BASK}}{N_0}}\right)$ |
| **Coherent Binary PSK** | 0.5 | $Q\left(\sqrt{\frac{2E_{b,BPSK}}{N_0}}\right)$ |
| **Coherent Binary FSK** | 0.4 (见PPT 33页) | $Q\left(\sqrt{\frac{E_{b,BFSK}}{N_0}}\right)$ |

**性能比较**:
*   **抗噪声性能 (BER)**: PAM和PSK最好，因为它们是反极性信号($\rho=-1$)。OOK, ASK, FSK性能次之，因为它们是正交信号($\rho=0$)。
*   **带宽效率**: 基带信号(PAM, OOK)最高。带通信号中，QPSK（后面会讲）最好。

> [!example] 例题 9.19 & 9.22: 性能计算应用
>
> **问题 9.19**: 为使 $P_E=10^{-5}$，求以下调制方式所需的 $z=E_b/N_0$。
> (a) binary ASK; (b) BPSK; (c) binary FSK
>
> **解答**:
> 首先，我们需要知道 $P_E=Q(x)=10^{-5}$ 时对应的 $x$ 是多少。通过查Q函数表或使用计算器可得，$x \approx 4.265$。所以 $x^2 \approx 18.19$。
> *   **(a) Binary ASK**: $P_E = Q(\sqrt{E_b/N_0}) = Q(\sqrt{z})$。
>     $\sqrt{z} = 4.265 \implies z = 18.19$。
>     换算成dB: $z_{dB} = 10\log_{10}(18.19) \approx 12.6 \text{ dB}$。
> *   **(b) BPSK**: $P_E = Q(\sqrt{2E_b/N_0}) = Q(\sqrt{2z})$。
>     $\sqrt{2z} = 4.265 \implies 2z = 18.19 \implies z = 9.095$。
>     换算成dB: $z_{dB} = 10\log_{10}(9.095) \approx 9.6 \text{ dB}$。
> *   **(c) Binary FSK (Coherent)**: 与ASK相同，$P_E = Q(\sqrt{E_b/N_0})$。
>     $z = 18.19 \implies z_{dB} \approx 12.6 \text{ dB}$。
>
> **问题 9.22(a)**: 数据率 $R=50$ kbps，误码率 $P_E=10^{-6}$。使用主瓣带宽作为衡量标准，估算 (i) binary ASK, (ii) BPSK, (iii) binary coherent FSK 所需的传输带宽和 $E_b/N_0$ (dB)。
>
> **解答**:
> 1.  **计算所需 $E_b/N_0$**:
>     查表得 $P_E=10^{-6}$ 对应 $Q(x)$ 中的 $x \approx 4.75$，所以 $x^2 \approx 22.56$。
>     *   **(i) ASK & (iii) FSK**: $\sqrt{z} = 4.75 \implies z = 22.56 \implies z_{dB} \approx 13.5 \text{ dB}$。
>     *   **(ii) BPSK**: $\sqrt{2z} = 4.75 \implies 2z = 22.56 \implies z = 11.28 \implies z_{dB} \approx 10.5 \text{ dB}$。
> 2.  **计算所需带宽**:
>     主瓣带宽指的是功率谱第一个零点之间的宽度。
>     *   基带矩形脉冲的频谱是 $\text{sinc}(fT_b)$，第一个零点在 $f=1/T_b=R_b$。主瓣带宽是 $2R_b$。
>     *   带通信号 (ASK, BPSK) 是将基带频谱搬移到 $f_c$，所以带宽是基带带宽的两倍。因此主瓣带宽为 $2 \times (R_b) = 2R_b$。
>     *   **(i) ASK & (ii) BPSK**: 带宽 $B_T = 2R_b = 2 \times 50 \text{ kbps} = 100 \text{ kHz}$。
>     *   **(iii) FSK**: FSK信号带宽近似为 $2\Delta f + 2R_b$ (主瓣带宽)。使用最小频偏实现正交时 $\Delta f = R_b/2$ (注意这里是最小的非相干频偏，相干可以更小，但题目没说，按这个算)。$B_T \approx 2(R_b/2) + 2R_b = 3R_b = 3 \times 50 = 150 \text{ kHz}$。

---

## 6. M元信号检测 (M-ary Detection)

为了提高**带宽效率**，我们可以让每个码元（符号）携带多个比特的信息。如果一个码元有M种可能性，它就可以代表 $\log_2 M$ 个比特。

### 6.1 4元PAM (4-ary PAM) 检测

*请在这里插入第 36 页的图片*

我们以4元PAM为例。它使用4个不同的幅度电平来代表4种2-bit组合 (00, 01, 10, 11)。例如：
*   $s_1(t) \to$ '11', 幅度 $A$
*   $s_2(t) \to$ '10', 幅度 $A/3$
*   $s_3(t) \to$ '01', 幅度 $-A/3$
*   $s_4(t) \to$ '00', 幅度 $-A$

接收机结构类似，但判决部分更复杂，需要用3个门限 ($\lambda_1, \lambda_2, \lambda_3$) 将整个幅度轴分成4个判决区域。

*请在这里插入第 37 页的图片*

#### SER vs. BER

对于M元系统，我们区分**符号错误率 (Symbol Error Rate, SER)** 和 **比特错误率 (Bit Error Rate, BER)**。
*   **SER ($P_s$)**: 判决出的符号与发送的符号不一致的概率。
*   **BER ($P_b$)**: 恢复出的比特中，错误的比特所占的比例。

> [!abstract] SER与BER的关系
> 一个符号错误不一定导致所有比特都错误。例如，'10' 被误判为 '11'，只有一个比特错误。
> 对于$k=\log_2 M$个比特的符号，如果码元是相互独立的，可以近似认为：
> $$ P_s \approx k \cdot P_b \quad \text{or} \quad P_b \approx \frac{P_s}{k} $$
> 一个更准确的关系是（假设比特错误独立且概率为$P_b$）：
> $$ P_s = 1 - (1-P_b)^k \approx kP_b \quad (\text{for small } P_b) $$

> [!example] 例题 9.32: 格雷编码 (Gray Encoding)
> 格雷编码确保相邻的十进制数变化1时，其二进制表示只改变一个比特。
> 算法: 二进制码 $b_1b_2...b_n$，格雷码 $g_1g_2...g_n$。
> $g_1 = b_1$
> $g_k = b_k \oplus b_{k-1}$ for $k>1$ (其中$\oplus$是模2加，即异或)
>
> **问题**: 找出0到32的格雷码。
> **解答**:
> 以数字6为例：二进制为 $b_1b_2b_3=110$。
> *   $g_1 = b_1 = 1$
> *   $g_2 = b_2 \oplus b_1 = 1 \oplus 1 = 0$
> *   $g_3 = b_3 \oplus b_2 = 0 \oplus 1 = 1$
> 所以6的格雷码是101。
>
> **为什么在M-ary调制中使用格雷编码？**
> 在PAM或PSK的信号星座图中，幅度或相位最接近的两个信号点，最容易因为噪声而相互误判。如果我们将比特序列通过格雷编码映射到这些信号点，那么这种最可能发生的符号错误（例如，判决落入隔壁区域）将只会导致**一个比特**的错误，从而大大降低了最终的BER。

#### 4-ary PAM 性能分析

*请在这里插入第 38, 39, 40 页的图片*

通过与二元情况类似的分析，可以找到最佳判决门限（相邻信号均值的中点），并计算出4-ary PAM的SER。
$$ \lambda_1^* = \frac{\alpha_1+\alpha_2}{2}, \quad \lambda_2^* = \frac{\alpha_2+\alpha_3}{2}, \quad \lambda_3^* = \frac{\alpha_3+\alpha_4}{2} $$
最终可以得到：
$$ P_{s,4PAM}^* = \frac{3}{2} Q\left(\sqrt{\frac{E_d}{2N_0}}\right) $$
其中 $E_d$ 是**相邻信号**之间的能量差。

*请在这里插入第 41 页的图片*

将所有参数用每比特能量 $E_b$ 表示，可以得到：
*   **SER**: $P_{s,4PAM}^* = \frac{3}{2} Q\left(\sqrt{\frac{0.8 E_{b,4PAM}}{N_0}}\right)$
*   **BER**: $P_{b,4PAM}^* \approx \frac{1}{2} P_{s,4PAM}^* = \frac{3}{4} Q\left(\sqrt{\frac{0.8 E_{b,4PAM}}{N_0}}\right)$

*请在这里插入第 42, 43 页的图片*

> [!summary] Binary PAM vs. 4-ary PAM
> *   **带宽效率**: 4-ary PAM (效率=2) 是 Binary PAM (效率=1) 的两倍。
> *   **抗噪声性能**: 在相同的 $E_b/N_0$ 下，4-ary PAM的BER更高（性能更差）。
> 这是典型的**用性能换效率**的例子。

### 6.2 M元PAM (M-ary PAM)

*请在这里插入第 44, 45, 46 页的图片*

将结论推广到M元PAM：
*   **带宽效率**: $\gamma_{MPAM} = \log_2 M$。
*   **SER**:
    $$ P_{s,MPAM}^* = \frac{2(M-1)}{M} Q\left(\sqrt{\frac{E_d}{2N_0}}\right) = \frac{2(M-1)}{M} Q\left(\sqrt{\frac{6(\log_2 M)E_b}{(M^2-1)N_0}}\right) $$
> [!warning] M增大的影响
> 随着M增大：
> 1.  带宽效率**提高**。
> 2.  在给定$E_b$下，相邻信号的能量差$E_d$**减小**，导致抗噪声性能**变差**，SER和BER**升高**。

> [!example] 例题 9.34: M-ary PAM 系统设计
> 基带反极性PAM系统，信道带宽5kHz，数据率20kbps。
> (a) M需要是多少？
> (b) 要使BER达到 $10^{-6}$，需要多少$E_b/N_0$(dB)?
>
> **解答 (a):**
> 假设我们使用能达到奈奎斯特极限的脉冲整形（如升余弦滚降系数$\beta \to 0$）。
> 理论带宽 $B_T = \frac{R_s}{2} = \frac{R_b/\log_2 M}{2}$。
> 实际中，对于PAM，带宽效率约为 $\log_2 M$。
> $R_b = 20$ kbps, 带宽 $B_T=5$ kHz。
> 带宽效率 $\gamma = R_b/B_T = 20/5 = 4$。
> 对于MPAM, $\gamma = \log_2 M$。
> 所以 $\log_2 M = 4 \implies M = 16$。
> **需要使用 16-PAM**。
>
> **解答 (b):**
> 对于M-ary PAM，BER近似为 $P_b \approx \frac{P_s}{\log_2 M}$。
> $P_s \approx \frac{2(M-1)}{M}Q(\sqrt{\frac{6(\log_2 M)E_b}{(M^2-1)N_0}})$
> $P_b \approx \frac{2(M-1)}{M\log_2 M}Q(\sqrt{\frac{6(\log_2 M)E_b}{(M^2-1)N_0}})$
> 我们需要 $P_b = 10^{-6}$。
> 代入 $M=16, \log_2 M=4$：
> $10^{-6} \approx \frac{2(15)}{16 \cdot 4} Q(\sqrt{\frac{6(4)E_b}{(16^2-1)N_0}}) = \frac{30}{64} Q(\sqrt{\frac{24}{255}\frac{E_b}{N_0}})$
> $2.13 \times 10^{-6} \approx Q(\sqrt{0.094 \frac{E_b}{N_0}})$
> 查表得 $Q(4.58) \approx 2.13 \times 10^{-6}$。
> $\sqrt{0.094 z} = 4.58 \implies 0.094 z = 20.98 \implies z = 223.1$
> $z_{dB} = 10\log_{10}(223.1) \approx 23.5 \text{ dB}$。

### 6.3 QPSK (4-PSK) 与 M元PSK

*请在这里插入第 48 页的图片*

QPSK可以看作是两个正交的BPSK信号的叠加。因此，它的解调也可以分解为两个并行的BPSK相干解调支路，一个用于同相分量(I-路)，一个用于正交分量(Q-路)。

*请在这里插入第 49 页的图片*

> [!summary] QPSK 性能
> *   QPSK的I路和Q路是相互正交、互不干扰的。
> *   分配到每路的能量是总能量的一半。
> *   每条支路传输的比特率也是总比特率的一半。
> *   最终计算出的BER公式与BPSK**完全相同**！
>   $$ P_{b,QPSK}^* = Q\left(\sqrt{\frac{2E_b}{N_0}}\right) $$
> **结论**: QPSK在保持和BPSK一样优秀的抗噪声性能的同时，将带宽效率提高了一倍。这是它被广泛应用的原因。

*请在这里插入第 50 页的图片*
上图比较了BPSK和QPSK的性能，突显了它们在不同约束下的权衡。

*请在这里插入第 51, 52, 53 页的图片*

将PSK推广到M元，我们使用M个不同的相位。
*   **SER**: 对于较大的M，M-PSK的SER可以近似为：
    $$ P_s^* \approx 2Q\left(\sqrt{\frac{2E_s}{N_0}}\sin\left(\frac{\pi}{M}\right)\right) = 2Q\left(\sqrt{\frac{2(\log_2 M)E_b}{N_0}}\sin\left(\frac{\pi}{M}\right)\right) $$
*   与M-PAM一样，随着M增大，相邻相位的距离变小，抗噪声性能变差。

### 6.4 M元调制总结

*请在这里插入第 54 页的图片*

> [!table] Summary II: M-ary Modulation and Demodulation
| 调制方式 | 带宽效率 (90%) | BER (近似) |
| :--- | :--- | :--- |
| **M-ary PAM (M>4)** | $\log_2 M$ | $\approx \frac{2}{\log_2 M}Q\left(\sqrt{\frac{6\log_2 M}{M^2-1}\frac{E_b}{N_0}}\right)$ |
| **QPSK** | 1 | $Q\left(\sqrt{\frac{2E_b}{N_0}}\right)$ |
| **M-ary PSK (M>4)** | $\frac{1}{2}\log_2 M$ (注：PSK带宽一般为$2R_s$) | $\approx \frac{2}{\log_2 M}Q\left(\sqrt{\frac{2(\log_2 M)E_b}{N_0}}\sin(\frac{\pi}{M})\right)$ |

---

## 7. 课程总结

*请在这里插入第 55 页的图片*

上图是各种调制方案性能的最终对比图。
*   **横轴**: $E_b/N_0$ (dB)，代表信噪比，越往左越好（功率效率高）。
*   **纵轴**: $\gamma=R_b/B_h$，代表带宽效率，越往上越好。
*   图中的曲线是**香农信道容量极限**，代表了理论上能达到的最佳性能边界。
*   可以看出，BPSK/QPSK的功率效率很高，但带宽效率有限。而16PSK等高阶调制的带宽效率高，但需要更高的信噪比。

*请在这里插入第 56 页的图片*

> [!final] 总结
> 本章我们系统学习了数字解调的核心理论：
> 1.  **目标**: 从带噪声的波形中恢复比特，并最小化BER。
> 2.  **方法**: 最佳接收机由**匹配滤波器**（或相关器）+ **采样器** + **最佳门限判决器**组成。
> 3.  **性能**: 由 $E_b/N_0$ 和信号集的相关性 $\rho$ 决定。反极性信号($\rho=-1$)性能最佳。
> 4.  **权衡**: M元调制通过牺牲功率效率（需要更高$E_b/N_0$）来换取更高的带宽效率。
> 5.  **未来方向**: 如何逼近香农极限？—— **信道编码理论 (Channel coding theory)**。

> [!example] 例题 9.35: 综合设计题
> 有一个100kHz的信道。要达到 $10^{-6}$ 的BER，对于以下数据率，可以选择什么射频(RF)调制方案？并计算所需的 $z=E_b/N_0$。
> (a) 50 kbps; (b) 100 kbps; (c) 150 kbps; (d) 200 kbps; (e) 250 kbps?
>
> **解答**:
> 先计算不同方案的带宽需求。假设带宽效率为 $\gamma$，则所需带宽 $B=R_b/\gamma$。信道带宽 $B_{ch}=100$ kHz。所以必须满足 $R_b/\gamma \le 100$ kHz，即 $\gamma \ge R_b/100$。
> 常见方案的带宽效率$\gamma$ (90% in-band power):
> BPSK: 0.5, QPSK: 1, 8PSK: 1.5, 16PSK: 2.
>
> *   **(a) 50 kbps**: 需 $\gamma \ge 50/100=0.5$。 **BPSK, QPSK, 8PSK... 都可以**。
>     选**BPSK**或**QPSK**，因为它们功率效率最高。
>     BER=$10^{-6}$时, BPSK/QPSK需要 $E_b/N_0 \approx 10.5$ dB (来自9.22题)。
>
> *   **(b) 100 kbps**: 需 $\gamma \ge 100/100=1$。 **QPSK, 8PSK... 都可以**。
>     选**QPSK**。$E_b/N_0 \approx 10.5$ dB。
>
> *   **(c) 150 kbps**: 需 $\gamma \ge 150/100=1.5$。 **8PSK, 16PSK... 都可以**。
>     选**8PSK**。
>     查8PSK性能曲线或用公式计算，BER=$10^{-6}$时, 8PSK需要 $E_b/N_0 \approx 14$ dB。
>
> *   **(d) 200 kbps**: 需 $\gamma \ge 200/100=2$。 **16PSK... 都可以**。
>     选**16PSK**。
>     查16PSK性能曲线，BER=$10^{-6}$时, 16PSK需要 $E_b/N_0 \approx 18.5$ dB。
>
> *   **(e) 250 kbps**: 需 $\gamma \ge 250/100=2.5$。
>     需要用**32-PSK** ($\gamma = \log_2(32)/2 = 2.5$) 或更高阶的调制如**QAM**。
>     32-PSK的功率效率会更差，需要 $E_b/N_0 > 20$ dB。

