好的，这是根据您提供的课件整理的 Obsidian Markdown 笔记。笔记内容涵盖了每一页的知识点，并使用了 Markdown 格式、数学公式以及 Obsidian callout。

---

# Lecture 13: Noncoherent Reception (非相干接收)

- **主讲人:** Prof. An Liu
- **单位:** College of ISEE, Zhejiang University

---

## 1. 非相干检测概述 (Noncoherent Detection)

> [!info] 核心思想
> 在许多实际情况下，接收端很难或不可能实现严格的载波相位同步。非相干接收技术就是为了解决在载波相位未知或不确定的情况下的信号检测问题。

- **相干检测 (Coherent detection):** 假设接收机能够检测并精确跟踪载波的相位。
- **非相干检测 (Non-coherent reception):** 在无法实现严格相位同步的场景下使用。它不需要知道载波的精确相位。

本讲主要关注两种非相干接收方案：
- **二进制频移键控的非相干检测 (Noncoherent detection on binary FSK)**
- **差分相移键控 (Differential phase-shift keying, DPSK)**

---

## 2. BFSK 的非相干检测

### 2.1 BFSK 信号模型

考虑一个二进制 FSK 系统，发送的两个信号为：
$$
s_1(t) = \sqrt{\frac{2E_b}{T_b}}\cos(2\pi f_1 t + \theta_1)
$$
$$
s_2(t) = \sqrt{\frac{2E_b}{T_b}}\cos(2\pi f_2 t + \theta_2)
$$
其中 $0 \le t < T_b$。

关键点在于 $\theta_1$ 和 $\theta_2$ 是未知的、服从均匀分布的随机相位。

### 2.2 信号空间表示

由于相位未知，我们需要使用同相 (In-phase) 和正交 (Quadrature) 两路分量来表示信号，以消除相位的影响。

1.  **信号展开:**
    $$
    s_1(t) = \sqrt{\frac{2E_b}{T_b}}[\cos(2\pi f_1 t)\cos(\theta_1) - \sin(2\pi f_1 t)\sin(\theta_1)]
    $$
    $$
    s_2(t) = \sqrt{\frac{2E_b}{T_b}}[\cos(2\pi f_2 t)\cos(\theta_2) - \sin(2\pi f_2 t)\sin(\theta_2)]
    $$

2.  **选择四维基函数:**
    $$
    \phi_{1c}(t) = \sqrt{\frac{2}{T_b}}\cos(2\pi f_1 t), \quad \phi_{1s}(t) = -\sqrt{\frac{2}{T_b}}\sin(2\pi f_1 t)
    $$
    $$
    \phi_{2c}(t) = \sqrt{\frac{2}{T_b}}\cos(2\pi f_2 t), \quad \phi_{2s}(t) = -\sqrt{\frac{2}{T_b}}\sin(2\pi f_2 t)
    $$

3.  **信号矢量表示:**
    $$
    \vec{s_1} = [\sqrt{E_b}\cos\theta_1, \sqrt{E_b}\sin\theta_1, 0, 0]
    $$
    $$
    \vec{s_2} = [0, 0, \sqrt{E_b}\cos\theta_2, \sqrt{E_b}\sin\theta_2]
    $$

### 2.3 接收机结构与判决规则

接收信号 $r(t)$ 被投影到四个基函数上，得到接收矢量 $\vec{r} = [r_{1c}, r_{1s}, r_{2c}, r_{2s}]$。

![[Structure of Noncoherent BFSK Receiver - Correlators.png]]

#### 最大似然 (ML) 判决准则

我们需要比较 $f(\vec{r}|\vec{s_1})$ 和 $f(\vec{r}|\vec{s_2})$ 的大小。由于相位 $\theta_1, \theta_2$ 未知，我们需要对所有可能的相位值进行积分（求期望）：
$$
\int_0^{2\pi} f(\vec{r}|\vec{s_1}, \theta_1) d\theta_1 \underset{\text{Choose } s_2}{\overset{\text{Choose } s_1}{\gtrless}} \int_0^{2\pi} f(\vec{r}|\vec{s_2}, \theta_2) d\theta_2
$$

-   **条件概率密度函数 (Conditional PDF):**
    在给定 $\theta_1$ 时，接收矢量的条件 PDF 为：
    $$
    f(\vec{r}|\vec{s_1}, \theta_1) = \frac{1}{\pi N_0}\exp\left(-\frac{(r_{1c}-\sqrt{E_b}\cos\theta_1)^2 + (r_{1s}-\sqrt{E_b}\sin\theta_1)^2}{N_0}\right) \times \frac{1}{\pi N_0}\exp\left(-\frac{r_{2c}^2+r_{2s}^2}{N_0}\right)
    $$
    对于 $f(\vec{r}|\vec{s_2}, \theta_2)$ 也有类似的表达式。

-   **化简与推导:**
    移除与判决无关的公共项后，不等式变为：
    $$
    \frac{1}{2\pi}\int_0^{2\pi} \exp\left(\frac{2\sqrt{E_b}r_{1c}\cos\phi_1 + 2\sqrt{E_b}r_{1s}\sin\phi_1}{N_0}\right) d\phi_1 \ge \frac{1}{2\pi}\int_0^{2\pi} \exp\left(\frac{2\sqrt{E_b}r_{2c}\cos\phi_2 + 2\sqrt{E_b}r_{2s}\sin\phi_2}{N_0}\right) d\phi_2
    $$
    根据定义，上式可以表示为零阶修正贝塞尔函数 $I_0(\cdot)$：
    $$
    I_0\left(\frac{2\sqrt{E(r_{1c}^2+r_{1s}^2)}}{N_0}\right) \ge I_0\left(\frac{2\sqrt{E(r_{2c}^2+r_{2s}^2)}}{N_0}\right)
    $$

-   **最终判决规则:**
    由于 $I_0(x)$ 是单调递增函数，判决规则简化为：
	
> [!tip] BFSK 非相干检测判决规则
> **选择 $s_1$ 如果:**
> $$
> \sqrt{r_{1c}^2 + r_{1s}^2} \ge \sqrt{r_{2c}^2 + r_{2s}^2}
> $$
> **否则选择 $s_2$。**
>
> - **物理解释:** 比较两个频率信道上的能量（包络），选择能量较大者。这被称为**包络检波器 (envelop detector)**。
> - **关键优势:** 载波相位在判决过程中是无关紧要的。

### 2.4 接收机结构与性能

![[Structure of Noncoherent Receiver for Binary FSK - Final.png]]

-   **误码率 (BER):**
    可以证明，非相干 BFSK 的误码率 $P_e$ 为：
    $$
    P_e = \frac{1}{2}\exp\left(-\frac{E_b}{2N_0}\right)
    $$

### 2.5 BER 性能证明 (简述)

1.  **误码率表达式:**
    基于对称性，假设发送 $s_1$，当 $s_2$ 路径的能量大于 $s_1$ 路径时发生错误：
    $$
    P_e = P(r_{1c}^2+r_{1s}^2 < r_{2c}^2+r_{2s}^2 | s_1)
    $$
2.  **定义随机变量:**
    -   $r_1 = \sqrt{r_{1c}^2+r_{1s}^2}$ 服从 **莱斯分布 (Rician Distribution)** (信号加噪声)。
    -   $r_2 = \sqrt{r_{2c}^2+r_{2s}^2}$ 服从 **瑞利分布 (Rayleigh Distribution)** (只有噪声)。
3.  **计算积分:**
    通过对 $r_1$ 和 $r_2$ 的联合概率密度函数在 $r_1 < r_2$ 的区域上进行积分，最终得到误码率公式。

---

## 3. 差分相移键控 (DPSK)

DPSK 是 PSK 的一种非相干形式，它通过**差分编码**来消除对载波相位同步的需求。

### 3.1 DPSK 原理

- **信息编码:** 信息被编码在**连续**信号码元之间的**相位差**中。
    - 发送 "1" (或 "0")：当前信号相位与前一信号**相位相同**。
    - 发送 "0" (或 "1")：当前信号相位与前一信号**相位相反** ($180^\circ$ 相移)。
    - (注：具体 "0" 和 "1" 对应何种相位关系可以自定义，但必须一致)

- **核心假设:** 未知的信道相位 $\theta$ 在两个连续的码元间隔内变化缓慢，可视为常数。这样，在接收端计算两个连续码元的相位差时，这个未知的公共相位 $\theta$ 就会被抵消。

### 3.2 DPSK 信号的产生

分为两步：
1.  **差分编码:** 将信息比特序列 $\{m_i\}$ 转换为差分编码序列 $\{d_i\}$。
    -   编码规则: $d_i = d_{i-1} \oplus m_i$ (其中 $\oplus$ 表示模2加)。
    -   需要一个初始的参考比特 $d_0$。
2.  **相移键控:** 根据 $\{d_i\}$ 序列进行绝对的 PSK 调制。例如，$d_i=0$ 对应相位 $0$，$d_i=1$ 对应相位 $\pi$。

**示例:**、

| | | | | | | | | | |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :--- |
| **信息序列 $\{m_i\}$** | | 1 | 0 | 0 | 1 | 0 | 0 | 1 | 1 |
| **差分编码序列 $\{d_i\}$**| **1** | 1 | 0 | 1 | 1 | 0 | 1 | 1 | 1 |
| **发送相位** | 0 | 0 | $\pi$ | 0 | 0 | $\pi$ | 0 | 0 | 0 |

*(初始参考比特为1，对应相位0)*

### 3.3 DPSK 的接收与解调

#### 简单接收机 (非最优)

![[Simple Noncoherent Receiver for DPSK.png]]

-   **结构:** 将接收信号 $r(t)$ 与其延迟一个码元周期 $T_b$ 的版本 $r(t-T_b)$ 相乘，然后积分。
-   **无噪声输出:** 积分器输出 $y$ 正比于 $\cos(\psi_k - \psi_{k-1})$。
    -   如果 $\psi_k - \psi_{k-1} = 0$ (信息为 "1")，则 $y > 0$。
    -   如果 $\psi_k - \psi_{k-1} = \pi$ (信息为 "0")，则 $y < 0$。
-   **判决:** 根据 $y$ 的符号来判决原始信息比特。

#### 最优接收机

![[Optimal Receiver for DPSK.png]]
![[Equivalent Architecture for Optimal DPSK Receiver.png]]

-   **判决变量:** 最优接收机计算一个判决变量 $l$：
    $$
    l = x_k x_{k-1} + y_k y_{k-1}
    $$
    其中，$x_k, y_k$ 是当前码元的同相和正交分量，$x_{k-1}, y_{k-1}$ 是前一个码元的同相和正交分量。

-   **ML 判决准则:**

> [!tip] DPSK 最优判决规则
> **Choose $s=1$ (无相变) if $l > 0$**
> **Choose $s=0$ (有相变) if $l < 0$**

### 3.4 DPSK 性能分析

- **误码率 (BER):**
  $$
  P_e = \frac{1}{2}\exp\left(-\frac{E_b}{N_0}\right)
  $$

- **BER 证明概要:**
  1.  假设发送 $s=1$ (即 $\psi_k = \psi_{k-1}$)，误码发生在 $l < 0$ 时。
  2.  $x_k, x_{k-1}, y_k, y_{k-1}$ 均为独立的**高斯随机变量**。
  3.  通过变量代换，将 $l$ 表示为两个包络的平方差。
  4.  其中一个包络服从**瑞利分布**，另一个服从**莱斯分布**。
  5.  此问题在数学上等价于非相干 FSK 的 BER 计算，最终得到 DPSK 的误码率公式。

---

## 4. 不同二进制调制方式的性能总结

### 4.1 误码率公式汇总表

| 调制方式 | 误码率 $P_e$ |
| :--- | :--- |
| **Coherent PSK** (相干PSK) | $Q\left(\sqrt{\frac{2E_b}{N_0}}\right)$ |
| **Coherent ASK** (相干ASK) | $Q\left(\sqrt{\frac{E_b}{N_0}}\right)$ |
| **Coherent FSK** (相干FSK) | $Q\left(\sqrt{\frac{E_b}{N_0}}\right)$ |
| **Noncoherent FSK** (非相干FSK) | $\frac{1}{2}\exp\left(-\frac{E_b}{2N_0}\right)$ |
| **DPSK** | $\frac{1}{2}\exp\left(-\frac{E_b}{N_0}\right)$ |

### 4.2 性能曲线对比

![[Performance Curve for Different Binary Modulations.png]]

> [!note] 性能分析
> - **BPSK/QPSK** 性能最好。
> - **DPSK** 的性能比 BPSK 差约 1 dB，但避免了载波恢复的复杂性。
> - **相干 FSK/ASK** 性能相同，比 DPSK 差。
> - **非相干 FSK (NC FSK)** 在这几种调制方式中性能最差。
> - **相干检测**通常比**非相干检测**性能更好，代价是需要复杂的载波同步电路。DPSK 是一个很好的折衷方案。