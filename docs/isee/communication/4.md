# Lec 4: Communication Channels and Information Theory

## 一、无线信道模型 (Wireless Channel Model)
### 1.  通用三层次模型 (General 3-level Model)

由于精确描述电波传播极其困难，通信领域通常采用一个分层的统计模型来近似描述信道，这个模型被称为**三层次模型**。它将复杂的信号变化分解为三种不同尺度（或效应）的叠加。

![|375](Pasted%20image%2020251010145124.png)

这三个层次从小尺度到大尺度依次是：

1.  **多径衰落 (Multipath Fading)**：小尺度效应，描述信号因多条路径**干涉**而产生的**瞬时、快速**的功率剧变。
2.  **阴影衰落 (Shadowing)**：中等尺度效应，描述信号因大型障碍物（如建筑物、山丘）遮挡而产生的**中短期**功率起伏。
3.  **路径损耗 (Path Loss)**：大尺度效应，描述信号功率如何随距离**长期、平均地**衰减。
#### Level 1：多径衰落 (Multipath Fading)

这是变化最快、尺度最小的衰落。

*   **物理成因 (Physical Cause)**
    - 发射的信号经过环境中不同物体（建筑、地面、车辆等）的反射和散射，会形成多条不同长度、不同相位的路径到达接收机。
    - 这些来自不同路径的信号在接收天线处叠加，会发生**相长干涉**（信号增强）和**相消干涉**（信号减弱）。

![](Pasted%20image%2020251013101223.png)

*   **效应 (Effects)**
    1.  **小尺度衰落 (Small Scale Fading)**: 接收信号的功率变化非常剧烈和迅速。
    2.  **快速变化**: 这种衰落现象在**几个波长**的微小距离内就会发生巨大变化。例如，对于1GHz的载波，其波长 $\lambda = c/f = (3 \times 10^8 \text{ m/s}) / (1 \times 10^9 \text{ Hz}) = 0.3 \text{米} \approx 1 \text{英尺}$。这意味着你将手机移动几十厘米，信号强度就可能从满格掉到零格。
    3.  **幅度剧变**: 在典型的**瑞利衰落 (Rayleigh Fading)** 信道（当不存在直射路径时），信号强度的动态变化范围可超过 **30 dB**（即1000倍）。

![|550](Pasted%20image%2020251013101352.png)

这张图展示了典型的瑞利衰落信号包络（幅度）和相位的变化情况。可以看到，信号包络在短时间内经历了多次“深渊式”的下降，这就是**深度衰落 (Deep Fading)**，对通信质量是致命的。

##### **层次二：阴影衰落 (Level 2: Shadowing)**

这是中等尺度的衰落，变化速度比多径慢，但比路径损耗快。

*   **物理成因 (Cause)**
    由大型障碍物（如建筑物、小山、茂密的树林）对信号的**遮挡**效应引起。当你驾车从开阔地进入高楼林立的区域，或从街道拐入小巷时，感受到的信号平均强度的变化就主要是由阴影衰落主导的。

*   **效应 (Effects)**
    1.  **中短期平均功率变化**: 它描述的是对多径衰落进行局部平均（例如，在50-100个波长范围内取平均）后，信号功率的起伏。
    2.  **对数正态分布 (Log-normal Distribution)**: 阴影衰落引起的信号功率变化通常用对数正态分布来建模，这意味着其dB值服从高斯（正态）分布。

---

##### **层次三：路径损耗 (Level 3: Path Loss) (Slide 8)**

这是最大尺度的效应，决定了通信系统的覆盖范围。

*   **物理成因 (Cause)**
    1.  **距离**: 信号能量在空间中扩散，离发射源越远，单位面积接收到的能量就越弱。
    2.  **平均障碍物损耗**: 信号穿过墙体、楼层等障碍物时的平均能量损失。

*   **效应 (Effects)**
    信号的**长期平均功率**随着收发距离的增加而**稳定、持续地下降**。这是一个确定性的趋势，是所有衰落效应的基准线。

---

##### **三层次模型的应用 (Slide 10)**

这三个层次的模型在系统设计的不同阶段各有用途：
*   **路径损耗模型** -> 用于**系统规划和蜂窝覆盖范围分析**。例如，计算一个基站能覆盖多大区域，需要多少基站才能覆盖整个城市。
*   **阴影衰落模型** -> 用于**功率控制设计和更精细的链路预算分析**。例如，系统需要设计多大的功率余量来对抗阴影效应，保证90%的区域有可靠信号。
*   **多径衰落模型** -> 用于**物理层调制解调、编码、交织器等具体技术的设计**。这些技术的目标就是对抗快速衰落，保证数据在瞬时信号很差时也能正确恢复。

---

#### **深入探讨：小尺度衰落 (Small Scale Fading) (Slides 11-34)**

这部分是对多径衰落的详细分析，它从两个维度展开：**多径维度 (时延扩展)** 和 **时间维度 (多普勒扩展)**。

##### **1. 瑞利衰落的数学模型 (Slides 15-17)**

当存在大量无主导路径的多径时，信道可以用瑞利衰落模型来描述。
*   **信道模型**: 一个多径信道可以被建模为多个不同时延 ($\tau_i$) 和幅度 ($a_i$) 的脉冲响应之和。
    $$h(t) = \sum_{i=0}^{L-1} a_i \delta(t - \tau_i)$$
*   **信道衰落系数 (h)**: 对于窄带系统（信号带宽远小于信道带宽），所有多径分量可以合并成一个复数增益，称为信道衰落系数 $h$。
    $$h = \sum a_i e^{-j2\pi f_c \tau_i} = h_I + j h_Q = a e^{j\phi}$$
*   **统计特性**: 根据中心极限定理，当多径数量L很大时：
    *   实部 $h_I$ 和虚部 $h_Q$ 是**独立同分布的高斯随机变量**。
    *   幅度 $a = |h|$ 服从**瑞利分布 (Rayleigh Distribution)**。
    *   相位 $\phi$ 服从**均匀分布 (Uniform Distribution)**。

##### **2. 瑞利衰落的影响与对策 (Slides 18-19)**

*   **影响**:
    1.  **误码率曲线平坦化 (Flattening of BER Curves)**: 在瑞利衰落信道中，无论如何增加信噪比(SNR)，误码率(BER)的下降都非常缓慢，甚至出现平底（Error Floor），性能极差。
    2.  **巨大的SNR代价**: [插入第18页图片]，为了达到相同的误码率（如$10^{-5}$），瑞利衰落信道（D=1曲线）比无衰落信道需要的SNR要**高出30dB以上**！
*   **解决方案：分集 (Diversity)**

> [!TIP] 什么是分集？
> 分集的核心思想是“**不要把所有鸡蛋放在同一个篮子里**”。它通过在不同维度（时间、频率、空间）上发送或接收同一信息的多个独立副本，来降低所有副本同时陷入深度衰落的概率。

*   **如何获得独立副本？**
	*   **时间分集**: 在不同的时间点重传信息。
	*   **频率分集**: 在不同的频率点上传输信息。
	*   **空间分集**: 使用多个天线（发射或接收）来收发信息。
*   **如何利用这些副本？**
	*   **选择合并 (Selection Combining)**: 选择信号最强的一路。
	*   **等增益合并 (EGC)**: 将所有支路同相相加。
	*   **最大比合并 (MRC)**: 按信号强度加权后同相相加（最优）。

##### **3. 多径维度：时延扩展与频率选择性衰落 (Slides 20-25)**

*   **时延扩展 (Delay Spread, $\sigma_\tau$)**: 由于多径的存在，最早到达的信号和最晚到达的信号之间有一个时间差。时延扩展是这个时间差的统计量度（均方根值）。
*   **相干带宽 (Coherence Bandwidth, $B_c$)**: 它与时延扩展成反比 ($B_c \approx 1/\sigma_\tau$)。在相干带宽内的频率分量会经历**相似的衰落**，而超出这个带宽的频率分量则会经历**不相关的衰落**。
*   **衰落类型**:
    *   **平坦衰落 (Flat Fading)**: 如果信号带宽 < 相干带宽 ($B_{sig} < B_c$)，整个信号的所有频率分量会同上同下，经历相同的衰落。
    *   **频率选择性衰落 (Frequency Selective Fading)**: 如果信号带宽 > 相干带宽 ($B_{sig} > B_c$)，信号的不同频率分量会经历不同的衰落，导致信号频谱发生**畸变**。

*   **频率选择性衰落的影响与对策**
    *   **影响**: 导致**码间串扰 (Inter-Symbol Interference, ISI)**，并且会产生一个无法通过增加功率来消除的**“错误平底” (Irreducible Error Floor)**。
    *   **解决方案：均衡 (Equalization)**
        均衡是一种信号处理技术，其作用类似于一个“反信道滤波器”，用于补偿信道引起的频谱畸变，消除ISI。
        *   **线性均衡器**: ZF (迫零)、MMSE (最小均方误差)。
        *   **非线性均衡器**: SIC (连续干扰消除)、MLSE (最大似然序列估计)。
        *   **利用信号结构的均衡**: 如扩频系统中的RAKE接收机，OFDM系统中的FFT。

##### **4. 时间维度：多普勒扩展与时间选择性衰落 (Slides 26-32)**

*   **多普勒扩展 (Doppler Spread, $f_d$)**: 当接收机或发射机（或环境中的散射体）在移动时，会产生多普勒效应，导致接收信号的频率发生扩展。最大多普勒频移为 $f_d = v/\lambda$，其中 $v$ 是相对速度。
*   **相干时间 (Coherence Time, $T_c$)**: 它与多普勒扩展成反比 ($T_c \approx 1/f_d$)。在相干时间内的信号会经历**相似的衰落**，而超过这个时间的信号则会经历**不相关的衰落**。相干时间表征了**信道状态保持不变的时间长度**。
*   **衰落类型**:
    *   **慢衰落 (Slow Fading)**: 如果符号周期 < 相干时间 ($T_{sym} < T_c$)，信道在一个或多个符号周期内是基本不变的。
    *   **快衰落 (Fast Fading)**: 如果符号周期 > 相干时间 ($T_{sym} > T_c$)，信道在一个符号周期内就可能发生显著变化。

##### **5. 衰落总结 (Slides 33-34)**

[插入第34页图片]
这张图是整个衰落部分的精华总结，它从两个维度四个象限定义了信道类型：
1.  **横轴：时延扩展 vs 符号周期 (或 信号带宽 vs 相干带宽)**
    *   左侧 ($T_s > \sigma_\tau$ 或 $B_s < B_c$): **平坦衰落**
    *   右侧 ($T_s < \sigma_\tau$ 或 $B_s > B_c$): **频率选择性衰落**
2.  **纵轴：相干时间 vs 符号周期 (或 信号带宽 vs 多普勒带宽)**
    *   下侧 ($T_s < T_c$ 或 $B_s > B_d$): **慢衰落**
    *   上侧 ($T_s > T_c$ 或 $B_s < B_d$): **快衰落**

一个实际的无线信道总是这四个象限中的一个，例如“频率选择性慢衰落信道”。

---

#### **深入探讨：大尺度衰落 (Slides 35-41)**

##### **1. 路径损耗模型 (Path Loss Model) (Slides 35, 37)**

*   **路径损耗指数 (n)**: 描述了信号功率随距离衰减的速度。
    $$PL(d) \propto (\frac{d}{d_0})^n$$
    在dB域中是线性的：
    $$PL(d)[\text{dB}] = PL(d_0)[\text{dB}] + 10n \log_{10}(d/d_0)$$
    *   $n=2$: 自由空间，距离加倍，损耗增加6dB。
    *   $n>2$: 城市等复杂环境，衰减更快。
    *   $n<2$: 走廊等波导环境，衰减更慢。

##### **2. 传播机制 (Propagation Mechanisms) (Slide 36)**
*   **反射 (Reflection)**: 电磁波遇到尺寸远大于波长的物体表面时发生。
*   **绕射 (Diffraction)**: 电磁波在锋利的障碍物边缘发生弯曲传播（“拐弯”）。
*   **散射 (Scattering)**: 电磁波遇到尺寸小于或与波长相当的粗糙表面或小物体时，能量向四面八方扩散。

##### **3. 阴影效应模型 (Shadowing Effect) (Slides 38-40)**

*   信号穿过多个障碍物，经历多次衰减。在dB域，总衰减是每次衰减的**和**。
*   根据**中心极限定理**，当这些随机衰减因子足够多且独立时，它们的和会趋向于一个**高斯（正态）分布**。
*   因此，总的路径损耗是一个**随机变量**，由确定性的路径损耗模型和一个均值为0、方差为$\sigma^2$的高斯随机变量 $X$ 组成：
    $$TPL(d)[\text{dB}] = PL(d_0) + 10n \log(d/d_0) + X$$
    其中 $X \sim N(0, \sigma^2)$。$\sigma$ 称为阴影因子，通常在5-10dB。

---

## 二、信息论与信道容量 (Information Theory and Channel Capacity)

### 1. 信息论基本概念回顾

*   **熵 (Entropy, H(X))**:
    *   **定义**: 一个随机变量不确定性的度量。事件越不确定，熵越大。
    *   **公式**: $H(X) = -\sum p(x)\log p(x) = -E[\log p(x)]$
	- 微分熵（连续变量）：$h(X)=-\int f(x) \log f(x)dx$
	- 联合熵：$H(X,Y)=E[I(X,Y)]=-\sum_{x\in\mathcal{X}}\sum_{y\in\mathcal{Y}}p(x,y)\log p(x,y)$
	- 条件熵：$H(X_2|X_1)=-\sum_{x_1,x_2} p(x_1,x_2)\log p(x_2|x_1)=-E_{x_1,x_2} [\log p(X_2|X_1)]$
    *   **性质**:
		*   **下界:** $H(X) \ge 0$
		
		*   **上界:**
		    *   **离散情况 (Discrete X):** $H(X) \le \log|X|$，当且仅当 $p(X)=1/|X|$ 时等号成立。
		    *   **连续情况 (Continuous X):** $H(X) \le (1/2)\log(2\pi e \sigma_X^2)$，当且仅当 $X \sim N(\mu, \sigma_X)$ 时等号成立。
		
		*   **链式法则 (Chain Rule):** $H(X_1, X_2) = H(X_1) + H(X_2 | X_1)$
		
		*   **条件作用降低熵 (Conditioning reduces Entropy):**
		    $H(X|Y) \le H(X)$，当且仅当 X 和 Y 相互独立时等号成立。
		
		*   **熵的凹性 (Concavity of entropy):** $H(X)$ 是关于概率分布 $p(x)$ 的凹函数。
		
		*   **若 X 和 Y 独立 (If X & Y are independent):** 则 $H(X+Y) \ge H(X)$
		
		*   **费诺不等式 (Fano's Inequality):**
		    *   给定两个随机变量 X 和 Y，令 $\hat{X} = g(Y)$ 是在已知 Y 的情况下对 X 的一个估计。定义错误概率为 $P_e = \text{Pr}\{\hat{X} \ne X\}$。对于马尔可夫链 $X \to Y \to \hat{X}$，我们有：
		    $H(P_e) + P_e \log(|X|-1) \ge H(X|Y)$



![|308](docs/isee/information/image/Pasted%20image%2020250328193830.png)


*   **互信息 (Mutual Information, I(X;Y))**:
    *   **定义**: 两个随机变量之间的相关性的度量。它表示在了解Y之后，X的不确定性减少了多少。可以理解为“通过信道Y成功传达的关于X的信息量”。
    *   **公式**: $I(X;Y) = H(X) - H(X|Y)$
    *   **Venn图表示**，互信息是两个变量熵的交集。

	![|475](Pasted%20image%2020251013104201.png)
	
    *   **数据处理不等式**: 在一个处理链 $X \to Y \to Z$ 中，信息不会被增加，只会丢失或保持不变。即 $I(X;Y) \ge I(X;Z)$。

### 2. 信道容量 (Channel Capacity)

*   **信道编码定理 (Channel Coding Theorem)**

> [!TIP] 香农第二定理 (有噪信道编码定理)
> 1.  每个信道都有一个极限传输速率，称为**信道容量 (C)**。
> 2.  只要信息传输速率 **R < C**，就一定存在一种编码方式，使得信息传输的错误概率可以做到**任意小**。
> 3.  如果 **R > C**，那么无论用什么编码，错误概率都不可能做到任意小。

*   **信道容量的定义**
    信道容量C是**所有可能的输入概率分布**下，输入X和输出Y之间**互信息的最大值**。
    $$C = \max_{p(x)} I(X;Y)$$

*   **示例1：二进制对称信道 (BSC)**

	![|375](Pasted%20image%2020251013110205.png)
	
	- 这是一个输入输出都是{0,1}，且翻转概率为p的信道。其容量为： $$C = 1 - H(p) = 1 + p\log_2 p + (1-p)\log_2(1-p)$$
*   **示例2：高斯信道 (AWGN Channel)**
    这是一个输出等于输入加上一个高斯白噪声的信道 ($y = x+z$)。
    
> [!IMPORTANT] 香农公式
> 对于一个带宽为 W (Hz)，信号功率为 S，噪声功率为 N 的AWGN信道，其信道容量为：
> $$C = W \log_2 (1 + \frac{S}{N}) \quad (\text{bits/second})$$
这个公式是整个通信理论的基石之一，它给出了在给定物理条件（带宽、信噪比）下，任何通信系统所能达到的最高可靠传输速率。

*   **带宽效率 (或频谱效率)**
    将香农公式两边同除以带宽W，可以得到单位带宽下的极限传输速率，即**带宽效率 $\eta$** 的香农极限：
    $$\eta_{max} = \frac{C}{W} = \log_2(1 + \frac{S}{N}) \quad (\text{bits/second/Hz})$$
    它表明，要提高频谱利用率，唯一的途径就是**提高信噪比 (S/N)**。

