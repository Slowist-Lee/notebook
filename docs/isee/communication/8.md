# Digital Demodulation

好的，这是一份根据您提供的PPT制作的、面向新手的中文Markdown学习笔记。笔记内容完全基于PPT，并使用Obsidian的callout语法来突出重点和例题，希望能帮助您更好地理解数字调制。

---

# Lecture 7: 数字调制学习笔记

> 讲师：Prof. An Liu
> 单位：College of ISEE, Zhejiang University

---

## 1. 什么是数字调制？

### 1.1 数字通信系统概览

首先，我们来看一下整个数字通信系统的流程图。

*请在这里插入第 2 页的图片*

一个典型的数字通信系统流程如下：
1.  **信源 (Source)**: 产生原始信息，例如语音、图像等模拟信号 (Analog Signal)。
2.  **A-D转换 (A-D Conversion)**: 将模拟信号通过采样、量化、编码等步骤，转换成一串二进制比特序列 (Bit sequence)，例如 `0001101110...`。
3.  **数字调制 (Digital Modulation)**: 这是我们本章的重点。它将比特序列转换成适合在信道中传输的波形 (waveform)。
    *   **数字基带调制 (Digital Baseband Modulation)**: 生成的波形是基带信号，可以直接在**基带信道 (Baseband Channel)**（如双绞线）中传输。
    *   **数字带通调制 (Digital Bandpass Modulation)**: 生成的波形是带通信号，适合在**带通信道 (Bandpass Channel)**（如无线空间）中传输。
4.  **信道 (Channel)**: 信号传输的媒介。
5.  **数字解调 (Digital Demodulation)**: 在接收端，将接收到的信号波形恢复成比特序列。
6.  **D-A转换 (D-A Conversion)**: 将比特序列恢复成模拟信号。
7.  **用户 (User)**: 接收最终的信息。

### 1.2 数字调制的核心问题

*请在这里插入第 3 页的图片*

数字调制的核心任务是：

> **如何选择合适的数字波形来“承载”这些二进制数字？**

换句话说，我们要设计一种规则，用特定的波形来代表 `0` 和 `1` (或者 `00`, `01`, `10`, `11` 等比特组合)。

### 1.3 衡量调制性能的关键指标

*请在这里插入第 4 页的图片*

在学习具体的调制技术之前，我们需要了解几个重要的性能衡量指标：

*   **比特率 (Bit Rate)**: $R_b$，单位时间内传输的比特数，单位是 bps (bits per second)。
*   **所需信道带宽 (Required channel bandwidth)**: $B_h$，由已调信号的带宽决定。信道必须有足够的带宽才能让信号无失真或低失真地通过。
*   **带宽效率 (Bandwidth Efficiency)**: $\gamma$，也叫作频带利用率，是衡量在单位带宽内能传输多少比特率的重要指标。

> [!abstract] 公式：带宽效率
> 带宽效率 $\gamma$ 定义为信息比特率 $R_b$ 与所需信道带宽 $B_h$ 的比值。
> $$ \gamma \triangleq \frac{\text{Information Bit Rate } R_b}{\text{Required Channel Bandwidth } B_h} $$
> 这个值越高，说明我们对带宽的利用越充分，技术越先进。

---

## 2. 数字基带调制 (Digital Baseband Modulation)

数字基带调制的目标是选择**基带信号**（频谱集中在零频附近的信号）来承载数字信息。

### 2.1 二元 (Binary) vs. M元 (M-ary)

*请在这里插入第 6 页的图片*

一个基带信号可以承载一个或多个比特。

*   **二元 (Binary) 调制**:
    *   每个基带信号承载 **1 bit** 信息。
    *   比特率: $R_b = 1/\tau$ (其中 $\tau$ 是每个比特的持续时间)。
    *   总共需要 **2** 种不同的基带信号（一个代表'0'，一个代表'1'）。

*   **M元 (M-ary) 调制**:
    *   每个基带信号（称为一个**码元**或**符号 (symbol)**）承载 $log_2M$ 个比特。
    *   码元速率 (Symbol Rate): $R_s = 1/\tau$ (其中 $\tau$ 是每个码元的持续时间)。
    *   比特率 (Bit Rate): $R_b = (\log_2M)/\tau = R_s \cdot \log_2M$。
    *   总共需要 **M** 种不同的基带信号。

### 2.2 基带幅度调制通用模型

*请在这里插入第 7 页的图片*

我们本章重点关注“幅度调制”，即所有基带信号波形**形状相同，但幅度不同**。

> [!important] 基带幅度调制信号的通用表示
>
> **时域表示**:
> $$ s(t) = \sum_{n=-\infty}^{\infty} Z_n \cdot v(t - n\tau) $$
> *   $Z_n$ 是一个离散随机变量，代表第 $n$ 个码元所对应的**幅度**。它有 $M$ 种可能的取值 $\{a_1, a_2, ..., a_M\}$，每种取值的概率为 $1/M$。
> *   $v(t)$ 是一个**单位基带信号**，也就是波形的基本形状。
> *   $\tau$ 是码元持续时间。
>
> **功率谱密度 (Power Spectrum)**:
> $$ G_s(f) = \frac{1}{\tau}|V(f)|^2 \cdot \left( \sigma_Z^2 + \frac{\mu_Z^2}{\tau} \sum_{m=-\infty}^{\infty} \delta\left(f - \frac{m}{\tau}\right) \right) $$
> *   $V(f)$ 是 $v(t)$ 的傅里叶变换。
> *   $\mu_Z$ 是幅度 $Z_n$ 的均值（数学期望）。
> *   $\sigma_Z^2$ 是幅度 $Z_n$ 的方差。
> *   这个公式告诉我们，已调信号的功率谱由两部分组成：一部分是连续谱（与 $V(f)$ 的形状有关），另一部分是离散谱（只有当 $\mu_Z \neq 0$ 时才存在，表现为在 $m/\tau$ 处的冲击函数）。

---

## 3. 脉冲幅度调制 (PAM)

### 3.1 二元PAM (Binary PAM)

这是最简单的PAM方式。

*请在这里插入第 9 页的图片*

> [!example] 二元PAM的规则与波形
> *   **规则**:
>     *   传输比特 `1` 时，发送一个幅度为 `A`、宽度为 $\tau$ 的正矩形脉冲。
>     *   传输比特 `0` 时，发送一个幅度为 `-A`、宽度为 $\tau$ 的负矩形脉冲。
> *   **波形示例**:
>     对于比特序列 `1 1 0 1 0 0 1 ...`，产生的信号 $s(t)$ 如下图所示。
>     *(插入第9页下半部分的图)*
> *   **数学模型**:
>     这符合我们之前提到的通用模型。
>     *   已调信号: $s(t) = \sum_{n=-\infty}^{\infty} Z_n \cdot v(t - n\tau)$
>     *   幅度 $Z_n$: 只有两个取值 `+A` 和 `-A`。假设'1'和'0'等概率出现，则 $Pr\{Z_n = \pm A\} = 1/2$。（**注意**：这里PPT中写的是 $\pm 1$，但结合图示应该是 $\pm A$。我们假设 $v(t)$ 中包含了幅度 $A$，所以 $Z_n$ 取值为 $\pm 1$）。
>     *   单位脉冲 $v(t)$:
>       $$
>       v(t) = \begin{cases} A, & 0 \le t \le \tau \\ 0, & \text{otherwise} \end{cases}
>       $$

#### 功率谱与带宽

*请在这里插入第 10 页的图片*

将二元PAM的参数代入通用功率谱公式：
*   $Z_n$ 的取值为 $\{+1, -1\}$ (假设幅度信息在 $v(t)$ 中)，均值 $\mu_Z = 1 \cdot (1/2) + (-1) \cdot (1/2) = 0$。
*   方差 $\sigma_Z^2 = E[Z_n^2] - \mu_Z^2 = (1^2 \cdot (1/2) + (-1)^2 \cdot (1/2)) - 0^2 = 1$。
*   $v(t)$ 是一个幅度为A，宽度为$\tau$的矩形脉冲，其傅里叶变换 $V(f) = A\tau \text{sinc}(f\tau)$。（注：$\text{sinc}(x) = \frac{\sin(\pi x)}{\pi x}$）

代入后得到二元PAM的功率谱密度：
$$ G_{BPAM}(f) = A^2\tau \text{sinc}^2(f\tau) $$

这个函数的图像是一个在 $f=0$ 处有最大值，然后在 $f = \pm 1/\tau, \pm 2/\tau, ...$ 处为零的曲线。



理论上，这个信号的带宽是无限的。在工程上，我们通常取包含了绝大部分能量的频带作为其**有效带宽**。

*   **90% 带宽**: 包含总功率90%的带宽。对于二元PAM，这个带宽大约是 $1/\tau$。
    *   所需信道带宽: $B_{h\_90\%} = 1/\tau$。
    *   比特率: $R_b = 1/\tau$。
    *   因此，**$B_{h\_90\%} = R_b$**。
*   **95% 带宽**: 包含总功率95%的带宽，大约是 $2/\tau$。
    *   所需信道带宽: $B_{h\_95\%} = 2/\tau = 2R_b$。

#### 带宽效率

*请在这里插入第 12 页的图片*

根据上面计算的带宽，我们可以得到二元PAM的带宽效率。
$$ \gamma = \frac{R_b}{B_h} $$
> [!summary] 二元PAM带宽效率
> *   **采用90%带内功率**: $\gamma_{BPAM} = \frac{R_b}{R_b} = 1$
> *   **采用95%带内功率**: $\gamma_{BPAM} = \frac{R_b}{2R_b} = 0.5$

---

### 3.2 二元通断键控 (Binary On-Off Keying, OOK)

OOK是PAM的一种特殊形式，它的两个脉冲幅度不对称。

*请在这里插入第 13 页的图片*

> [!example] 二元OOK的规则与波形
> *   **规则**:
>     *   传输比特 `1` 时，发送一个幅度为 `A`、宽度为 $\tau$ 的正矩形脉冲。
>     *   传输比特 `0` 时，不发送信号（相当于发送幅度为 `0` 的脉冲）。
> *   **波形示例**:
>     对于比特序列 `1 1 0 1 0 0 1 ...`，产生的信号 $s(t)$ 如下图所示。
>     *(插入第13页下半部分的图)*
> *   **数学模型**:
>     *   幅度 $Z_n$: 取值为 `{A, 0}`。假设'1'和'0'等概率，则 $Pr\{Z_n=A\}=1/2$, $Pr\{Z_n=0\}=1/2$。（同样，我们可以让 $Z_n$ 取 `{1, 0}`，把幅度 $A$ 归入 $v(t)$）
>     *   单位脉冲 $v(t)$:
>       $$
>       v(t) = \begin{cases} A, & 0 \le t \le \tau \\ 0, & \text{otherwise} \end{cases}
>       $$

#### 功率谱与带宽效率

*请在这里插入第 14 页的图片*

我们再次计算OOK的参数：
*   $Z_n$ 的取值为 $\{1, 0\}$。
*   均值 $\mu_Z = 1 \cdot (1/2) + 0 \cdot (1/2) = 1/2$。 **这次均值不为零！**
*   方差 $\sigma_Z^2 = E[Z_n^2] - \mu_Z^2 = (1^2 \cdot (1/2) + 0^2 \cdot (1/2)) - (1/2)^2 = 1/4$。

代入通用功率谱公式，得到二元OOK的功率谱密度：
$$ G_{OOK}(f) = \frac{1}{\tau}(A\tau \text{sinc}(f\tau))^2 \cdot \left(\frac{1}{4} + \frac{(1/2)^2}{\tau} \sum_{m=-\infty}^{\infty} \delta\left(f - \frac{m}{\tau}\right)\right) $$
$$ G_{OOK}(f) = \frac{A^2\tau}{4} \text{sinc}^2(f\tau) + \frac{A^2}{4} \sum_{m=-\infty}^{\infty} \delta\left(f - \frac{m}{\tau}\right) $$
*请注意*：这里的公式与PPT上的形式略有不同，但本质相同。PPT上的形式为：
$$ G_{BOOK}(f) = \frac{1}{\tau}(A\tau\text{sinc}(f\tau))^2 \cdot (\frac{1}{4}) + \frac{1}{\tau}|V(f)|^2 \frac{\mu_Z^2}{\tau}\sum ... $$
PPT的公式似乎将两项合在一起了。关键在于，**由于均值不为0，功率谱中出现了离散的谱线（冲击）**，尤其是在直流分量（f=0）处有一个很强的冲击。

*请在这里插入第 15 页的图片*

尽管功率谱形状有差异，但其连续谱部分的包络形状和二元PAM相同，因此有效带宽的计算结果也是一样的。

> [!summary] 二元OOK带宽效率
> *   **采用90%带内功率**: $B_{h\_90\%} = 1/\tau = R_b \implies \gamma_{OOK} = 1$
> *   **采用95%带内功率**: $B_{h\_95\%} = 2/\tau = 2R_b \implies \gamma_{OOK} = 0.5$

> [!question] 思考
> 我们能否在不牺牲带内功率的情况下，提高带宽效率呢？

---

### 3.3 4元PAM (4-ary PAM)

为了提高带宽效率，一个自然的想法就是让每个码元携带更多的比特。

*请在这里插入第 16 页的图片*

> [!example] 4元PAM的规则与波形
> *   **规则**:
>     *   每个波形（码元）承载 2-bit 信息。
>     *   使用4个不同的幅度电平来区分4种比特组合。一个常见的对称映射是：
>         *   `11` -> `+3A` (PPT图示为`A`)
>         *   `10` -> `+A` (PPT图示为`A/3`)
>         *   `01` -> `-A` (PPT图示为`-A/3`)
>         *   `00` -> `-3A` (PPT图示为`-A`)
>     *   我们以PPT的图示为准，幅度为 `{-A, -A/3, A/3, A}`
> *   **波形示例**:
>     对于比特序列 `11 01 00 10 00 ...`，产生的信号 $s(t)$ 如下图所示。
>     *(插入第16页下半部分的图)*
> *   **数学模型**:
>     *   幅度 $Z_n$ 的取值为 `{-A, -A/3, A/3, A}`。假设4种码元等概率出现，概率均为 $1/4$。
>     *   单位脉冲 $v(t)$ 依然是矩形脉冲。（为方便，可令 $v(t)$ 幅度为1，把幅度信息全放在 $Z_n$ 中）

#### 功率谱与带宽效率

*请在这里插入第 17 页的图片*

计算4元PAM的参数（以幅度取值为 `{-3, -1, 1, 3}` 为例）：
*   均值 $\mu_Z = (-3-1+1+3) \cdot (1/4) = 0$。
*   方差 $\sigma_Z^2 = E[Z_n^2] - \mu_Z^2 = ((-3)^2+(-1)^2+1^2+3^2) \cdot (1/4) - 0 = 20/4 = 5$。（PPT中为 $5/9$，是因为它可能用了 `{-1, -1/3, 1/3, 1}` 这样的归一化幅度）。
*   由于均值为0，其功率谱形状和二元PAM一样，都是 $\text{sinc}^2$ 型，只是前面的系数不同。
$$ G_{4PAM}(f) = \frac{5}{9}A^2\tau \text{sinc}^2(f\tau) $$
*   有效带宽的计算也类似：
    *   **90% 带宽**: $B_{h\_90\%} = 1/\tau$
    *   **95% 带宽**: $B_{h\_95\%} = 2/\tau$

*请在这里插入第 18 页的图片*

现在我们来计算4元PAM的带宽效率：
*   码元速率: $R_s = 1/\tau$
*   比特率: $R_b = 2 \cdot R_s = 2/\tau$  (因为每个码元带2个比特)

> [!summary] 4元PAM带宽效率
> *   **采用90%带内功率**:
>     $B_{h\_90\%} = 1/\tau = R_s = R_b/2$
>     $$ \gamma_{4PAM} = \frac{R_b}{B_{h\_90\%}} = \frac{R_b}{R_b/2} = 2 $$
> *   **采用95%带内功率**:
>     $B_{h\_95\%} = 2/\tau = 2R_s = R_b$
>     $$ \gamma_{4PAM} = \frac{R_b}{B_{h\_95\%}} = \frac{R_b}{R_b} = 1 $$

> [!tip] 结论
> **4元PAM实现了比二元PAM更高的带宽效率！**

### 3.4 M元PAM (M-ary PAM) 总结

*请在这里插入第 19 页的图片*

让我们把结论推广到M元PAM。

*   假设有 $M$ 个不同的幅度电平。
*   每个码元（符号）可以携带 $k$ 个比特，其中 $M = 2^k$ 或 $k = \log_2 M$。
*   比特率 $R_b$ 和码元速率 $R_s$ 的关系是: $R_b = k \cdot R_s$。
*   在90%带内功率条件下，所需信道带宽 $B_{h\_90\%} = R_s = R_b/k$。
*   因此，M元PAM的带宽效率为:
    $$ \gamma_{MPAM} = \frac{R_b}{B_{h\_90\%}} = \frac{R_b}{R_b/k} = k = \log_2 M $$

> [!warning] 带宽效率和可靠性的权衡
> *   从公式看，M越大，带宽效率越高。
> *   但是，更大的M也意味着在固定的总功率范围内，要塞入更多的幅度电平。这会导致相邻电平间的**幅度差减小**。
> *   在有噪声的环境下，更小的幅度差意味着信号更容易被噪声干扰而出错，即**误码率 (error probability) 会更高**。
> *   这就是 **带宽效率** 与 **保真度/可靠性 (fidelity performance)** 之间的权衡。

---

## 4. 脉冲成形 (Pulse Shaping)

前面我们都使用矩形脉冲，这会导致信号频谱无限宽，带宽利用率不高。我们可以通过改变脉冲的形状来优化性能。

### 4.1 带限信道与码间串扰 (ISI)

*请在这里插入第 21 页的图片*

现实中的信道都是**带限 (Bandlimited)** 的，即它只允许一定频率范围内的信号通过，像一个滤波器。

*   **频域看**: 原始PAM信号 $G_{PAM}(f)$ 通过信道 $H(f)$ 后，频谱变为 $G_Y(f) = G_{PAM}(f)|H(f)|^2$。由于信道带宽有限，信号必然会产生失真。
*   **时域看**: 原始信号 $s(t)$ 通过信道 $h(t)$ 后，输出信号 $y(t) = s(t) * h(t)$（卷积）。
    *   原本的脉冲 $v(t)$ 会变成一个拖着长长尾巴的脉冲 $x(t) = v(t) * h(t)$。
    *   这导致在对第 $m$ 个码元进行采样判决的时刻 $m\tau$，接收到的信号 $y(m\tau)$ 不仅包含了第 $m$ 个码元 $Z_m$ 的信息，还混入了其他码元 $Z_n (n \neq m)$ 的“尾巴”的干扰。

> [!danger] 码间串扰 (Inter-symbol Interference, ISI)
> $$ y(m\tau) = \sum_{n=-\infty}^{\infty} Z_n x(m\tau-n\tau) = \underbrace{Z_m x(0)}_{\text{期望信号}} + \underbrace{\sum_{n \neq m} Z_n x(m\tau-n\tau)}_{\text{码间串扰 (ISI)}} $$
> ISI是数字通信中的一个主要干扰源，它会严重影响判决的准确性。

### 4.2 眼图 (Eye Diagram)

*请在这里插入第 22 页的图片*

**眼图**是一种在示波器上观察ISI的直观工具。它通过将接收到的信号按码元周期（或其整数倍）分割并叠加显示而形成。

*   眼图中间“眼睛”张开得越大，说明在采样时刻，信号受到的ISI干扰越小，系统性能越好。
*   从图中可以看到，随着信道带宽 $B_N$ 的减小，ISI越来越严重，“眼睛”闭合得越来越小。
*   **ISI主要是由信道带宽不足引起的**。

**问题**: 除了矩形脉冲，有没有更好的脉冲选择来消除或减小ISI？ **答案是有的：Sinc形脉冲**。

### 4.3 Sinc形脉冲

*请在这里插入第 23 页的图片*

我们知道傅里叶变换中有一个重要的对偶关系：
*   时域的**矩形脉冲** <—> 频域的**Sinc函数**
*   时域的**Sinc函数** <—> 频域的**矩形脉冲**

如果我们使用Sinc函数作为我们的脉冲形状 $v(t) = A \text{sinc}(t/\tau)$，那么它的频谱 $V(f)$ 就是一个理想的矩形（即**严格带限**的）。

*请在这里插入第 24 页的图片*

> [!example] 二元Sinc形脉冲调制信号
> *   **规则**:
>     *   `1`: 发送正的Sinc脉冲 $A\text{sinc}(t/\tau)$。
>     *   `0`: 发送负的Sinc脉冲 $-A\text{sinc}(t/\tau)$。
> *   **重要特性**: Sinc函数在 $t = \pm\tau, \pm2\tau, ...$ 处的值都为0。这意味着，在对任何一个码元进行采样判决的时刻，其他所有码元的脉冲值都正好是0，从而**没有ISI**！

#### 功率谱与带宽效率

*请在这里插入第 25 页的图片*

*   Sinc形脉冲的傅里叶变换是 $V(f) = A\tau$，当 $|f| \le 1/(2\tau)$ 时成立，其他频率为0。
*   这是一个二元对称信号，所以 $\mu_Z = 0, \sigma_Z^2 = 1$。
*   代入通用功率谱公式，得到其功率谱密度 $G_{BSSP}(f)$ 是一个理想的矩形，带宽为 $1/(2\tau)$。
    $$ G_{BSSP}(f) = A^2\tau, \quad |f| \le \frac{1}{2\tau} $$
*   **比特率**: $R_b = 1/\tau$
*   **所需信道带宽**: $B_h = 1/(2\tau) = R_b/2$ （这是100%带内功率，因为它是理想带限的）。

> [!summary] 二元Sinc形脉冲调制带宽效率
> $$ \gamma_{BSSP} = \frac{R_b}{B_h} = \frac{R_b}{R_b/2} = 2 $$
> 这是理论上在二元调制下能达到的最高带宽效率。

*请在这里插入第 26 页的图片*

当这种信号通过一个带宽至少为 $1/(2\tau)$ 的理想信道时，信号波形不变，可以在采样时刻实现**零ISI**。

### 4.4 奈奎斯特准则 (Nyquist Criterion for Zero ISI)

*请在这里插入第 27 页的图片*

更一般地，要实现零ISI，脉冲需要满足什么条件呢？

> [!abstract] 奈奎斯特无码间串扰准则
> 一个脉冲 $v(t)$ 能够实现无码间串扰的充要条件是，在采样时刻满足：
> $$ v(n\tau) = \begin{cases} 1, & n = 0 \\ 0, & n \neq 0 \end{cases} $$
> 这等价于其傅里叶变换 $V(f)$ 满足：
> $$ \sum_{m=-\infty}^{\infty} V\left(f + \frac{m}{\tau}\right) = \tau $$
> 这个公式的物理意义是，$V(f)$ 按 $1/\tau$ 的间隔周期延拓后，叠加起来应该是一个常数。

*请在这里插入第 28 页的图片*

根据奈奎斯特准则，给定信道带宽为 $W$，码元速率为 $1/\tau$：
*   如果 $1/\tau > 2W$ （速率太快，带宽不够），无法设计出无ISI的系统。
*   如果 $1/\tau = 2W$，这是**奈奎斯特速率**。唯一满足条件的脉冲是Sinc脉冲，其频谱是宽度为 $W$ 的理想矩形。此时带宽效率最高，为2。
*   如果 $1/\tau < 2W$ （带宽有富余），存在很多种脉冲形状可以满足无ISI条件，其中最著名的就是**升余弦脉冲 (Raised-Cosine Pulse)**。

### 4.5 升余弦脉冲

*请在这里插入第 29 页的图片*

Sinc脉冲虽然理论上很完美，但它在时域上衰减很慢（按 $1/t$ 衰减），这意味着对**定时抖动 (timing jitter)** 非常敏感，接收端采样时刻稍有偏差就会引入严重的ISI。

**升余弦脉冲**是一种更实用的选择。
*   **时域**: 它比Sinc脉冲衰减得快得多（按 $1/t^3$ 衰减），因此对定时误差**更鲁棒 (robust)**。
*   **频域**: 它的频谱边缘是平滑滚降的，而不是像矩形那样陡峭的“砖墙”特性，这在物理上更容易实现。
*   它有一个滚降系数 $\beta$ ($0 \le \beta \le 1$)。$\beta$ 越大，时域衰减越快（越鲁棒），但频域占用的带宽也越大（带宽效率降低）。
*   这是在**鲁棒性**和**带宽效率**之间的一个权衡。

### 4.6 数字基带调制总结

*请在这里插入第 30 页的图片*

> [!table] Summary I: Digital Baseband Modulation
| 调制方式 | 复杂度 | 带宽效率 (示例) |
| :--- | :--- | :--- |
| **二元PAM** | 低 | 1 (90% in-band power) |
| **4元PAM** | 低 | 2 (90% in-band power) |
| **二元Sinc形脉冲** | 高 (对定时抖动敏感) | 2 (100% in-band power) |
| **二元升余弦脉冲** | 中等 | $1 < \gamma < 2$ (100% in-band power) |

---

## 5. 数字带通调制 (Digital Bandpass Modulation)

当我们需要通过无线信道等带通信道传输信号时，就需要将基带信号“搬移”到较高的载波频率上，这个过程就是带通调制。

> **核心问题**: 如何将一个基带信号通过带通信道传输？
> **基本思想**: 用基带信号去控制一个高频载波信号的**幅度、频率或相位**。

*请在这里插入第 32 页的图片*

这分别对应三种基本的数字带通调制方式：
*   **幅度键控 (Amplitude Shift Keying, ASK)**
*   **频率键控 (Frequency Shift Keying, FSK)**
*   **相位键控 (Phase Shift Keying, PSK)**

### 5.1 二元幅度键控 (BASK)

*请在这里插入第 33 页的图片*

> [!example] 二元ASK (BASK)
> *   **规则**:
>     *   信息比特为 "1" 时，发送载波信号。
>     *   信息比特为 "0" 时，不发送信号（0电平）。
> *   **生成**: 这等效于将一个**二元OOK**基带信号 $s_{BOOK}(t)$ 与一个高频载波 $\cos(2\pi f_c t)$ 相乘。
>     $$ s_{BASK}(t) = s_{BOOK}(t) \cos(2\pi f_c t) $$

*请在这里插入第 34 页的图片*

根据傅里叶变换的调制特性（时域相乘对应频域卷积），我们知道一个信号乘以余弦载波，其频谱会搬移到 $\pm f_c$ 处。
$$ G_{BASK}(f) = \frac{1}{4}[G_{BOOK}(f-f_c) + G_{BOOK}(f+f_c)] $$
*请在这里插入第 35 页的图片*
*   **带宽**: BASK信号的带宽是其对应的基带信号（OOK）带宽的**两倍**。
*   对于90%带内功率，OOK的带宽是 $R_b$，所以BASK的带宽是 $2R_b$。
> [!summary] BASK 带宽效率
> *   **采用90%带内功率**: $B_{h\_90\%} = 2R_b \implies \gamma_{BASK} = \frac{R_b}{2R_b} = 0.5$
> *   **采用95%带内功率**: $B_{h\_95\%} = 2 \cdot (2R_b) = 4R_b \implies \gamma_{BASK} = \frac{R_b}{4R_b} = 0.25$

### 5.2 二元频率键控 (BFSK)

*请在这里插入第 36 页的图片*

> [!example] 二元FSK (BFSK)
> *   **规则**: 用两个不同的频率来代表 "1" 和 "0"。
>     *   信息比特为 "1": 发送信号 $A\cos(2\pi(f_c+\Delta f)t)$
>     *   信息比特为 "0": 发送信号 $A\cos(2\pi(f_c-\Delta f)t)$
>     其中 $\Delta f$ 是频率偏移。
> *   **理解**: 这可以看作是两个并行的BASK信号，一个的载频是 $f_c+\Delta f$ 用来传'1'，另一个载频是 $f_c-\Delta f$ 用来传'0'。

*请在这里插入第 37 页的图片*

*   **功率谱**: BFSK的功率谱是两个BASK功率谱的叠加，分别位于 $f_c \pm \Delta f$ 附近。
*   **带宽**: 所需带宽大约是两个ASK信号峰值之间的距离加上各自的带宽，即 $B_h \approx 2\Delta f + 2R_b$。
> [!summary] BFSK 带宽效率
> $$ \gamma_{BFSK} = \frac{R_b}{2\Delta f + 2R_b} = 0.5 \cdot \frac{1}{1 + \Delta f/R_b} $$
> 显然，$\gamma_{BFSK} < 0.5$，所以**BFSK的带宽效率低于BASK**。

### 5.3 二元相移键控 (BPSK)

*请在这里插入第 38 页的图片*

> [!example] 二元PSK (BPSK)
> *   **规则**: 用载波的两个相反的相位来代表 "1" 和 "0"。
>     *   信息比特为 "1": 发送信号 $A\cos(2\pi f_c t)$
>     *   信息比特为 "0": 发送信号 $A\cos(2\pi f_c t + \pi) = -A\cos(2\pi f_c t)$
> *   **生成**: 这等效于将一个**二元PAM**（幅度为+A和-A）基带信号 $s_{BPAM}(t)$ 与载波 $\cos(2\pi f_c t)$ 相乘。
>     $$ s_{BPSK}(t) = s_{BPAM}(t) \cos(2\pi f_c t) $$

*请在这里插入第 39 页的图片*

*   **功率谱**: BPSK的功率谱是将二元PAM的功率谱搬移到 $\pm f_c$ 处。
$$ G_{BPSK}(f) = \frac{1}{4}[G_{BPAM}(f-f_c) + G_{BPAM}(f+f_c)] $$
*   **带宽**: BPSK的带宽是基带PAM信号带宽的两倍。
*   对于90%带内功率，PAM带宽是 $R_b$，所以BPSK带宽是 $2R_b$。
> [!summary] BPSK 带宽效率
> *   **采用90%带内功率**: $B_{h\_90\%} = 2R_b \implies \gamma_{BPSK} = \frac{R_b}{2R_b} = 0.5$
> *   **采用95%带内功率**: $B_{h\_95\%} = 4R_b \implies \gamma_{BPSK} = \frac{R_b}{4R_b} = 0.25$
> BPSK的带宽效率与BASK相同。但是BPSK的抗噪声性能远优于BASK，是更常用的调制方式。

### 5.4 M元PSK 与 QPSK

*请在这里插入第 40 页的图片*

我们可以扩展PSK，使用M个不同的相位来传输信息，每个相位代表 $\log_2 M$ 个比特。

> [!example] 四相相移键控 (Quaternary PSK, QPSK)
> QPSK使用4个相位，每个码元传输2个比特。
> *   "11" -> $A\cos(2\pi f_c t - \pi/4)$
> *   "10" -> $A\cos(2\pi f_c t + \pi/4)$
> *   "00" -> $A\cos(2\pi f_c t + 3\pi/4)$
> *   "01" -> $A\cos(2\pi f_c t + 5\pi/4)$

*请在这里插入第 41 页的图片*
通过三角函数展开，可以发现QPSK信号可以分解为两个相互正交的BPSK信号之和：
$$ s_{QPSK}(t) = d_I \frac{A}{\sqrt{2}}\cos(2\pi f_c t) - d_Q \frac{A}{\sqrt{2}}\sin(2\pi f_c t) $$
*   $d_I$ (In-phase, 同相分量) 由输入比特流中的奇数位决定。
*   $d_Q$ (Quadrature, 正交分量) 由输入比特流中的偶数位决定。
*   $\cos$ 和 $\sin$ 是正交的载波。

*请在这里插入第 42 页的图片*

这个分解揭示了QPSK调制器的实现原理：将输入的比特流串并转换成两路，分别进行BPSK调制，然后相加。

#### 带宽效率

*请在这里插入第 43 页的图片*

*   **码元速率**: QPSK的码元速率 $R_{s,QPSK}$ 是比特率 $R_{b,QPSK}$ 的一半，因为每个码元带2比特。$R_{s,QPSK} = R_{b,QPSK} / 2 = 1/\tau$。
*   QPSK信号的带宽由其码元速率决定，其带宽是 $2R_{s,QPSK}$。
*   **所需带宽**: $B_{h\_90\%} = 2R_{s,QPSK} = 2(R_{b,QPSK}/2) = R_{b,QPSK}$。

> [!summary] QPSK 带宽效率
> $$ \gamma_{QPSK} = \frac{R_{b,QPSK}}{B_{h\_90\%}} = \frac{R_{b,QPSK}}{R_{b,QPSK}} = 1 $$
> **QPSK的带宽效率是BPSK的两倍！** 它在不增加带宽的情况下，将数据传输速率提高了一倍。

### 5.5 数字带通调制总结

*请在这里插入第 44 页的图片*

> [!table] Summary II: Digital Bandpass Modulation
| 调制方式 | 带宽效率 (90% in-band power) |
| :--- | :--- |
| **二元 ASK (BASK)** | 0.5 |
| **二元 FSK (BFSK)** | $< 0.5$ |
| **二元 PSK (BPSK)** | 0.5 |
| **QPSK** | 1 |
