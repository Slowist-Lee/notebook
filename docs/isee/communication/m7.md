# Lecture 7: 数字调制


## 1. 数字通信系统概述

数字通信的基本流程是将来自信源的模拟或数字信息，通过一系列处理，转换成适合在信道中传输的信号。

![数字通信系统流程图](https://placeholder.com/800x400/888/fff?text=Digital+Communications+Block+Diagram)
*上图展示了从信源到用户的完整数字通信链路，包括A/D转换、调制、信道传输、解调、D/A转换等环节。*

本次课程的重点是 **数字调制 (Digital Modulation)** 与 **数字解调 (Digital Demodulation)** 部分，它分为两大类：
- **数字基带调制 (Digital Baseband Modulation)**
- **数字带通调制 (Digital Bandpass Modulation)**

### 1.1 什么是数字调制？

数字调制的核心任务是 **选择合适的数字波形来“承载”数字比特信息**。

- **比特序列** (如 0001101110...) 首先通过调制器。
- **数字基带调制** 生成基带信号，适用于基带信道（如双绞线）。
- **数字带通调制** 生成带通信号，适用于带通信道（如无线信道）。

![基带与带通调制示意图](https://placeholder.com/800x300/888/fff?text=Baseband+and+Bandpass+Modulation)

### 1.2 关键性能指标

> [!info] 重要定义
> - **比特率 (Bit Rate) $R_b$**: 单位时间内传输的比特数。
> - **所需信道带宽 (Required Channel Bandwidth) $B_h$**: 由已调信号的带宽决定。
> - **带宽效率 (Bandwidth Efficiency) $\gamma$**: 衡量在给定带宽内数据传输速率的指标。

带宽效率的计算公式为：
$$
\gamma \triangleq \frac{\text{信息比特率 } R_b}{\text{所需信道带宽 } B_h}
$$

---

## 2. 数字基带调制 (Digital Baseband Modulation)

数字基带调制选择 **基带信号** 来承载数字信息。一个基带信号可以承载一个或多个比特。

- **二进制 (Binary)**:
    - 每个基带信号承载 1 个比特。
    - 比特率: $R_b = 1/\tau$ (其中 $\tau$ 是码元持续时间)。
    - 总共需要 2 种基带信号（例如，代表 '0' 和 '1'）。
- **M进制 (M-ary)**:
    - 每个基带信号承载一个码元 (Symbol)，包含 $\log_2 M$ 个比特。
    - 码元速率: $R_s = 1/\tau$
    - 比特率: $R_b = (\log_2 M) / \tau$
    - 总共需要 M 种基带信号。

### 2.1 基带幅度调制

我们重点关注“幅度调制”，其特点是：
- 所有基带信号具有 **相同的波形形状**，但 **幅度不同**。

#### 时域表示
已调信号 $s(t)$ 可以表示为一系列经过幅度加权和时移的单位基带信号 $v(t)$ 的叠加：
$$
s(t) = \sum_{n=-\infty}^{\infty} Z_n \cdot v(t - n\tau)
$$
其中，$Z_n$ 是一个离散随机变量，代表第 $n$ 个码元的幅度，$\text{Pr}\{Z_n=a_i\}=1/M$，$i=1,...,M$。

#### 功率谱
已调信号的功率谱密度 $G_s(f)$ 为：
$$
G_s(f) = \frac{1}{\tau}|V(f)|^2 \cdot \left( \sigma_Z^2 + \frac{\mu_Z^2}{\tau} \sum_{m=-\infty}^{\infty} \delta\left(f - \frac{m}{\tau}\right) \right)
$$
其中，$V(f)$ 是单位基带信号 $v(t)$ 的傅里叶变换，$\mu_Z$ 和 $\sigma_Z^2$ 分别是 $Z_n$ 的均值和方差。

### 2.2 脉冲幅度调制 (PAM)

#### 2.2.1 二进制PAM (Binary PAM)
- **1**: 幅度为 $A$、宽度为 $\tau$ 的正矩形脉冲。
- **0**: 幅度为 $-A$、宽度为 $\tau$ 的负矩形脉冲。

![二进制PAM波形](https://placeholder.com/800x300/888/fff?text=Binary+PAM+Waveform)

- **时域信号**: $s(t) = \sum_{n=-\infty}^{\infty} Z_n \cdot v(t - n\tau)$
- **幅度**: $\text{Pr}\{Z_n = \pm A\} = 1/2$
- **单位脉冲**: $v(t) = \begin{cases} 1, & 0 \le t \le \tau \\ 0, & \text{otherwise} \end{cases}$ (为简化，这里假设幅度为1，实际由 $Z_n$ 决定)

**功率谱**:
对于二进制PAM，幅度电平为 $\{-A, A\}$，则 $Z_n$ 的均值 $\mu_Z = 0$，方差 $\sigma_Z^2 = A^2$。单位脉冲 $v(t)$ 的傅里叶变换为 $V(f) = \tau \text{sinc}(f\tau)$。代入通用公式后，功率谱为：
$$
G_{BPAM}(f) = A^2 \tau \text{sinc}^2(f\tau)
$$
![二进制PAM功率谱](https://placeholder.com/800x300/888/fff?text=Power+Spectrum+of+Binary+PAM)

**有效带宽与带宽效率**:
有效带宽通常根据在带功率 (in-band power) 的百分比来定义。
- **90% 在带功率**:
    - 所需信道带宽: $B_{h\_90\%} = 1/\tau = R_b$
    - 带宽效率: $\gamma_{BPAM} = R_b / B_h = 1$
- **95% 在带功率**:
    - 所需信道带宽: $B_{h\_95\%} = 2/\tau = 2R_b$
    - 带宽效率: $\gamma_{BPAM} = R_b / B_h = 0.5$

#### 2.2.2 二进制通断键控 (OOK)
> [!question] 如果两个脉冲的幅度不对称会怎么样？
> 这就是二进制通断键控 (On-Off Keying, OOK)。

- **1**: 幅度为 $A$、宽度为 $\tau$ 的正矩形脉冲。
- **0**: 幅度为 0 的脉冲。

![二进制OOK波形](https://placeholder.com/800x300/888/fff?text=Binary+OOK+Waveform)

**功率谱**:
对于OOK，幅度电平为 $\{0, A\}$，则 $Z_n$ 的均值 $\mu_Z = A/2$，方差 $\sigma_Z^2 = A^2/4$。功率谱中出现了直流分量和离散谱线（冲激函数）：
$$
G_{BOOK}(f) = \frac{(A\tau \text{sinc}(f\tau))^2}{\tau} \cdot \left( \frac{1}{4} + \frac{1}{4\tau} \sum_{m=-\infty}^{\infty} \delta\left(f - \frac{m}{\tau}\right) \right)
$$
![二进制OOK功率谱](https://placeholder.com/800x300/888/fff?text=Power+Spectrum+of+Binary+OOK)
*注意在 $f=m/\tau$ 处的谱线。*

**带宽效率**:
与二进制PAM类似，带宽效率取决于在带功率的要求。
- **90% 在带功率**: $\gamma_{BOOK} = 1$
- **95% 在带功率**: $\gamma_{BOOK} = 0.5$

> [!question] 我们能否在不牺牲在带功率的情况下提高带宽效率？
> 可以，使用M进制调制。

#### 2.2.3 4-ary PAM
- 每个波形承载 2 比特信息。
- **11**: 幅度 $A$
- **10**: 幅度 $A/3$
- **01**: 幅度 $-A/3$
- **00**: 幅度 $-A$

**功率谱**:
对于4-ary PAM，幅度电平对称，均值 $\mu_Z = 0$。方差 $\sigma_Z^2 = \frac{1}{4}[A^2 + (A/3)^2 + (-A/3)^2 + (-A)^2] = \frac{5}{9}A^2$。
$$
G_{4PAM}(f) = \frac{5}{9} A^2 \tau \text{sinc}^2(f\tau)
$$

**带宽效率**:
- 码元速率: $R_s = 1/\tau$
- 比特率: $R_b = 2 \cdot R_s = 2/\tau$
- **90% 在带功率**:
    - 所需带宽: $B_{h\_90\%} = 1/\tau = R_s = \frac{1}{2}R_b$
    - **带宽效率**: $\gamma_{4PAM} = R_b / B_h = 2$
- **95% 在带功率**:
    - 所需带宽: $B_{h\_95\%} = 2/\tau = 2R_s = R_b$
    - **带宽效率**: $\gamma_{4PAM} = R_b / B_h = 1$

> [!success] 结论
> 4-ary PAM 实现了比二进制PAM更高的带宽效率！

#### 2.2.4 M-ary PAM 的带宽效率
- 假设有 M 个不同的幅度电平。
- 每个码元承载 $k = \log_2 M$ 个比特。
- 码元速率 $R_s$ 和比特率 $R_b$ 的关系: $R_b = k R_s$。
- **90% 在带功率** 所需带宽: $B_{h\_90\%} = R_s = R_b / k$。
- **带宽效率**:
$$
\gamma_{MPAM} = k = \log_2 M
$$

> [!warning] Tradeoff
> **带宽效率与保真度性能的权衡**: 更大的 M 提高了带宽效率，但也导致幅度电平之间的差异变小，从而导致更高的误码率（后续讨论）。

---

## 3. 脉冲成形 (Pulse Shaping)

### 3.1 带限信道传输与码间串扰 (ISI)

当PAM信号通过一个带限的基带信道 $H(f)$ 时，会发生信号失真。

- **频域**: $G_y(f) = G_{PAM}(f) |H(f)|^2$
- **时域**: $y(t) = s(t) * h(t)$。原始脉冲 $v(t)$ 变为 $x(t) = v(t) * h(t)$。

在接收端对 $y(t)$ 进行采样以恢复 $Z_m$ 时，采样值为：
$$
y(m\tau) = \sum_{n=-\infty}^{\infty} Z_n \cdot x(m\tau - n\tau) = Z_m x(0) + \sum_{n\neq m} Z_n \cdot x((m-n)\tau)
$$
第二项就是 **码间串扰 (Inter-symbol Interference, ISI)**，即其他码元对当前码元判决8的干扰。

#### 3.1.1 眼图 (Eye Diagram)
眼图是观察码间串扰的一种直观工具。它是通过在示波器上叠加显示多个码元周期的接收信号波形而形成的。
- **“眼睛”张开得越大**，说明码间串扰越小，系统性能越好。
- ISI 是由 **不充分的信道带宽** 引起的。

![|475](Pasted%20image%2020260106192827.png)

> [!question] 有没有比矩形脉冲更好的选择来减小 ISI？
> 有，Sinc 形脉冲。

### 3.2 Sinc 形脉冲
根据傅里叶变换的对偶性：
- **时域矩形脉冲** 对应 **频域Sinc函数**。
- **时域Sinc脉冲** 对应 **频域矩形函数**（即严格带限）。

![|500](Pasted%20image%2020260106192852.png)

#### 3.2.1 Sinc 脉冲调制的信号


使用 $v(t) = A \text{sinc}(t/\tau)$ 作为单位脉冲。
- 其特点是在 $t=n\tau$ ($n \neq 0$) 时，脉冲幅度为0。
- 当多个Sinc脉冲叠加时，在任意一个采样时刻 $t=m\tau$，只有一个脉冲的幅度不为零，其他脉冲的干扰都为零。

![|525](Pasted%20image%2020260106192917.png)

**功率谱**:
由于 Sinc 脉冲的频谱是矩形的，其带宽为 $1/(2\tau)$，因此已调信号的功率谱也是严格带限的。
$$
G_{BSSP}(f) = A^2 \tau, \quad |f| \le \frac{1}{2\tau}
$$


**带宽效率**:
- 比特率: $R_b = 1/\tau$
- 所需信道带宽 (100% 在带功率): $B_h = 1/(2\tau) = R_b/2$
- **带宽效率**: 
$$
\gamma_{BSSP} = \frac{R_b}{R_b/2} = 2
$$

当 Sinc 脉冲信号通过带宽满足 $B_h \ge 1/(2\tau)$ 的理想信道时，可以实现 **零码间串扰 (Zero ISI)**。


![|500](Pasted%20image%2020260106193523.png)
### 3.3 奈奎斯特无码间串扰准则 (Nyquist Criterion for Zero ISI)

> [!note] 奈奎斯特第一准则
> 脉冲 $v(t)$ 能够实现无码间串扰的充要条件是，在采样时刻 $t=n\tau$ 满足：
> $$
> v(n\tau) = \begin{cases} 1, & n = 0 \\ 0, & n \neq 0 \end{cases}
> $$
> 其等价的频域条件是，其傅里叶变换 $V(f)$ 满足：
> $$
> \sum_{m=-\infty}^{\infty} V\left(f + \frac{m}{\tau}\right) = \tau
> $$

根据此准则：
- 如果码元速率 $1/\tau > 2W$ (W为脉冲带宽)，则无法设计出无 ISI 的系统。
- 如果码元速率 $1/\tau = 2W$，要实现无 ISI，脉冲频谱必须是理想矩形，即 $V(f) = \begin{cases} \tau, & |f| < W \\ 0, & \text{otherwise} \end{cases}$。此时对应的时域波形是 Sinc 函数。
    - 这是无 ISI 的最大码元速率，称为奈奎斯特速率。
    - 在二进制情况下，可实现最高的无 ISI 带宽效率，为 2。
- 如果码元速率 $1/\tau < 2W$，则有多种脉冲形状可选，其中最著名的是 **升余弦脉冲 (Raised-Cosine Pulse)**。

### 3.4 升余弦脉冲

Sinc 脉冲虽然理论上完美，但存在两个问题：
1.  脉冲拖尾衰减慢（按 $1/t$），对定时抖动非常敏感，微小的同步误差就会导致严重的 ISI。
2.  物理上不可实现（非因果）。

**升余弦脉冲** 是一个折衷方案：
$$
v(t) = A\text{sinc}(t/\tau) \frac{\cos(2\pi\beta t)}{1-(4\beta t)^2}
$$
其中 $\beta$ 是滚降系数 ($0 \le \beta \le 1$)。


- **优点**: 拖尾衰减更快（按 $1/t^3$），对定时误差更鲁棒。
- **缺点**: 牺牲了带宽。其带宽为 $W = \frac{1+\beta}{2\tau}$，大于 Sinc 脉冲的 $1/(2\tau)$。
- **带宽效率**: $1 < \gamma < 2$。

### 3.5 基带调制总结

| 调制方式 | 复杂度 | 带宽效率 |
| :--- | :--- | :--- |
| **二进制 PAM** | 低 | 1 (90% 在带功率) |
| **4-ary PAM** | 低 | 2 (90% 在带功率) |
| **二进制 Sinc 脉冲** | 高 (对定时抖动敏感) | 2 (100% 在带功率) |
| **二进制升余弦脉冲** | 中等 | $1 < \frac{R_b}{\frac{1}{2}R_b + \beta} < 2$ (100% 在带功率) |

---

## 4. 数字带通调制 (Digital Bandpass Modulation)

> [!question] 如何在带通信道上传输基带信号？
> 使用载波对基带信号进行调制，将信号频谱搬移到信道的通带内。

基本方法有三种：
1.  **幅度调制 (Amplitude Modulation)** -> 幅移键控 (ASK)
2.  **频率调制 (Frequency Modulation)** -> 频移键控 (FSK)
3.  **相位调制 (Phase Modulation)** -> 相移键控 (PSK)

![带通调制方法示意图](https://placeholder.com/800x400/888/fff?text=Bandpass+Modulation+Types)

### 4.1 二进制幅移键控 (BASK)
- **1**: 发送载波信号 $A\cos(2\pi f_c t)$
- **0**: 发送 0

这等效于将一个 **二进制 OOK** 基带信号 $s_{BOOK}(t)$ 与载波 $\cos(2\pi f_c t)$ 相乘：
$$
s_{BASK}(t) = s_{BOOK}(t) \cos(2\pi f_c t)
$$

**功率谱**:
根据调制定理，BASK信号的功率谱是基带OOK信号功率谱的平移：
$$
G_{BASK}(f) = \frac{1}{4}[G_{BOOK}(f-f_c) + G_{BOOK}(f+f_c)]
$$
![BASK功率谱](https://placeholder.com/800x300/888/fff?text=Power+Spectrum+of+BASK)

**带宽效率**:
- BASK信号的带宽是其基带信号 (OOK) 带宽的 **两倍**。
- **90% 在带功率** 所需带宽: $B_{h\_90\%} = 2R_b$
- **带宽效率**:
    - 90% in-band: $\gamma_{BASK} = 0.5$
    - 95% in-band: $\gamma_{BASK} = 0.25$

### 4.2 二进制频移键控 (BFSK)
- **1**: 发送信号 $A\cos(2\pi(f_c + \Delta f)t)$
- **0**: 发送信号 $A\cos(2\pi(f_c - \Delta f)t)$
其中 $\Delta f$ 为频率偏移。

这可以看作是两个不同载波频率的 OOK 信号之和。

**功率谱**:
其功率谱是两个分别以 $f_c+\Delta f$ 和 $f_c-\Delta f$ 为中心的 OOK 谱的叠加。
![BFSK功率谱](https://placeholder.com/800x300/888/fff?text=Power+Spectrum+of+BFSK)

**带宽效率**:
- **90% 在带功率** 所需带宽: $B_{h\_90\%} = 2\Delta f + 2R_b$
- **带宽效率** (90% in-band):
$$
\gamma_{BFSK} = \frac{R_b}{2\Delta f + 2R_b} = 0.5 \cdot \frac{1}{1 + \Delta f / R_b} < 0.5
$$
> [!fail] 结论
> BFSK信号的带宽效率低于BASK信号。

### 4.3 二进制相移键控 (BPSK)
- **1**: 发送信号 $A\cos(2\pi f_c t)$
- **0**: 发送信号 $A\cos(2\pi f_c t + \pi) = -A\cos(2\pi f_c t)$

这等效于将一个 **二进制 PAM** 基带信号 $s_{BPAM}(t)$ (幅度为 $\pm A$) 与载波 $\cos(2\pi f_c t)$ 相乘：
$$
s_{BPSK}(t) = s_{BPAM}(t) \cos(2\pi f_c t)
$$

**功率谱**:
BPSK信号的功率谱是基带BPAM信号功率谱的平移：
$$
G_{BPSK}(f) = \frac{1}{4}[G_{BPAM}(f-f_c) + G_{BPAM}(f+f_c)]
$$
![BPSK功率谱](https://placeholder.com/800x300/888/fff?text=Power+Spectrum+of+BPSK)

**带宽效率**:
- **90% 在带功率** 所需带宽: $B_{h\_90\%} = 2R_b$
- **带宽效率**:
    - 90% in-band: $\gamma_{BPSK} = 0.5$
    - 95% in-band: $\gamma_{BPSK} = 0.25$
> [!success] 结论
> BPSK信号的带宽效率与BASK信号相同。

### 4.4 M-ary PSK
M-ary PSK 使用 M 个不同的载波相位来传输信息，每个脉冲代表 $\log_2 M$ 个比特。

#### 4.4.1 四进制PSK (QPSK)
QPSK 使用 4 个相位，每个码元携带 2 个比特。
- **"11"**: $s_1(t) = A\cos(2\pi f_c t - \pi/4)$
- **"10"**: $s_2(t) = A\cos(2\pi f_c t + \pi/4)$
- **"00"**: $s_3(t) = A\cos(2\pi f_c t + 3\pi/4)$
- **"01"**: $s_4(t) = A\cos(2\pi f_c t + 5\pi/4)$

**正交分解**:
QPSK 信号可以分解为一个 **同相分量 (In-phase, I)** 和一个 **正交分量 (Quadrature, Q)** 之和，这两个分量是两个独立的BPSK信号：
$$
s_{QPSK}(t) = d_I \frac{A}{\sqrt{2}}\cos(2\pi f_c t) + d_Q \frac{A}{\sqrt{2}}\sin(2\pi f_c t)
$$
其中 $d_I, d_Q \in \{-1, 1\}$，由输入的比特对决定。

**QPSK调制器**:
![QPSK调制器框图](https://placeholder.com/800x400/888/fff?text=QPSK+Modulator)
输入比特序列首先进行串并转换，分为两路，分别映射成 $d_I$ 和 $d_Q$ 幅度，然后分别与正交载波 $\cos(2\pi f_c t)$ 和 $\sin(2\pi f_c t)$ 相乘，最后相加。

**带宽效率**:
- 码元速率: $R_{s,QPSK} = 1/\tau = R_b/2$
- **90% 在带功率** 所需带宽: $B_{h\_90\%} = 2 R_{s,QPSK} = R_b$
- **带宽效率** (90% in-band): 
$$
\gamma_{QPSK} = \frac{R_b}{B_h} = 1
$$

> [!success] 结论
> QPSK 实现了比 BPSK 更高的带宽效率！

### 4.5 带通调制总结

| 调制方式 | 带宽效率 (90% 在带功率) |
| :--- | :--- |
| **二进制 ASK** | 0.5 |
| **二进制 FSK** | $0.5 \cdot \frac{1}{1 + \Delta f / R_b} < 0.5$ |
| **二进制 PSK** | 0.5 |
| **QPSK** | 1 |