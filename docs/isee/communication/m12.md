好的，这是根据您提供的课件整理的 Obsidian Markdown 笔记。

---

# Lecture 12: MQAM 误差分析

> 主讲人： Prof. An Liu
> 单位： College of ISEE, Zhejiang University

## 课程大纲

-   **此前已讨论**:
    -   正交 M 元调制的错误概率
    -   联合界 (Union Bound)
    -   一些信号类型
-   **本次将探讨**:
    -   M 元调制类型 (M-ary Modulation Types)
    -   MQAM, MPSK
    -   性能权衡 (Tradeoffs)

## M 元调制类型

-   我们已经学习了如何：
    -   设计一个最优 M 元接收机
    -   计算比特和符号错误的概率
    -   考虑一些通用的传输信号类型
-   现在我们希望讨论具体且流行的调制格式，并确定它们的特性以及适用场景。

---

## M 元相移键控 (MPSK)

MPSK 信号的数学表达式为：
$$
s_k(t) = \sqrt{\frac{2E_s}{T_s}} \cos\left(\omega_c t + \underbrace{\frac{2\pi(k-1)}{M}}_{\theta_k}\right) \quad 0 \le t \le T_s, k=1, 2, ..., M
$$
假设载波频率 $\omega_c$ 是符号速率的整数倍，以保证正交性：
$$
\omega_c = \frac{\text{integer} \times 2\pi}{T_s}
$$
我们可以得到一组标准正交基：
$$
\begin{cases}
\phi_1(t) = \sqrt{\frac{2}{T_s}}\cos(\omega_c t) \\
\phi_2(t) = \sqrt{\frac{2}{T_s}}\sin(\omega_c t)
\end{cases}
$$

### MPSK 星座图示例

所有 MPSK 信号点都位于一个半径为 $\sqrt{E_s}$ 的圆上，具有相同的能量。

![[MPSK constellation for M=2 and M=4]]
*左图：M=2 (2-PSK，等同于 BPSK)，右图：M=4 (4-PSK，也称为 QPSK)*

![[MPSK signal sets for M=2,4,8,16]]
*上图展示了 M=2, 4, 8, 16 时的 MPSK 信号集和相应的判决边界 (Decision line, DL)。随着 M 的增大，相邻信号点之间的距离变小。*

### MPSK 的错误性能

MPSK 的符号错误概率 (Symbol Error Probability, SER) 的精确表达式为：
$$
P_{eM} = \frac{1}{\pi} \int_0^{\pi(1-1/M)} \exp\left[-\frac{(E_s/N_0)\sin^2(\pi/M)}{\sin^2\phi}\right] d\phi
$$
这个公式（在 Ziemer and Peterson 教材中为 Eqn.(4-98)）除了 M=2 和 M=4 的情况外，通常需要数值积分。
在实际应用中，我们常用下面这个紧凑的上下界来近似：
$$
Q\left(\sqrt{\frac{2E_s}{N_0}}\sin(\pi/M)\right) \le P_{e,M} \le 2Q\left(\sqrt{\frac{2E_s}{N_0}}\sin(\pi/M)\right)
$$

### SER vs. Eb/No 性能曲线

![[SER vs Eb/No for MPSK]]
*上图显示了不同 M 值下 MPSK 的符号错误率性能曲线。在相同的 $E_b/N_0$ 条件下，M 值越大，符号错误率越高。*

对于**高信噪比 (large Es/No)** 的情况，SER 可以近似为：
$$
P_{e,M} \approx 2Q\left(\sqrt{\frac{2E_s}{N_0}}\sin(\pi/M)\right)
$$
这个近似界在 $E_s/N_0$ 增大时非常紧凑。

### 比特错误概率与格雷编码 (Gray Coding)

MPSK 的比特错误概率 (Bit Error Probability, BEP) 与 M 元正交调制不同，它**依赖于所使用的比特标记方案**。通常 MPSK 采用**格雷编码**。

![[Binary vs Gray coding for 8-PSK]]
*左图：二进制编码；右图：格雷编码。*

> [!info] 什么是格雷编码？
> -   它是一种符号到比特的映射方式。
> -   核心特点：从一个符号变到其**相邻**符号时，其对应的 k 个比特中**只有一个比特**发生改变。
> -   优点：当发生最可能的符号错误（即判决为相邻符号）时，只会导致一个比特错误。

因此，对于采用格雷编码的 MPSK，比特错误率可以很好地近似为：
$$
P_b \approx \frac{P_{e,M}}{\log_2 M}
$$

---

## M-QAM 调制

M-QAM (Quadrature Amplitude Modulation) 同时利用幅度和相位来承载信息。

-   **时域描述**:
    $$
    s_k(t) = a_k \cos(\omega_c t) + b_k \sin(\omega_c t) \quad \text{for } t \in [0, T_s], k = \{1, 2, ..., M\}
    $$
    其中幅度 $a_k, b_k \in \{\pm\alpha, \pm3\alpha, ..., \pm(\sqrt{M}-1)\alpha\}$，且 $M = \{4, 16, 64, 256, ...\}$。

-   **几何域描述**:
    -   信号空间是二维的，基函数为 $\{\cos(\omega_c t), \sin(\omega_c t)\}$。
    -   星座图为矩形网格状。
    -   可以使用 I-Q 调制器轻松生成。

![[16-QAM constellation with Gray coding]]
*上图为 16-QAM 的星座图，相邻点之间的最小距离为 $2\alpha$。*

### MQAM 性能

-   **比特率**: $R_b = \frac{1}{T_s}\log_2 M$
-   **平均符号能量**:
    $$
    E_s = \frac{2}{\sqrt{M}}(2\alpha^2 + 2(3\alpha)^2 + ...)
    $$
    -   例如，对于 16QAM: $E_s = \frac{2}{4}(2\alpha^2 + 2(3\alpha)^2) = 10\alpha^2$
-   **平均发射功率**: $P_s = \frac{E_s}{T_s}$

> [!note] 备注
> -   并非所有 M 个星座点的能量都相同。
> -   信息可以看作是由点的**幅度和相位**共同承载的。

### MQAM 符号错误率 (SER) 分析

-   M-QAM 可以看作是两个独立的 $\sqrt{M}$-PAM (Pulse Amplitude Modulation) 信号的叠加，每个 PAM 有 $\sqrt{M}=2^{k/2}$ 个点。
    ![[PAM constellation]]
-   M-QAM 的**正确判决概率** $P_c$ 为两个独立 PAM 都正确判决的概率：
    $$
    P_c = (1 - P_{\sqrt{M}})^2
    $$
    其中 $P_{\sqrt{M}}$ 是一个 $\sqrt{M}$-PAM 的错误概率。
-   可以证明 $\sqrt{M}$-PAM 的错误概率为：
    $$
    P_{\sqrt{M}} = 2\left(1-\frac{1}{\sqrt{M}}\right)Q\left(\sqrt{\frac{3}{M-1}\frac{E_s}{N_0}}\right)
    $$
-   因此，M-QAM 的符号错误率 $P_M = 1 - P_c$ 为：
    $$
    P_M = 1 - (1-P_{\sqrt{M}})^2 \approx 2P_{\sqrt{M}} = 4\left(1-\frac{1}{\sqrt{M}}\right)Q\left(\sqrt{\frac{3}{M-1}\frac{E_s}{N_0}}\right)
    $$
-   **与 M-PSK 的 SER 比较**:
    -   回顾 M-PSK SER 近似值: $P_M \approx 2Q\left(\sin\frac{\pi}{M}\sqrt{\frac{2E_s}{N_0}}\right)$
    -   M-QAM 相对于 M-PSK 的性能增益 (gain) 为：
        $$
        \text{gain} = \frac{3/(M-1)}{2\sin^2(\pi/M)}
        $$

### M-QAM 联合界

-   不计算精确的 $P_e$，使用联合界在高信噪比下更简单且渐进准确。
    $$
    P_e \le 4Q\left(\sqrt{\frac{d_{\min}^2}{2N_0}}\right) \approx 4Q\left(\sqrt{\frac{(2\alpha)^2}{2N_0}}\right) \approx 4Q\left(\sqrt{\frac{3E_s}{(M-1)N_0}}\right)
    $$
    -   这里的 "4" 来自于内部星座点平均有4个最近邻居。
-   这个界与精确值非常接近，尤其是在高 $E_s/N_0$ 时。

---

## M 元调制的选择与权衡

选择调制方案时需要考虑多种因素，例如：
-   **功率效率 (Power efficiency)**: 与 $E_b/N_0$ 成反比。
-   **带宽效率 (Bandwidth efficiency)**: 比特率/带宽。

M 元调制允许我们在**功率、比特率和带宽**之间进行权衡。

### 错误概率性能曲线的启示

-   **MFSK**: 增加 M 可以**提高功率效率**（降低 $P_b$ 或所需 $E_b/N_0$），但代价是**增加带宽**。
-   **MPSK**: 增加 M 可以**提高带宽效率**（降低带宽需求），但代价是**降低功率效率**（$P_b$ 恶化或所需 $E_b/N_0$ 增加）。

### 性能的理论极限

-   **信道容量 (Channel Capacity)**: 在无差错条件下，信息可以传输的最大速率的理论上限 (Shannon, 1948)。
-   对于受 AWGN（噪声功率谱密度 $S_n(f)=N_0/2$）干扰的带限信道，最大可达速率为：
    $$
    R = B \log_2(1+SNR) = B\log_2\left(1+\frac{P_s}{N_0B}\right)
    $$

### 香农极限 (Shannon Limit)

通过公式变换，我们可以得到能量效率和带宽效率的关系：

1.  **频谱效率 (Spectral Efficiency)**:
    $$
    \frac{R}{B} = \log_2\left(1+\frac{P_s}{N_0B}\right) = \log_2\left(1+\frac{P_s}{N}\right)
    $$
    其中 $N=N_0B$ 是噪声功率。

2.  **能量效率 (Energy Efficiency)**:
    $$
    \frac{E_b}{N_0} = \frac{P_s T_b}{N_0} = \frac{P_s}{R N_0} = \frac{P_s B}{R N_0 B} = \frac{P_s}{N}\frac{B}{R}
    $$

3.  联立得到：
    $$
    \frac{E_b}{N_0} = \frac{B}{R}\left(2^{R/B} - 1\right)
    $$

#### 带宽效率平面

![[Bandwidth-efficiency plane]]
*该图展示了不同调制方式的带宽效率 (R/W) 与每比特信噪比 ($E_b/N_0$) 的关系，并与香农容量极限进行了比较。*

-   **功率受限区域 (Power-limited region)**: $R/W < 1$，如 MFSK。
-   **带宽受限区域 (Bandwidth-limited region)**: $R/W > 1$，如 MPSK, MQAM。

### 权衡 (Trade-Offs)

> [!summary] 两种系统类型
> -   **功率受限系统 (Power-Limited Systems)**:
>     -   特点：功率稀缺，但带宽充足。
>     -   策略：通过扩展带宽来改善 $P_b$（在给定 $E_b/N_0$ 下），或者降低所需的 $E_b/N_0$（在给定 $P_b$ 下）。
> -   **带宽受限系统 (Bandwidth-Limited Systems)**:
>     -   特点：带宽稀缺。
>     -   策略：在带限信道上最大化速率 R，代价是牺牲 $E_b/N_0$（在给定 $P_b$ 下）。

### 终极香农极限

当带宽效率 $R/B \to 0$ (即带宽无限) 时，我们可以得到可靠通信所需的最小 $E_b/N_0$:
$$
\frac{E_b}{N_0} = \lim_{R/B \to 0} \frac{2^{R/B}-1}{R/B} = \ln(2) = \frac{1}{\log_2 e} \approx 0.693 \implies \mathbf{-1.59 \, dB}
$$
> [!important] 香农极限
> 这个值被称为香农极限。要实现可靠的通信，接收到的 $E_b/N_0$ 必须大于 -1.59 dB。

---

## M 元调制方案总结

| 特性 | M-FSK | M-PSK | M-QAM |
| :--- | :--- | :--- | :--- |
| **比特率** | $R_b = \frac{1}{T_s}\log_2(M)$ | $R_b = \frac{1}{T_s}\log_2(M)$ | $R_b = \frac{1}{T_s}\log_2(M)$ |
| **带宽 (带通)** | $BW = \frac{M+1}{2T_s}$ | $BW = \frac{1}{T_s}$ | $BW = \frac{1}{T_s}$ |
| **平均发射功率** | $\frac{E_s}{T_s}$ | $\frac{E_s}{T_s}$ | $\frac{4\alpha^2}{\sqrt{M}T_s}\sum_{i=1}^{\log_2M/2}(2^i-1)^2$ |
| **平均符号错误率 (SER)** | $P_e \le (M-1)Q\left(\sqrt{\frac{E_s}{N_0}}\right)$ | $P_e \le 2Q\left(\sqrt{\frac{2E_s}{N_0}}\sin(\pi/M)\right)$ | $P_M \approx 4\left(1-\frac{1}{\sqrt{M}}\right)Q\left(\sqrt{\frac{3}{M-1}\frac{E_s}{N_0}}\right)$ |
| **备注** | - 正交信号<br>- 能量效率高，但占用额外带宽 | - 等能量星座点<br>- 信息仅由相位承载<br>- 信号维数恒为2 (I-Q调制)<br>- 以额外功率为代价提升频谱效率 | - 非等能量星座点<br>- 信息由幅度和相位共同承载<br>- 以额外功率为代价提升频谱效率<br>- 当 M>4 时性能优于 M-PSK |

