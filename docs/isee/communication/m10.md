好的，这是根据您提供的课件整理的 Obsidian Markdown 笔记。笔记内容涵盖了每一页的知识点，并使用了 Markdown 格式、数学公式以及 Obsidian Callout，便于您学习和回顾。

---

# Lecture 10: 通用M元调制与解调

## 概览与回顾

> [!summary] 核心内容
> 本讲将重点讨论 M 元调制、最佳信号检测，以及如何在加性高斯白噪声（AWGN）信道下，为通用的 M 元信号传输设计能最小化错误概率 $P_e$ 的最佳接收机。

### 已学知识回顾 (Have Considered)
- **信号的几何表示法**:
    - **信号空间与信号向量**: 将信号视为高维空间中的向量。
    - **信号空间维度**: 信号空间由一组线性无关的向量（基函数）张成。
    - **基向量/基函数**: 正交/标准正交信号集。
    - **格拉姆-施密特正交化 (GSO) 过程**: 一种系统性地确定一组标准正交基的方法。

### 本讲主要内容 (We will now consider)
- **M元调制 (M-ary Modulation)**
- **最佳信号检测 (Optimum signal detection)**
- 在 **AWGN** 信道背景下，确定能够最小化错误概率 $P_e$ 的通用M元信号传输的最佳接收机。

---

## 数字通信系统回顾

### 三个基本组成部分
1.  **发送端 (Transmitter)**: 或数字调制器。
2.  **接收端 (Receiver)**: 或数字解调器。
3.  **信道 (Channel)**: 信号传输的媒介。

### 关键指标
- **质量/性能度量 (Quality/Performance Measure)**:
    - 误比特率 (Bit Error Rate, BER)
    - 比特率 (Bit Rate)
- **资源 (Resource)**:
    - 带宽 (Bandwidth)
    - 功率 (Power)

> [!info] 核心权衡
> 数字通信系统设计的核心在于**比特率 (Bit Rate)**、**带宽 (Bandwidth)**、**功率 (Power)** 和 **错误概率 (Error Probability)** 这四个基本参数之间的权衡。
> 

### 信道示例：AWGN
- **AWGN (Additive White Gaussian Noise)**: 加性高斯白噪声。
- 接收信号 $y(t)$ 是发送信号 $x(t)$ 和噪声 $n(t)$ 的和：
    $$
    y(t) = x(t) + n(t)
    $$
- 在这种理想信道模型中，信道仅引入噪声，不产生其他形式的失真。

---

## 数字调制器 (Digital Modulator)

### 基本概念
- **调制符号 (Modulation symbols)**:
    - 具有有限持续时间 $T_s$ 的信号脉冲。
    - 例如，二进制调制器输入1个比特 {0,1}，从集合 $\{s_0(t), s_1(t)\}$ 中输出一个调制符号。
- **波特率 (Baud Rate) / 符号速率 (Symbol Rate)**: 每秒传输的符号数。
    $$
    R_{baud} = \frac{1}{T_s}
    $$
- **比特率 (Bit Rate)**: 单位为 bps (bits per second)。
    $$
    \text{Bit Rate} = (\frac{1}{T_s}) \times (\frac{\text{bits}}{\text{symbol}})
    $$
- **传输带宽 (Transmission BW)**:
    $$
    W = \frac{1}{T_s}(1+\alpha)
    $$
    其中 $\alpha$ 是滚降系数。
- **M元调制器 (M-ary Modulator)**:
    - 从 M 个可能的符号 $\{s_1(t), s_2(t), ..., s_M(t)\}$ 中选择一个进行发送。



### 调制器参数规范
- **符号持续时间 $T_s$**: 调制器产生一个调制符号的频率。
- **信号集 $S_M$**: 调制器使用的 M 个时域信号的集合。
    $$
    S_M = \{s_1(t), ..., s_M(t)\}
    $$
- **发射带宽 $W_{tx}$**:
    $$
    W_{tx} = (1+\alpha)\frac{1}{T_s}
    $$
- **发射功率 $P_{tx}$**:
    $$
    P_{tx} = \frac{1}{MT_s} \sum ||\vec{s}_m||^2 = \frac{1}{MT_s} \sum \int_0^{T_s} |s_m(t)|^2 dt
    $$

### 信号集的表示方法
1.  **时域 (Time Domain)**: 直接用波形函数表示。
2.  **几何域 (Geometric Domain) / 星座图 (Constellation)**:
    - M 个调制信号可以被几何地表示为信号空间中的 M 个点。
    - M 元调制器可以由 D 维信号空间中的 M 个点来表示，这被称为调制器的**星座图**。

#### 能量与功率
- **调制器的平均能量 (Average Energy)**:
    - 等价于星座图中所有点到原点距离平方的平均值。
    $$
    E = \frac{1}{M} \sum_{i=1}^{M} ||\vec{s}_i||^2
    $$
- **平均发射功率 (Average Transmit Power)**:
    $$
    P_{tx} = \frac{1}{T_s} E = \frac{1}{MT_s} \sum_{i=1}^{M} ||\vec{s}_i||^2
    $$

---

## M元调制实例

### QPSK (Quadrature Phase Shift Keying)
- 每个符号携带 **2 bits**。
- 比特率 = 2 × 符号速率。
- 

### 8PSK (8-Phase Shift Keying)
- 每个符号携带 **3 bits**。
- 比特率 = 3 × 符号速率。
- 

### 16-QAM (16-Quadrature Amplitude Modulation)
- 每个符号携带 **4 bits**。
- 比特率 = 4 × 符号速率。
- 

### FSK (Frequency Shift Keying)
- **Binary FSK**: 每个符号携带 1 bit。
- **4FSK**: 信号集有4种不同的频率（tones），每个符号携带 2 bits。
- **MFSK**: 通用的 M 元频移键控。
- 

---

## 接收信号与噪声

### 时域视图 (Time Domain View)
- 经过 AWGN 信道的接收信号为：
    $$
    y(t) = \underbrace{x(t)}_{\text{transmitted signal}} + \underbrace{n(t)}_{\text{random noise}}
    $$
> [!question] 核心问题
> 如何基于观测到的、含有噪声的波形 $y(t)$，做出最佳的检测（判决）？

### 几何域视图 (Geometric Domain View)
- 信号和噪声都可以表示为向量形式：
    $$
    \vec{y} = \vec{x} + \vec{n}
    $$
- 噪声向量 $\vec{n}$ 会使接收到的信号点 $\vec{y}$ 偏离原始的发送信号点 $\vec{x}$（或 $\vec{s}_i$），形成一个以 $\vec{s}_i$ 为中心的“噪声云”。
- 

### 噪声向量的性质
假设 M 个可能发送的信号 $\{\vec{s}_1, \vec{s}_2, ..., \vec{s}_M\}$ 位于一个由标准正交基 $\{\phi_1(t), ..., \phi_N(t)\}$ 张成的 N 维信号空间中。

1.  **信号空间内的投影**:
    - 发送信号 $x(t)$ 完全位于该信号空间内。
    - 信道白噪声 $n(t)$ 可能不完全在该信号空间内。
    - **关键**：$y(t)$ 在信号空间之外的分量与已发送信息无关，对检测过程没有帮助。
    - **最优性**: 我们可以无损地将接收信号 $y(t)$ 投影到 N 维信号空间，以获得所有有用的分量。
        - 发送信号向量: $\vec{x} = (x_1, ..., x_N)$，其中 $x_n = \int_0^{T_s} x(t)\phi_n^*(t)dt$
        - 接收信号向量: $\vec{y} = (y_1, ..., y_N)$，其中 $y_n = \int_0^{T_s} y(t)\phi_n^*(t)dt$

2.  **噪声向量 $\vec{n}$ 的统计特性**:
    - **性质 I**: 噪声向量 $\vec{n}$ 是一个**高斯随机向量**。
      - 这是因为 $n(t)$ 是一个高斯白噪声过程，而 $n_n = \int_0^{T_s} n(t)\phi_n^*(t)dt$ 是高斯过程的线性变换。
    - **性质 II**: 噪声向量的**均值为 0**。
      $$
      E[n_n] = E[\int_0^{T_s} n(t)\phi_n^*(t)dt] = \int_0^{T_s} E[n(t)]\phi_n^*(t)dt = 0
      $$
    - **性质 III**: 噪声向量的分量是**独立同分布 (i.i.d.)** 的，方差为 $\eta_0/2$。
      $$
      E[n_i n_j^*] = \frac{\eta_0}{2} \int_0^{T_s} \phi_i^*(t)\phi_j(t)dt =
      \begin{cases}
      \eta_0/2 & \text{if } i=j \\
      0 & \text{otherwise}
      \end{cases}
      $$

---

## 解调器 (Demodulator) 的任务

### 检测 (Detection)
- 给定接收到的观测点 $\vec{y}$，从 M 个可能的发送点 $\{\vec{s}_1, ..., \vec{s}_M\}$ 中，解码或找出究竟是哪一个信号被发送了。

### 最佳检测 (Optimal Detection)
- 给定观测值 $\vec{y}$，对携带的信息比特做出**最佳猜测 (best guess)**。
- “最佳”的定义是**最小化误比特率 (BER)**。

> [!question] 两个核心问题
> 1.  **Q1) 最佳解调器是什么？**
>     - 在 AWGN 信道下，**最小距离检测 (Minimum Distance Detection)** 是最佳的。
>     - 它的实现结构是怎样的？
> 2.  **Q2) 使用“最小距离检测”的错误性能如何？**
>     - 使用最佳解调器时，我们还会犯错吗？（会）
>     - 犯错的机制是什么？

### 最小距离检测 (Minimum Distance Detection)

#### 最优性
- 可以证明，最佳检测器非常简单：选择与接收向量 $\vec{y}$ **欧氏距离最近**的信号向量。
    $$
    \vec{s}^* = \arg \min_{\vec{x} \in \{\vec{s}_1, ..., \vec{s}_M\}} ||\vec{y} - \vec{x}||^2
    $$
- 

#### 结构 (Architecture)
1.  **步骤1**: 将时域接收信号 $y(t)$ 转换为几何域的接收向量 $\vec{y}$ (通过一组相关器或匹配滤波器实现)。
2.  **步骤2**: 计算 $\vec{y}$ 与 M 个可能的信号点 $\vec{s}_m$ 之间的 M 个距离。
3.  **步骤3**: 确定最小距离，并选择对应的符号作为判决结果。

#### 解调器结构与简化
- 最小化欧氏距离 $||\vec{y} - \vec{s}_m||^2$ 的计算可以展开：
    $$
    d(y(t), s_m(t))^2 = ||\vec{y} - \vec{s}_m||^2 = ||\vec{y}||^2 + ||\vec{s}_m||^2 - 2 \langle \vec{y}, \vec{s}_m \rangle
    $$
- 展开后为：
    $$
    ||\vec{y}||^2 + E_m - 2 \int y(t)s_m^*(t)dt
    $$
- 由于 $||\vec{y}||^2$ 对所有 $m$ 都是常数，因此最小化距离等价于最大化下面的表达式：
    $$
    m^* = \arg \max_m \left\{ \int y(t)s_m^*(t)dt - \frac{E_m}{2} \right\}
    $$
- 这导出了一个简化的**相关器接收机**结构。



---

## 错误分析 (Error Analysis)

### 定性分析
- 错误发生的原因是噪声。噪声功率由 $||\vec{n}||^2$ 决定。
- 当噪声足够大，使得接收点 $\vec{y} = \vec{s}_i + \vec{n}$ 落入了另一个信号 $\vec{s}_j$ 的判决区域时，就会发生判决错误。
- 错误概率 $P_e$ 主要由星座图中信号点之间的**最小距离 $d_{min}$** 决定。
    $$
    P_e \approx Q\left( \sqrt{\frac{d_{min}^2}{2\eta_0}} \right)
    $$
    其中 $d_{min} = \min_{i, j, i \neq j} ||\vec{s}_i - \vec{s}_j||$，$Q(\cdot)$ 是标准高斯分布的尾概率函数。



### 定性模型的应用与洞察

> [!info] 设计洞察
> - 比较不同调制方案的优劣。
> - 解释“性能”与“资源”之间的权衡机制。

#### 示例 1: ASK vs FSK
- ASK (振幅键控) 和 FSK (频率键控) 哪种更好？
- 这取决于我们如何定义“更好”。需要比较它们的星座图，分析在相同功率和比特率下的 $d_{min}$。

#### 示例 2: 2D空间中的四元调制
- 在二维信号空间上，有没有比 QPSK 更好的四元调制方案？
- QPSK 将四个点均匀分布在一个圆上，最大化了点之间的最小距离 $d_{min}$，因此在功率效率上是非常优化的。

#### 示例 3: 16QAM vs 16PSK
- 为什么 16QAM 比 16PSK 更受欢迎？
- 在相同的峰值或平均功率下，16QAM 的星座图布局使得其 $d_{min}$ 大于 16PSK 的 $d_{min}$。这意味着在相同的信噪比下，16QAM 的误码性能更好。
    - 16QAM: $d_2 = \frac{\sqrt{2}A_M}{3} \approx 0.471 A_M$
    - 16PSK: $d_1 \approx A_M(\frac{\pi}{8}) \approx 0.393 A_M$
- 

---

## 核心权衡 (Tradeoffs)

> [!summary] 参数关系总结
> - **带宽 (Bandwidth)** ⬆️  ➡️ **比特率 (Bit Rate)** ⬆️
>   - 带宽与符号速率成正比，提高符号速率直接提高比特率。
> - **功率 (Power)** ⬆️  ➡️ **错误概率 (Error Probability)** ⬇️
>   - 增加功率相当于将星座图上的所有点等比例地拉离原点，增大了 $d_{min}$，从而降低了错误概率。
> - **功率 (Power)** ⬆️  ➡️ (间接) **比特率 (Bit Rate)** ⬆️
>   - 增加功率可以支持更密集的星座图（如从 QPSK 升级到 16QAM），在不增加带宽的情况下提高比特率，同时保持可接受的错误概率。
> - **带宽 (Bandwidth)** ⬆️ ➡️ (间接) **错误概率 (Error Probability)** ⬇️
>   - 以 MFSK 为例，增加 M 会同时增加带宽和比特率。在给定的 $E_b/N_0$ 下，符号能量 $E_s = E_b \log_2(M)$ 会增加。同时信号空间的维度也增加到 M，使得信号点在更高维空间中变得更“稀疏”，$d_{min}$ 增大，从而降低了错误概率。

---

## 不同效率目标的调制方案

### 面向高频谱效率 (High Spectral Efficiency)
- **M-ary PSK 和 M-ary QAM**
- **特点**:
    - 信号空间维度始终为 2。
    - 传输带宽对所有 M 保持不变。
    - 比特率: $\text{log}_2(M) \times (1/T_s)$。增加 M 可以在不消耗更多带宽的情况下提高比特率。
- **代价**:
    - 随着 M 的增加，星座点变得更密集，$d_{min}$ 减小。
    - 为保持相同的错误概率，必须**增加发射功率**。
- **结论**: 这类调制方案以**高信噪比 (SNR)** 为代价，实现了**高频谱效率 (Bit rate / BW)**。

### 面向高功率效率 (High Power Efficiency)
- **M-FSK (正交调制)**
- **特点**:
    - 信号集中的信号相互正交。
    - 需要 M 维信号空间来容纳 M 个信号。
    - 额外的维度来自于额外的带宽 (Tx-BW = M × (1/Ts))。
    - 随着 M 增加，信号空间也变得“更大”。
- **优势**:
    - 在相同的 $E_b/N_0$ 下，增加 M 会使星座点之间的距离**增加**，错误概率随之**下降**。
- **结论**: MFSK 善于节省功率（在低 $E_b/N_0$ 下工作），但代价是**带宽的扩展**。

### 案例分析 (Case Study)

> [!question] Case 1: 卫星通信
> **场景**: 为卫星到地球站的通信选择调制方案。
> **分析**: 卫星通信通常是**功率受限**的（卫星上的太阳能电池板功率有限）。因此，应优先选择**功率效率高**的调制方式，如 BPSK, QPSK 或 MFSK。

> [!question] Case 2: 无线视频链路
> **场景**: 在香港大屿山和科技大学之间建立无线视频链路。
> **分析**: 地面无线通信的频谱资源通常是**带宽受限**的。为了传输高清视频所需的高数据率，应选择**频谱效率高**的调制方式，如 16QAM, 64QAM 等。

---

## 最佳检测的数学证明

### 判决区域 (Decision Region)
- 任何解调方案都可以用观测空间 $\mathbf{y}$ 上的一个**判决区域**划分来表示。
- 对于 M 个可能的发送符号 $\{s_1, ..., s_M\}$，观测空间被划分为 M 个互不相交的区域 $\{R_1, ..., R_M\}$。
- 判决规则为：如果接收向量 $\vec{y} \in R_j$，则判决为发送了 $s_j$。
    $$
    R_j = \{\vec{y} : \text{decide } s_j\}
    $$
- 对于等概率信号的最小距离检测器，判决区域的边界是连接任意两个信号点的线段的**垂直平分线**。

### 从平均错误概率推导
- 平均错误概率 $P_e$ 为：
    $$
    P_e = \sum_{j=1}^{M} p(s_j) \int_{R_j^c} p(\vec{y}|s_j) d\vec{y} = 1 - \sum_{j=1}^{M} \int_{R_j} p(s_j)p(\vec{y}|s_j) d\vec{y}
    $$
- 为了最小化 $P_e$，我们需要最大化求和项 $\sum \int_{R_j} p(s_j)p(\vec{y}|s_j) d\vec{y}$。
- 由于每个接收到的 $\vec{y}$ 必须且只能属于一个判决区域 $R_j$，所以最优策略是：对于每一个 $\vec{y}$，都将它分配给能使被积函数 $p(s_j)p(\vec{y}|s_j)$ 最大的那个区域 $R_j$。

### 最佳判决准则
- **最大后验概率 (MAP) 准则**:
    $$
    s^* = \arg \max_{s \in \{s_1, ..., s_M\}} p(s)p(\vec{y}|s)
    $$
- **最大似然 (ML) 检测**:
    - 如果所有 M 个符号是**等概率**的 ($p(s_j) = 1/M$)，MAP 准则简化为最大化**似然函数 $p(\vec{y}|s)$**。
    $$
    s^* = \arg \max_{s \in \{s_1, ..., s_M\}} p(\vec{y}|s)
    $$

### ML 检测与最小距离检测的等价性
- 在 AWGN 信道中，接收向量 $\vec{y} = \vec{s} + \vec{n}$。
- 由于噪声向量 $\vec{n}$ 的分量是均值为0，方差为 $\sigma_n^2 = \eta_0/2$ 的独立高斯随机变量，似然函数为：
    $$
    p(\vec{y}|\vec{s}) \sim \exp\left( -\frac{1}{2\sigma_n^2} ||\vec{y}-\vec{s}||^2 \right)
    $$
- 最大化 $p(\vec{y}|\vec{s})$ 等价于最小化指数部分的正项，即最小化欧氏距离的平方 $||\vec{y}-\vec{s}||^2$。
    $$
    \arg \max_{\vec{s}} p(\vec{y}|\vec{s}) = \arg \min_{\vec{s}} ||\vec{y}-\vec{s}||^2
    $$
> [!success] 结论
> 这证明了在 AWGN 信道和等概率发送符号的条件下，**最小距离检测**就是**最大似然检测**，因此是**最优的**。

---

## 错误概率分析的证明

### 错误概率上界
- 我们要证明：
    $$
    P_e \le Q\left( \sqrt{\frac{d_{min}^2}{2\eta_0}} \right)
    $$
- 假设发送的是 $s_1$，错误事件 $\Psi_1$ 是指接收到的 $\vec{y}$ 离 $s_1$ 的距离不比离其他某个 $s_n$ 的距离更近。
    $$
    \Psi_1 = \bigcup_{n \neq 1} \{||\vec{y}-s_n||^2 \le ||\vec{y}-s_1||^2\}
    $$
- 利用联合界 (Union Bound):
    $$
    P_e(s_1) = P(\Psi_1 | s_1) \le \sum_{n \neq 1} P(||\vec{y}-s_n||^2 \le ||\vec{y}-s_1||^2 | s_1)
    $$
- 对成对错误事件进行分析 $||\vec{y}-s_j||^2 \le ||\vec{y}-s_1||^2$：
    - 代入 $\vec{y} = \vec{s}_1 + \vec{n}$，化简得到：
        $$
        (\vec{s}_j - \vec{s}_1) \cdot \vec{n} \ge \frac{1}{2} ||\vec{s}_j - \vec{s}_1||^2
        $$
    - 令 $Z_j = (\vec{s}_j - \vec{s}_1) \cdot \vec{n} = \int [s_j(t)-s_1(t)]n(t)dt$。$Z_j$ 是一个零均值的高斯随机变量，其方差为：
        $$
        \sigma_Z^2 = \frac{\eta_0}{2} ||\vec{s}_j - \vec{s}_1||^2
        $$
- 成对错误概率 $P_j$ 为：
    $$
    P_j = P\left(Z_j \ge \frac{1}{2}||\vec{s}_j-\vec{s}_1||^2\right) = Q\left(\frac{\frac{1}{2}||\vec{s}_j-\vec{s}_1||^2}{\sqrt{\frac{\eta_0}{2}||\vec{s}_j-\vec{s}_1||^2}}\right) = Q\left(\sqrt{\frac{||\vec{s}_j-\vec{s}_1||^2}{2\eta_0}}\right)
    $$
- 应用联合界，并用最小距离项来近似：
    $$
    P_e \le \sum_{j \neq 1} P_j \approx Q\left(\sqrt{\frac{d_{min}^2}{2\eta_0}}\right)
    $$
- 证明完毕。