好的，这是根据您提供的课件整理的关于 **同步 (Synchronization)** 的Obsidian Markdown笔记。笔记内容涵盖了全部课件页面，包含了所有知识点，并使用了相应的格式要求。

---

# Lecture 14. 同步 (Synchronization)

- **主讲人:** Prof. An Liu
- **单位:** College of ISEE, Zhejiang University

---

## 锁相环 (Phase-locked Loop, PLL)

> [!info] 什么是锁相环？
> 锁相环 (PLL) 是一种重要的同步技术，用于估计周期信号的相位。它主要由三个部分组成：
> 1.  **鉴相器 (Phase Detector, PD)**
> 2.  **环路滤波器 (Loop Filter, LF)**
> 3.  **压控振荡器 (Voltage-controlled Oscillator, VCO)**

### PLL 结构

![[Pasted image 20240101120001.png]]
*图：PLL基本结构*

- **输入信号:** $u(t) = \cos(2\pi f_c t + \varphi)$
- **VCO输出 (反馈信号):** $\sin(2\pi f_c t + \hat{\varphi})$
- **鉴相器输出:** 鉴相器是一个乘法器。
$$
\begin{align*}
e(t) &= \cos(2\pi f_c t + \varphi) \cdot \sin(2\pi f_c t + \hat{\varphi}) \\
&= \frac{1}{2}\sin(\varphi - \hat{\varphi}) + \frac{1}{2}\sin(4\pi f_c t + \varphi + \hat{\varphi})
\end{align*}
$$
- **环路滤波器 (LP):** 是一个低通滤波器，滤除高频分量。
  - 滤波器输出: $v(t) = \frac{1}{2}\sin(\varphi - \hat{\varphi})$
  - 环路滤波器的一个例子（积分滤波器）:
  $$
  G(s) = \frac{1+\tau_2 s}{1+\tau_1 s}
  $$
  这是一个参数为 $\tau_1, \tau_2$ (通常 $\tau_1 \gg \tau_2$) 的积分滤波器，用于控制环路带宽。
- **压控振荡器 (VCO):** 环路滤波器的输出电压 $v(t)$ 用来控制VCO。
  - VCO 输出一个相位是其输入电压积分的正弦信号。
  - VCO 输出信号的相位:
  $$
  2\pi f_c t + \hat{\varphi}(t) = 2\pi f_c t + K \int_{-\infty}^{t} v(\tau)d\tau
  $$
  - 因此，VCO的相位估计 $\hat{\varphi}(t)$ 是：
  $$
  \hat{\varphi}(t) = K \int_{-\infty}^{t} v(\tau)d\tau
  $$
  其中 $K$ 是VCO的增益。

### PLL 等效框图

在分析环路动态特性时，我们可以忽略高频项，得到PLL的等效基带模型（相位域模型）。

![[Pasted image 20240101120002.png]]
*图：PLL等效框图*

### 鉴相器特性

- 鉴相器输出电压 $V_d$ 与输入相位差 $\Delta\varphi = \varphi - \hat{\varphi}$ 的关系为正弦函数：
$$
V_d = K_d \sin(\varphi - \hat{\varphi}) = K_d \sin \Delta\varphi
$$
![[Pasted image 20240101120003.png]]
*图：鉴相器特性曲线*

> [!success] 结论
> - 当相位差 $\Delta\varphi > 0$ 时, $v_d > 0$, VCO频率增加, $\hat{\varphi}$ 增大, 使得相位误差 $\Delta\varphi$ 减小。
> - 当相位差 $\Delta\varphi < 0$ 时, $v_d < 0$, VCO频率减小, $\hat{\varphi}$ 减小, 使得相位误差 $\Delta\varphi$ 减小。
> - **稳定点 (Fixed point):** $\Delta\varphi = 0$。此时环路锁定。

### 线性化模型与传递函数

> [!note] 跟踪模式 (Tracking Mode)
> 在跟踪模式下，相位误差很小 ($\Delta\varphi \approx 0$)，我们可以进行线性近似：
> $$ \sin(\varphi - \hat{\varphi}) \approx \varphi - \hat{\varphi} $$

- **闭环方程 (s域):**
$$
\frac{1}{2}[\varphi(s) - \hat{\varphi}(s)] \cdot G(s) \cdot \frac{K}{s} = \hat{\varphi}(s)
$$
- **传递函数 $H(s)$:**
$$
H(s) = \frac{\hat{\varphi}(s)}{\varphi(s)} = \frac{KG(s)/s}{1+KG(s)/s}
$$
- **使用积分滤波器:** 将 $G(s) = \frac{1+\tau_2 s}{1+\tau_1 s}$ 代入，得到二阶锁相环的传递函数：
$$
H(s) = \frac{1+\tau_2 s}{1+(\tau_2 + 1/K)s + (\tau_1/K)s^2}
$$
- 可以表示为标准二阶系统形式：
$$
H(s) = \frac{(2\zeta\omega_n - \omega_n^2/K)s + \omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}
$$
其中：
- **自然频率 (Natural frequency):** $\omega_n = \sqrt{K/\tau_1}$
- **阻尼系数 (Damping factor):** $\zeta = (\tau_2 + 1/K)/(2\omega_n)$

- **等效噪声带宽 (Equivalent noise bandwidth):**
$$
B_{eq} = \frac{\tau_2^2(1/\tau_2^2 + K/\tau_1)}{4(\tau_2+1/K)} = \frac{1+(\tau_2\omega_n)^2}{8\zeta\omega_n}
$$

![[Pasted image 20240101120004.png]]
*图：不同阻尼系数 ζ 下的PLL闭环幅频响应*

### 非线性模型 (捕获模式)

> [!warning] 捕获模式 (Capture Mode)
> 在捕获模式下，相位误差较大，线性近似不再成立。

- **环路方程变为:**
$$
\frac{K}{s}G(s) \cdot \sin[\varphi(t) - \hat{\varphi}(t)] = \hat{\varphi}(t)
$$
- **考虑一阶环路 ($G(s)=1$):**
$$
\frac{d\Delta\varphi(t)}{dt} = \frac{d\varphi(t)}{dt} - \frac{K}{2}\sin\Delta\varphi(t)
$$
- **若输入相位为常数 $\varphi(t)=\theta_0$ (频率失锁):**
$$
\frac{d\Delta\varphi(t)}{dt} = -\frac{K}{2}\sin\Delta\varphi(t)
$$

![[Pasted image 20240101120005.png]]
*图：一阶PLL的相位图*
- 红色点 (0, 2π, ...) 是稳定平衡点。
- 绿色点 (-π, π, ...) 是不稳定平衡点。

### 带加性噪声的PLL

- **含噪输入信号:**
$$
r(t) = s(t) + n(t) = A_c \cos[2\pi f_c t + \varphi(t)] + n(t)
$$
- **加性窄带噪声:**
$$
n(t) = x(t)\cos(2\pi f_c t) - y(t)\sin(2\pi f_c t)
$$
其中 $x(t), y(t)$ 是独立的零均值高斯过程，单边功率谱密度为 $N_0$ W/Hz。
- 噪声也可以表示为相对于信号相位的形式：
$$
n(t) = n_c(t)\cos[2\pi f_c t+\varphi(t)] - n_s(t)\sin[2\pi f_c t+\varphi(t)]
$$
其中 $n_c(t)$ 和 $n_s(t)$ 与 $x(t), y(t)$ 具有相同的统计特性。
- **含噪误差信号:**
经过乘法器和低通滤波器后，误差信号为：
$$
e(t) = A_c \sin\Delta\varphi + n_c(t)\sin\Delta\varphi - n_s(t)\cos\Delta\varphi = A_c \sin\Delta\varphi + n_1(t)
$$
其中 $\Delta\varphi = \varphi - \hat{\varphi}$。

![[Pasted image 20240101120006.png]]
*图：含加性噪声的PLL等效框图*

- **线性跟踪模式下的模型:**
![[Pasted image 20240101120007.png]]
*图：含噪PLL的线性模型*
- **等效输入相位噪声:** $n_2(t) = n_1(t)/A_c$，其功率谱密度为 $N_0/A_c^2$。
- **相位误差方差:**
$$
\sigma_{\hat{\varphi}}^2 = \frac{N_0}{A_c^2} \int_{-\infty}^{\infty} |H(j2\pi f)|^2 df = \frac{N_0/2}{P_c} \cdot 2B_{neq} = \frac{N_0 B_{neq}}{P_c} \hat{=} \frac{1}{\gamma_L}
$$
- **等效噪声带宽:**
$$
B_{neq} = \frac{1}{2} \int_{-\infty}^{\infty} |H(j2\pi f)|^2 df
$$
- **环路信噪比 (SNR):**
$$
\gamma_L = \frac{P_c}{N_0 B_{eq}}
$$

### 相位误差的概率密度函数 (PDF)

- **线性近似模型下:** 输出相位误差 $\Delta\varphi$ 可近似为零均值，方差为 $\sigma_{\hat{\varphi}}^2$ 的高斯分布。
- **非线性模型下 (Viterbi):** 对于一阶PLL，Viterbi给出了相位误差的精确PDF：
$$
p(\Delta\varphi) = \frac{\exp(\gamma_L \cos\Delta\varphi)}{2\pi I_0(\gamma_L)}
$$
其中 $I_0(\cdot)$ 是第一类零阶修正贝塞尔函数。
- **相位误差方差:**
$$
\sigma_{\hat{\varphi}}^2 = \int_{-\pi}^{\pi} \Delta\varphi^2 p(\Delta\varphi)d\Delta\varphi
$$

![[Pasted image 20240101120008.png]]
*图：VCO相位估计方差 vs. 环路信噪比的倒数 (精确模型 vs. 线性模型)*

> [!summary] 小结
> 噪声会影响相位估计的准确性。在线性模型中，相位误差方差与噪声功率成正比，与信号功率成反比。当信噪比较低时，线性模型失效，实际的相位误差方差比线性模型预测的要大。

---

## 载波同步 (Carrier Synchronization)

> [!info] 为什么需要载波同步？
> 在相干解调中，接收机需要从接收信号中提取出与发射端同频同相的载波。对于双边带抑制载波 (DSB-SC) 和相移键控 (PSK) 等信号，由于载波分量被抑制，不能直接使用PLL进行跟踪。

**两种广泛使用的方法:**
1.  **直接提取法 (Direct extraction method)**
2.  **导频音插入法 (Pilot-tone insertion method)**

### 直接提取法

> [!note] 原理
> 使用各种非线性变换方法，从接收信号中再生出载波分量或其谐波分量，然后再利用PLL进行提取。

**主要方法:**
- **平方变换 (Square transformation)**
- **科斯塔斯环 (Costas loop)**
- **判决反馈环 (Decision-feedback loop)**

#### 1. 平方变换 (平方环)

- **接收信号 (DSB-SC/BPSK):**
$$
r(t) = A_c m(t) \cos(2\pi f_c t + \varphi_c) + n(t)
$$
其中 $E[m(t)]=0$，所以信号功率谱中没有离散的载波谱线。
- **平方律器件输出:**
$$
\begin{align*}
r^2(t) &= \frac{1}{2}A_c^2 m^2(t) \cos^2(2\pi f_c t + \varphi_c) + n'(t) \\
&= \frac{1}{2}A_c^2 m^2(t) + \frac{1}{2}A_c^2 m^2(t)\cos(4\pi f_c t + 2\varphi_c) + n'(t)
\end{align*}
$$
平方后产生了二倍载波频率 $2f_c$ 的分量。
- **实现框图:**
![[Pasted image 20240101120009.png]]
*图：平方环框图*
通过PLL锁定 $2f_c$ 和 $2\varphi_c$，然后通过二分频器得到所需的载波 $f_c$ 和 $\varphi_c$。

> [!warning] 平方环的两个问题
> 1.  **噪声性能:**
>     - 噪声被放大，并且平方项 $n^2(t)$ 使得噪声不再是高斯分布，功率谱也不再平坦。
>     - 相位误差估计的方差为:
>     $$ \sigma_{\hat{\varphi}}^2 = \frac{1}{\gamma_L \cdot S_L} $$
>     其中 $S_L$ 是 **平方损耗因子 (square loss factor)**:
>     $$ S_L = \frac{1}{1 + \frac{B_{bp}/2B_{neq}}{\gamma_L}} $$
>     $B_{bp}$ 是PLL前带通滤波器(BPF)的带宽。这表明平方环相比理想PLL有信噪比损失。
>
> 2.  **相位模糊性 (Phase ambiguity):**
>     - 环路的鉴相特性为 $v_d = K_d \sin(2\Delta\varphi)$。
>     - 存在两个稳定点: $\Delta\varphi = 0$ 和 $\Delta\varphi = \pi$。
>     - 这导致恢复的载波可能与原始载波有180°的相位差，对于BPSK解调会导致比特反转。

![[Pasted image 20240101120010.png]]
*图：平方环的相位模糊性*

#### 2. 科斯塔斯环 (Costas Loop)

- **实现框图:**
![[Pasted image 20240101120011.png]]
*图：Costas环框图*
- **工作原理:**
  - 输入信号 $s(t) = A_c m(t)\cos(2\pi f_c t + \varphi)$。
  - VCO产生同相(I)和正交(Q)两路载波: $v_1(t)=\cos(2\pi f_c t + \hat{\varphi})$, $v_2(t)=\sin(2\pi f_c t + \hat{\varphi})$。
  - I/Q两路分别与输入信号相乘并低通滤波，得到：
    - $v_5(t) = \frac{1}{2}A_c m(t) \cos\Delta\varphi$ (解调数据)
    - $v_6(t) = \frac{1}{2}A_c m(t) \sin\Delta\varphi$
  - 两路信号再相乘得到误差信号：
    $$
    v_d(t) = v_5(t)v_6(t) \propto m^2(t) \sin(2\Delta\varphi)
    $$
    由于 $m(t)=\pm 1 \Rightarrow m^2(t)=1$，所以误差信号与调制信号无关。
- **相位特性:** $v_d(t) = \frac{1}{8} A_c^2 m^2(t) \sin(2\Delta\varphi)$，与平方环类似。
- **问题:** 同样存在 **180°相位模糊性** 和 **噪声性能下降** 的问题 (因为误差信号中含有 `信号×噪声` 和 `噪声×噪声` 项)。

#### 3. 判决反馈环 (Decision-Feedback Loop)

- **适用场景:** BPSK信号, $s(t) = A_c m(t)\cos(2\pi f_c t + \varphi)$, 其中 $m(t) \in \{\pm 1\}$。
- **原理:** 在相干解调中，用解调出的信号（判决结果）去乘以输入信号，以消除调制对载波提取的影响。
- **实现框图:**
![[Pasted image 20240101120012.png]]
*图：判决反馈环框图*
- **工作原理:**
  1.  输入信号 $s(t)$ 与本地载波 $v_2(t)$ 相乘，得到 $v_4(t) \propto m(t)\cos\Delta\varphi$。
  2.  $v_4(t)$ 经过积分器、采样判决器，得到对 $m(t-T)$ 的估计 $\hat{m}(t-T)$。
  3.  假定判决正确 $\hat{m}(t-T)=m(t-T)$，误差信号为：
  $$
  v_d(t) \propto s(t-T) \cdot \hat{m}(t-T) \cdot v_1(t) \propto \sin\Delta\varphi
  $$
- **环路滤波器输出:** $v_d(t) = \frac{1}{2}A_c \sin\Delta\varphi$。
- **优点:** 鉴相特性为 $\sin\Delta\varphi$，**不存在相位模糊性**。
- **缺点:**
  - 性能受判决错误影响。考虑误码率 $P_e$，误差信号变为:
    $$
    v_d(t) = \frac{1}{2}A_c (1-2P_e) \sin\Delta\varphi
    $$
  - BPSK的误码率本身又受相位误差影响：
    $$ P_e = Q\left(\sqrt{\frac{2E_b}{N_0}\cos^2\Delta\varphi}\right) $$
  - **需要符号同步** 才能正确进行判决和反馈。

### MPSK信号的载波提取

- **M次幂环 (M-power Loop):** 对于MPSK信号，需要进行M次幂变换才能产生 $Mf_c$ 的谱线。
  - 例如，QPSK信号需要进行4次幂变换。
  - 然后通过PLL锁定 $Mf_c$ 分量，再进行M分频。
![[Pasted image 20240101120013.png]]
*图：M次幂环*

- **M相科斯塔斯环 (M-phase Costas loop):**
![[Pasted image 20240101120014.png]]
*图：M相Costas环*

### 导频音插入法

> [!note] 原理
> 在发送信号的同时，在某个特定的谱线位置发送一个载波分量（导频）。接收端用一个窄带滤波器或PLL即可提取该导频作为相干载波。

- **适用情况:**
  - 接收信号中没有离散的载波分量。
  - 载波频率附近信号幅度很低 (例如SSB信号)。
- **导频音的选择:**
  - 频率 $f_c$ 与载波频率有关。
  - 频率 $f_c$ 满足 $|X(f)|\approx 0$，即在信号频谱的零点或低谷处。
  - 相位通常与已调载波**正交**。

![[Pasted image 20240101120015.png]]
*图：插入导频*

- **实现:**
![[Pasted image 20240101120016.png]]
*图：导频插入法发送端*
- **输出信号:** $s_0(t) = A m(t)\sin(2\pi f_c t) + A \cos(2\pi f_c t)$

> [!question] 为什么导频要与载波正交 (90°相移)?
> - 假设导频与载波同相，解调时，导频分量会变为一个直流项，这可能会影响判决。
> - 使用正交载波和导频，在解调时，导频分量会落到零频附近的正交支路，不会干扰同相支路的数据解调。
> 如图所示，用 $\sin(2\pi f_c t)$ 解调，输出信号 $v(t)$ 经过低通滤波后：
> $$ v(t)_{LP} = \frac{A}{2}m(t) - \frac{A}{2}\sin(4\pi f_c t) $$
> 如果导频是 $\sin$ 信号，则会产生直流项 $\frac{A}{2}$。

---

## 相位失配对BER的影响

- **影响:** 相干解调中的相位失配会损害BER性能。相位误差 $\Delta\varphi$ 导致信噪比下降 $\cos^2\Delta\varphi$ 倍。
- **BPSK的BER:**
$$
P_e(\Delta\varphi) = Q\left(\sqrt{2E_b/N_0 \cdot \cos^2\Delta\varphi}\right)
$$
- **平均BER:** 假设 $\Delta\varphi$ 是一个随机变量，其PDF为 $p(\Delta\varphi)$，则平均BER为：
$$
P_e = \int Q\left(\sqrt{2\rho\cdot\cos^2\Delta\varphi}\right) \cdot p(\Delta\varphi)d\Delta\varphi
$$
在线性化PLL中, $\Delta\varphi$ 近似为高斯分布: $p(\Delta\varphi) \approx N(\Delta\varphi; 0, \sigma_{\hat{\varphi}}^2)$。

![[Pasted image 20240101120017.png]]
*图：相位抖动对BPSK系统BER的影响*

> [!summary] 结论
> - 在正常信噪比下，小的相位失配 (抖动) 导致的BER性能下降很小，可以忽略。
> - 当相位抖动的标准差 $\sigma_{\hat{\varphi}}$ 大于0.3rad时，即使信噪比趋于无穷大，BER也会急剧下降到一个无法再降低的水平，这被称为 **不可降低的误码率 (non-reducible BER)**。
> - 对于设计良好的相位跟踪环路，SNR升高 $\Rightarrow \gamma_L$ 升高 $\Rightarrow \sigma_{\hat{\varphi}}^2$ 下降，所以不可降低的误码率很少出现。

> [!example] BPSK相干解调BER比较
> - **问题:** 比较环路信噪比 $\gamma_L$ 分别为20dB和10dB时的BER性能。($\gamma_L = 1/\sigma_{\hat{\varphi}}^2$)
> - **解:**
>   - 当 $\gamma_L = 20\text{dB} = 100$, 则 $\sigma_{\hat{\varphi}} = \sqrt{1/100} = 0.1\text{rad}$。查图可知，要达到 $P_e=10^{-5}$，需要 $E_b/N_0 \approx 9.6\text{dB}$。
>   - 当 $\gamma_L = 10\text{dB} = 10$, 则 $\sigma_{\hat{\varphi}} = \sqrt{1/10} \approx 0.32\text{rad}$。查图可知，要达到 $P_e=10^{-5}$，需要 $E_b/N_0 \approx 10.4\text{dB}$。
>   - 信噪比差异为 $0.8\text{dB}$。
> - **结论:** 从图中看，如果 $\gamma_L < 10\text{dB}$，BER性能会急剧恶化。因此，$\gamma_L = 10\text{dB}$ 是一个合理的门限。

### 不同载波同步方法的优缺点

| 方法类型 | 具体方法 | 优点 | 缺点 |
| :--- | :--- | :--- | :--- |
| **直接提取法** | 平方环 | （相对）易于实现 | 放大噪声, 180°相位模糊, $2f_c$ 不易获得 |
| | 科斯塔斯环 | 易于实现 | 放大噪声, 180°相位模糊 |
| | 判决反馈环 | 不存在相位模糊 | 需要符号同步, 性能受误码影响 |
| **导频插入法** | - | 相对容易实现 | 只能用于无离散载波分量的信号, 浪费功率 |

---

## 比特同步 (Bit Synchronization)

> [!info] 什么是比特同步？
> 在数字系统中，比特/符号同步的目的是在接收端确定每个符号的开始和结束时间。比特同步在数字系统的同步中至关重要。

- **外同步 (External synchronization):** 与数据信号同时传输一个独立的比特同步信号（如比特率时钟信号）。
- **自同步 (Self-synchronization):** 比特率信息蕴含在数据序列中，通过专门设计的电路系统提取出来。

**自同步方法包括:**
- **开环滤波法 (Open-loop filtering method)**
- **闭环锁定法 (Closed-loop locking method)**

### 开环滤波法

> [!note] 原理
> 首先利用非线性变换（如平方、过零检测等）从接收数据信号中产生比特率的功率谱分量，然后用一个窄带滤波器（可能是一个锁相环）提取出比特同步信号。

#### 基于平方变换

- **匹配滤波器输出:**
$$
y(t) = \sum_{n=-\infty}^{\infty} a_n x(t - nT - \tau_0) + n(t)
$$
其中 $\tau_0$ 是数据信号的时钟相位。由于 $E[a_n]=0$，不能直接从 $y(t)$ 中提取频率为 $1/T$ 的谱线。
- **平方后:**
$$
E[y^2(t)] = \sigma_a^2 \sum_{n=-\infty}^{\infty} x^2(t - nT - \tau_0) + \text{noise}
$$
这个信号是周期为T的，因此包含 $1/T$ 的频率分量。
- **利用泊松公式 (Poisson formula):**
$$
\sigma_a^2 \sum x^2(t - nT - \tau_0) = \frac{\sigma_a^2}{T} \sum_m c_m e^{j2\pi m(t-\tau_0)/T}
$$
如果基带信号 $X(f)=0, |f|>1/T$，则平方后的信号包含直流和 $1/T$ 的频率分量。
- **窄带滤波器输出:**
$$
\frac{\sigma_a^2}{T} \text{Re}[c_1 e^{j2\pi(t-\tau_0)/T}] = \frac{\sigma_a^2}{T} c_1 \cos\left(\frac{2\pi}{T}(t-\tau_0)\right)
$$
- **时钟恢复:**
  - 这个输出信号的过零点时刻为 $t = kT + \tau_0 + T/4$。
  - 这与数据时钟 $kT+\tau_0$ 之间存在一个 $T/4$ 的延迟，可以通过一个 $\pi/2$ 的相移来补偿。

![[Pasted image 20240101120018.png]]
*图：基于平方变换的开环滤波器同步*

#### 其他开环方法

- **延迟倍乘法:**
![[Pasted image 20240101120019.png]]
*图：延迟倍乘法原理*
信号与其延迟半个码元周期的版本相乘，产生在每个比特边缘的脉冲序列，滤波后可得时钟。

- **微分整流法:**
![[Pasted image 20240101120020.png]]
*图：微分整流法原理*
信号经过微分产生跳变沿的脉冲，再经过全波整流，滤波后可得时钟。

- **性能:**
  - 开环滤波会因噪声影响产生定时误差。
  - 平均定时误差 $\bar{\varepsilon}$ 和方差 $\sigma_\varepsilon^2$:
  $$
  \frac{|\bar{\varepsilon}|}{T} \approx \frac{0.33}{\sqrt{KE_b/N_0}}, \quad \frac{E_b}{N_0} > 5, K \ge 18
  $$
  $$
  \frac{\sigma_\varepsilon}{T} \approx \frac{0.411}{\sqrt{KE_b/N_0}}, \quad \frac{E_b}{N_0} > 1
  $$
  其中K是窄带滤波器平均的比特数。当信噪比足够大时，可以获得精确的比特同步。

### 闭环锁定法

> [!warning] 开环法的缺点
> 开环滤波法的主要缺点是存在 **非零的平均跟踪误差**，因为同步信号直接依赖于输入信号。

> [!note] 闭环法的优点
> 闭环锁定法通过比较输入信号和本地时钟信号来同步本地时钟，工作方式类似于载波跟踪环，可以 **消除平均跟踪误差**。

#### 早迟门同步 (Early-Late Gate Synchronization)

- **原理:** 这是最常见的闭环比特同步方法之一。虽然是次优的，但易于实现。
- **结构:**
![[Pasted image 20240101120021.png]]
*图：早迟门同步器框图*
- **工作过程:**
  - 环路有两个积分器: **早积分器** 和 **迟积分器**。
  - 两个积分器的积分时间长度为 $T-d$，其 **起止时刻由VCO控制**。
  - 两个积分器输出绝对值的差作为接收机符号定时误差的度量，该输出用于控制VCO，通过环路滤波器校正定时误差。
  - **超前时:** 如果接收机的早迟门定时超前于输入数据，误差信号 $e = -2\Delta$。该误差信号降低VCO的输出频率，使接收机时钟延迟，从而接近输入数据定时。
  - **滞后时:** 如果接收机的早迟门定时滞后于输入数据，误差信号 $e = 2\Delta$。该误差信号提高VCO的输出频率，使接收机时钟提前，从而减小与输入数据时钟之间的误差。
  - **同步时:** 如果接收机的早迟门定时与输入数据同步，两个积分器输出的绝对值相同，误差电压为0，同步稳定。

![[Pasted image 20240101120022.png]]
*图：早迟门定时示意图*

- **问题:**
  - 当数据状态不改变时（例如连续的“0”或连续的“1”），误差信号为0，环路失去跟踪信息，可能导致同步漂移。
  - **解决方法:**
    1.  **限制连码长度:** 通过信道编码（如扰码）来保证数据有足够的跳变。
    2.  **修正环路:** 例如采用 **Tau-dither环**，它只用一个积分器，可以消除两路不平衡的影响。

#### 数据传输跟踪环 (DTTL)

- DTTL是根据参数最大似然估计原理导出的一种判决反馈式比特同步环，是一种性能良好的比特同步环。
- **结构:**
![[Pasted image 20240101120023.png]]
*图：DTTL环路框图*
- **输入:** $s(t) = \sqrt{P}\sum_k a_k p(t-kT-\tau)$, $p(t)$ 为不归零码。
- **误差:** 同步误差 $\Delta\tau = \tau - \hat{\tau}$。
- **工作原理:**
  - **相干积分支路 (上支路):** 在一个码元周期内积分，用于数据判决。
  - **中点积分支路 (下支路):** 在两个码元中间的窗口进行积分。
  - 中点积分器的输出幅度与同步误差的绝对值 $|\Delta\tau|$ 有关，但其极性不仅与 $\Delta\tau$ 的极性有关，还与符号的极性转换方向有关。
  - 因此，中点积分器的输出不能直接用作误差信号，必须与数据传输检测器（判决器）的输出相结合，得到能反映同步误差大小和极性的误差信号。

![[Pasted image 20240101120024.png]]
*图：DTTL定时波形*

- **性能:** 考虑噪声时，相干积分的符号判决可能出错。平均误差相位鉴别特性增益为：
$$
D(\Delta\tau) = E[I_k J_k | \Delta\tau] = -K_2\sqrt{P}\Delta\tau(1-2P_e)
$$
- **等效模型:**
![[Pasted image 20240101120025.png]]
*图：DTTL等效模型*

### 不同比特同步方法的优缺点

| 方法 | 优点 | 缺点 |
| :--- | :--- | :--- |
| **开环滤波法** | 实现简单 | 存在非零平均跟踪误差 |
| **早迟门同步** | 相对容易实现 | 不适用于有大量连'0'或连'1'的比特同步 |
| **DTTL** | 性能好 | 实现不易 |

---

## 符号同步误差对BER性能的影响

![[Pasted image 20240101120026.png]]
*图：符号同步误差对BPSK系统BER性能的影响*

> [!summary] 结论
> - 从图中可以看出，当比特同步误差的方差（定时抖动）小于0.05T时，BER的性能下降小于1dB。
> - 当没有定时抖动时，为达到 $10^{-3}$ 的BER，所需SNR为6.7dB；如果定时抖动为0.1T，为达到同样的BER，所需SNR为12.9dB，性能恶化了6.2dB。定时抖动对系统性能影响巨大。
