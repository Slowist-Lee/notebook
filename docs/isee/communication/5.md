好的，这是根据您提供的幻灯片内容整理的Obsidian Markdown笔记。

---

# 讲座 4. 通信信道与信息论

**主讲人：An Liu 教授**
**单位：浙江大学信息与电子工程学院**

---

## 无线信道模型

### 通用三层模型

- 精确的传播特性很难获得，并且高度依赖于位置、环境等因素。

- **典型研究方法:**
    - 对特定类别的环境（如室内）进行场强测量
    - 模型拟合

- **三层模型:**
    1.  **路径损耗模型 (Path Loss Model)**
    2.  **阴影衰落 (Shadowing)**
    3.  **多径衰落 (Multipath Fading)**

![[Pasted image 20251013020308.png]]
*图示：接收功率随收发距离变化的三个层次*

### 模型用途总结

- **路径损耗模型用于:**
    - 系统规划，小区覆盖范围分析
    - 链路预算 (什么是频率复用因子?)

- **阴影衰落模型用于:**
    - 功率控制设计
    - 二阶干扰和发射功率分析
    - 更详细的链路预算和蜂窝覆盖分析

- **多径衰落模型用于:**
    - 物理层调制解调器设计 --- 编码器、调制器、交织器等

---

## 第一层：多径衰落 (Multipath Fading)

多径衰落，也称为小尺度衰落 (Small-scale Fading)。

- **物理原因:**
    - 由发射机(TX)和接收机(RX)之间具有**不同长度**（因此相位不同）的多条路径信号的**相长和相消干涉**引起。

![[Pasted image 20251013020320.png]]
*图示：多径传播与信号功率随位置的变化关系*

- **效果: 小尺度衰落**
    - **衰减:** 接收信号功率在约30 dB的范围内剧烈变化（该动态范围由瑞利衰落的概率密度函数驱动）。
    - **快速变化:** 信号在几个波长的距离内迅速变化。

> [!example] 波长计算示例
> 如果载波频率为 1 GHz，则波长为：
> $$
> \lambda = \frac{c}{f} = \frac{3 \times 10^8 \text{ m/s}}{1 \times 10^9 \text{ Hz}} = 0.3 \text{m} \approx 1 \text{ft}
> $$
> **对于1GHz的载波，波长大约是1英尺。**

### 多径瑞利衰落 (Multipath Rayleigh Fading)

![[Pasted image 20251013020330.png]]
*图 1.1: 接收信号的典型瑞利衰落包络和相位曲线。车辆移动站速度为30mph，载波频率为900MHz。*

### 瑞利衰落的进一步阐述

#### 1. 多径信道模型

> [!NOTE] 模型推导
> **射频(RF)域模型:**
> 发射信号 $s(t) = \text{Re}\{s_b(t)e^{j2\pi f_c t}\}$，信道冲激响应 $h(t) = \sum_{i=0}^{L-1} a_i \delta(t - \tau_i)$。
> 接收信号为：
> $$
> y(t) = \text{Re}\left\{\sum_{i=0}^{L-1} a_i s_b(t - \tau_i)e^{j2\pi f_c (t - \tau_i)}\right\}
> $$
>
> **基带域模型:**
> $$
> y_b(t) = \sum_{i=0}^{L-1} a_i s_b(t - \tau_i)e^{-j2\pi f_c \tau_i}
> $$

#### 2. 窄带系统信道模型
对于窄带系统，可以近似认为 $s_b(t - \tau_i) \approx s_b(t)$，则：
$$
y_b(t) \approx \left(\sum_{i=0}^{L-1} a_i e^{-j2\pi f_c \tau_i}\right) s_b(t) = h s_b(t)
$$
其中 $h$ 是 **信道衰落系数**:
$$
h = \sum_{i=0}^{L-1} a_i e^{-j2\pi f_c \tau_i} = h_I + h_Q j = a e^{j\phi}
$$

#### 3. 信道衰落系数的统计特性
- 根据中心极限定理，当路径数 $L$ 很大时，$h_I$ 和 $h_Q$ 是独立同分布的高斯随机变量：
  $$
  h_I, h_Q \sim \mathcal{N}\left(0, \frac{g}{2}\right) = \sqrt{g}\mathcal{N}\left(0, \frac{1}{2}\right) \quad \text{其中 } g = \sum_{i=0}^{L-1} |a_i|^2
  $$
- 幅度 $a$ 服从瑞利分布，相位 $\phi$ 服从均匀分布：
  $$
  f_A(a) = 2ae^{-a^2}, \quad f_{\Phi}(\phi) = \frac{1}{2\pi}
  $$

- **影响:** 深度衰落 (deep fading) & 分集 (diversity)

![[Pasted image 20251013020340.png]]
*图示：瑞利衰落的概率密度函数(左)和累积分布函数(右)*

### 瑞利衰落信道的影响
- **BER曲线平坦化:** 在高信噪比区域，误码率下降缓慢，形成平坦区域。
- **信噪比损失:** 在BER = $10^{-5}$ 时，SNR损失 > 30dB!!
- **解决方案 $\rightarrow$ 分集 (Diversity)**

![[Pasted image 20251013020348.png]]
*图示：不同分集阶数(D)下FSK, DPSK, PSK的BER性能曲线*

---

## 第二层：阴影衰落 (Shadowing)

- **原因:**
    - 由地形或障碍物（如树木、建筑物）的变化引起。
    - 例如：有许多高大建筑物的城市区域。
    - 例如：有大片开阔地的农村地区。
    - 例如：有低矮建筑的郊区。
- **效果:**
    - **信号功率的短期平均值**发生变化（在多径衰落被平均掉或移除后）。
    - 称为**阴影**或**阴影衰落**。
    - 通过在50-100个波长的距离上进行平均获得。

### 阴影效应的统计模型
1.  信号经历多次反射（功率衰减因子为 $a_i$）并穿过多个障碍物（衰减因子为 $b_i$）。
    ![[Pasted image 20251013020356.png]]

> [!NOTE] 模型推导
> 接收功率为：
> $$
> P_r = \left(\prod_{i=1}^{4} a_i \prod_{i=1}^{3} b_i\right) P_t
> $$
> 转换为dBm单位：
> $$
> \begin{align}
> P_r(\text{in dBm}) &= \sum_{i=1}^4 10\log(a_i) + \sum_{i=1}^3 10\log(b_i) + P_t(\text{in dBm}) \\
> &= \sum \alpha_i(\text{in dB}) + P_t(\text{in dBm})
> \end{align}
> $$

2.  每个衰减项 $\alpha_i$ (dB) 引入一个随机衰减，并假设它们是**统计独立**的。
3.  根据**中心极限定理**，当这些因子的数量增加时，总和 $S = \sum \alpha_i$ 接近一个高斯（正态）随机变量。
    $$
    P_r[\text{dBm}] = S[\text{dB}] + P_t[\text{dBm}] = m[\text{dB}] + X[\text{dB}] + P_t[\text{dBm}]
    $$
    其中 $S \sim \mathcal{N}(m, \sigma^2)$ 且 $X \sim \mathcal{N}(0, \sigma^2)$。
4.  均值 $m$ 通常包含在路径损耗模型中（这就是为什么路径损耗指数可以大于2，因为随着收发距离的增加，项数通常会增加）。

---

## 第三层：路径损耗模型 (Path Loss Model)

- **原因:**
    - 发射(TX)和接收(RX)天线之间的距离。
    - 障碍物和阻挡物（如墙壁）造成的损耗。
- **效果:**
    - 信号功率的**长期平均值**随收发天线之间距离的函数而**稳定下降**。

![[Pasted image 20251013020405.png]]

### 理想路径损耗模型
- **路径损耗指数 (n)** 表示信号功率随收发距离下降的速度。
    - “路径损耗指数 n = 2” 意味着距离每增加一倍，信号功率下降6dB。

![[Pasted image 20251013020412.png]]
*图示：理想路径损耗模型，信号随距离(对数尺度)线性下降*

### 传播机制
- **反射 (Reflection):** 电磁波撞击尺寸远大于波长 $\lambda$ 的物体时，部分能量会被物体表面反射。反射量取决于入射角、材料等。
- **衍射 (Diffraction):** 电磁波在锐利边缘（如街角）附近传播。
- **散射 (Scattering):** 电磁波穿过包含多个小物体（与 $\lambda$ 相比）的介质时发生。由粗糙表面、雨滴、灯柱等产生。

### 路径损耗指数
- 以dB为单位的路径损耗取决于收发距离，通过路径损耗指数 $n$ 和参考距离 $d_0$ 来描述。
  $$
  PL(d) \propto \left(\frac{d}{d_0}\right)^n
  $$
  $$
  PL(d) = PL(d_0) + 10n\log\left[\frac{d}{d_0}\right]
  $$

| 环境 | 路径损耗指数 (n) |
| :--- | :--- |
| 自由空间 | 2 |
| 城市蜂窝网络 | 2.7 to 3.5 |
| 有阴影的城市蜂窝网络 | 3 to 5 |
| 室内视距传输 | 1.6 to 1.8 |
| 室内有障碍物 | 4 to 6 |
| 工厂内有障碍物 | 2 to 3 |

---

## 组合模型与衰落总结

### 阴影与路径损耗的组合效应

- 结合路径损耗模型和阴影效应，距离 $d$ 处的总路径损耗 TPL(d) 是一个**随机变量**：
  $$
  TPL(d) = PL(d_0) + 10n\log\left(\frac{d}{d_0}\right) + X
  $$
- **其中:**
    - $n$ 是路径损耗指数。
    - $X \sim \mathcal{N}(0, \sigma^2)$，其中 $\sigma$ 是阴影因子的标准差。
    - TPL(d) 以dB表示。
- $\sigma$ 的典型值范围为 5-10dB。

### 衰落总结

#### 基于多径时延扩展的小尺度衰落

- **平坦衰落 (Flat Fading)**
    1.  信号带宽 < 信道带宽
    2.  时延扩展 < 符号周期
- **频率选择性衰落 (Frequency Selective Fading)**
    1.  信号带宽 > 信道带宽
    2.  时延扩展 > 符号周期

#### 基于多普勒扩展的小尺度衰落

- **快衰落 (Fast Fading)**
    1.  高多普勒扩展
    2.  相干时间 < 符号周期
    3.  信道变化快于基带信号变化
- **慢衰落 (Slow Fading)**
    1.  低多普勒扩展
    2.  相干时间 > 符号周期
    3.  信道变化慢于基带信号变化

![[Pasted image 20251013020421.png]]
*图示：四种衰落类型总结*

---

## 信息论与信道容量

### 信息论回顾

#### 熵 (Entropy)
- 衡量随机变量 $X$ 不确定性的度量。
- $X$ 的熵 $H(X)$ 定义为:
    - **离散随机变量:** 若 $X$ 的字母表为 $\mathcal{X}$，概率质量函数为 $p(x)$
      $$
      H(X) = -\sum_{x \in \mathcal{X}} p(x) \log p(x) = -E[\log p(x)]
      $$
    - **连续随机变量:** 若 $X$ 的概率密度函数为 $f(x)$
      $$
      h(X) = -\int f(x) \log f(x) dx
      $$
- **联合熵 (Joint Entropy):** $H(X_1, X_2) = -\sum_{x_1, x_2} p(x_1, x_2) \log p(x_1, x_2)$
- **条件熵 (Conditional Entropy):** $H(X_2|X_1) = -\sum_{x_1, x_2} p(x_1, x_2) \log p(x_2|x_1)$

#### 互信息 (Mutual Information)
- 考虑两个联合概率密度函数为 $p(x,y)$ 的随机变量 $X$ 和 $Y$。它们之间的互信息 $I(X;Y)$ 定义为：
  $$
  I(X;Y) = \sum_{x,y} p(x,y) \log \frac{p(x,y)}{p(x)p(y)} = E_{X,Y}\left[\log \frac{p(X,Y)}{p(X)p(Y)}\right]
  $$
- 互信息是由于知道了 $Y$ 而导致 $X$ 不确定性的减少量：
  $$
  I(X;Y) = H(X) - H(X|Y)
  $$
- 因此，互信息代表了传达给接收者的“信息量”。
  $X \longrightarrow Y$

![[Pasted image 20251013020431.png]]
*图示：熵与互信息关系的维恩图*

### 信道编码定理

![[Pasted image 20251013020438.png]]
*图示：通信系统模型*

1.  **可达速率 (Achievable rate):**
    - **定义:** 如果存在一个编码器（码本）$\{x^N(m)\}$ 和一个解码器 $g(y^N)$，使得当块长度 $N \to \infty$ 时，块错误概率 $\to 0$，则码率 $R$ 是**可达的**。

2.  **信道容量 (Channel Capacity) (离散无记忆信道):**
    - **定义:**
      $$
      C = \max_{p(X)} I(X;Y)
      $$

3.  **信道编码定理:**
    - 对于任意的 $\epsilon > 0$，速率 $R = C - \epsilon$ 是可达的。另一方面，如果 $R > C$，则该速率是不可达的。
    - 等价地说，可达速率集合的上确界由 $C$ 给出。

### 信道容量示例

#### 1. 二进制对称信道 (Binary Symmetric Channel, BSC)
- 输入 $X \in \{0,1\}$，输出 $Y \in \{0,1\}$
- 转移概率矩阵: $p(y|x) = \begin{bmatrix} 1-p & p \\ p & 1-p \end{bmatrix}$
- **信道容量:**
  $$
  C = \max_{p(x)} I(X;Y) \xrightarrow{p(0)=p(1)=0.5} 1 + p\log_2 p + (1-p)\log_2(1-p)
  $$

![[Pasted image 20251013020445.png]]

#### 2. AWGN 信道
- **连续输入 - 连续输出信道**，例如加性高斯白噪声(AWGN)信道。
  $y = x + z, \quad z \sim \mathcal{N}(0, \sigma_z^2)$
- **信道容量:**
  $$
  C = \max_{p(x)} I(X;Y) = 0.5 \log_2\left(1 + \frac{\sigma_x^2}{\sigma_z^2}\right)
  $$
  其中 $\sigma_x^2 = E[X^2]$ 是信号功率。

#### 3. 连续时间 AWGN 信道容量 (香农公式)
香农（1948）为加性高斯白噪声信道推导了以下容量公式：
$$
C = W \log_2 \left(1 + \frac{S}{N}\right) \quad [\text{bits/second}]
$$
- $W$ 是信道带宽 (Hz)。
- $S$ 是信号功率 (watts)。
- $N$ 是信道内的总噪声功率 (watts)。

#### 带宽效率 (Bandwidth Efficiency)
- 带宽效率 $\eta$ 表征了一个系统利用其分配带宽的效率。
  $$
  \eta = \frac{\text{传输速率}}{\text{信道带宽 } W} \quad [\text{bits/s/Hz}]
  $$
- 由此可以计算出香农极限：
  $$
  \eta_{\max} = \log_2\left(1 + \frac{S}{N}\right) \quad [\text{bits/s/Hz}]
  $$