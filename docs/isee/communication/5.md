好的，这是根据您提供的幻灯片内容整理的Obsidian Markdown笔记，遵循了您之前的所有要求。

---

# 讲座 5. 模拟通信 - 第二部分: 调频 (FM)

**主讲人：An Liu 教授**
**单位：浙江大学信息与电子工程学院**

---

## 动机 (Motivation)

在讨论调频（FM）之前，我们先回顾一下调幅（AM）的特点，以此作为引入FM的动机。

*   **调幅 (AM) 的优点:**
    *   （与FM相比）实现简单，带宽效率高。

*   **调幅 (AM) 的缺点:**
    *   **对放大器要求高**
        *   线性放大器在实际应用中难以实现。
    *   **保真度性能较低**
        *   在静默期间噪声会被增强。
        *   无法在带宽和保真度性能之间进行权衡。

---

## 角度调制 (Angle Modulation)

一个角度调制的信号可以写成通用形式：
$$
s_{\text{AnM}}(t) = A \cos(\Psi(t))
$$
其中：
*   $\Psi(t)$: **瞬时相位 (Instantaneous Phase)**
*   $f(t) = \frac{1}{2\pi} \frac{d\Psi(t)}{dt}$: **瞬时频率 (Instantaneous Frequency)**

对于一个典型的载波信号，其瞬时相位可以表示为：
$$
\Psi(t) = 2\pi f_c t + \theta(t)
$$
相应的瞬时频率为：
$$
f(t) = f_c + \frac{1}{2\pi} \frac{d\theta(t)}{dt}
$$

角度调制主要分为两种类型：

1.  **相位调制 (Phase Modulation, PM):**
    *   瞬时相位偏移 $\theta(t)$ 与消息信号 $s(t)$ 成正比。
    *   $\theta(t) = \alpha s(t)$
    *   PM 信号表达式: $s_{\text{PM}}(t) = A \cos(2\pi f_c t + \alpha s(t))$

2.  **频率调制 (Frequency Modulation, FM):**
    *   瞬时频率偏移与消息信号 $s(t)$ 成正比。
    *   $\frac{1}{2\pi} \frac{d\theta(t)}{dt} = k s(t)$
    *   FM 信号表达式: $s_{\text{FM}}(t) = A \cos\left(2\pi\left(f_c t + k \int_{-\infty}^{t} s(\tau)d\tau\right)\right)$

### 相位偏移与频率偏移

> [!NOTE] PM 信号的关键参数
> **PM 信号:** $s_{\text{PM}}(t) = A \cos(2\pi f_c t + \alpha s(t))$
> - **瞬时相位:** $\Psi(t) = 2\pi f_c t + \alpha s(t)$
> - **相位偏移 (Phase Deviation):** $|\alpha s(t)|$
> - **最大(峰值)相位偏移:** $\max_t |\alpha s(t)|$
> 
> **峰值相位偏移**代表了已调信号与载波信号之间的最大相位差。

> [!NOTE] FM 信号的关键参数
> **FM 信号:** $s_{\text{FM}}(t) = A \cos\left(2\pi\left(f_c t + k \int_{-\infty}^{t} s(\tau)d\tau\right)\right)$
> - **瞬时频率:** $f(t) = \frac{1}{2\pi} \frac{d\Psi(t)}{dt} = f_c + k s(t)$ Hz
> - **频率偏移 (Frequency Deviation):** $|k s(t)|$
> - **最大(峰值)频率偏移:** $\max_t |k s(t)|$
> 
> **峰值频率偏移**代表了瞬时频率与载波频率的最大偏离量。

### PM 与 FM 的关系

![[Pasted image 20251013023159.png]]

从上图可以看出一个非常重要的关系：
*   用一个消息信号 $s(t)$ 对载波进行**相位调制**，等效于用该消息信号的**导数** $\frac{ds(t)}{dt}$ 对载波进行**频率调制**。
*   在接下来的讨论中，我们将只关注 **FM**。

### FM 信号波形示例

下图展示了消息信号 $s(t)$ 和经过它调制后得到的 FM 信号 $s_{FM}(t)$ 的波形。

![[Pasted image 20251013023211.png]]
*图：FM 单音调制波形*

---

## 调频信号的频谱特性

### 一个错误的开始

我们先来看一个关于 FM 带宽的看似合理但实际上是错误的推断。

*   **FM 信号:** $s_{\text{FM}}(t) = A \cos\left(2\pi\left(f_c t + k \int_{-\infty}^{t} s(\tau)d\tau\right)\right)$
*   **瞬时频率:** $f(t) = f_c + k s(t)$

> [!CAUTION] 错误的推理过程
> 假设 $s(t)$ 的峰值幅度是 $m_s$。那么，已调信号的瞬时频率的最大值和最小值将分别是 $f_c + k m_s$ 和 $f_c - k m_s$。
> 
> 那么，FM 信号的频谱分量是否就应该在 $[f_c - k m_s, f_c + k m_s]$ 的频率范围内，带宽为 $2km_s$ 呢？
> 
> 如果这个推理成立，那么通过使用一个任意小的 $k$，我们似乎可以让 FM 信号的带宽变得任意小！
> 
> **这个推理的谬误在哪里？**
> 
> **瞬时频率**的范围**不等于**信号的**频谱宽度 (带宽)**。频谱是由信号的傅里叶变换决定的，它描述了信号包含的所有正弦频率分量，而不仅仅是瞬时频率的变化范围。

### FM 正弦信号分析

让我们假设消息信号 $s(t)$ 是一个正弦信号：
$$
s(t) = A_m \cos(2\pi f_m t)
$$
代入 FM 信号的表达式中：
$$
\begin{align}
s_{\text{FM}}(t) &= A \cos\left\{2\pi\left[f_c t + k \int_{-\infty}^{t} A_m \cos(2\pi f_m \tau)d\tau\right]\right\} \\
&= A \cos\left\{2\pi\left[f_c t + \frac{k A_m}{2\pi f_m} \sin(2\pi f_m t)\right]\right\} \\
&= A \cos\left[2\pi f_c t + \frac{\Delta f}{f_m} \sin(2\pi f_m t)\right] \\
&= A \cos[2\pi f_c t + \beta \sin(2\pi f_m t)]
\end{align}
$$
这里我们定义了两个关键参数：

1.  **峰值频率偏移 (Peak frequency deviation):**
    *   $\Delta f = k A_m$
    *   它与消息信号的幅度 $A_m$ 成正比。

2.  **调制指数 (Modulation index):**
    *   $\beta = \frac{\Delta f}{f_m}$

### FM 正弦信号的频谱

一个单音调制的 FM 信号可以展开为无穷傅里叶级数：
$$
s_{\text{FM}}(t) = A \cos[2\pi f_c t + \beta \sin(2\pi f_m t)] = A \sum_{n=-\infty}^{\infty} J_n(\beta) \cos[2\pi(f_c + n f_m)t]
$$
其中 $J_n(\beta)$ 被称为**第一类 n 阶贝塞尔函数**，其定义为：
$$
J_n(\beta) = \frac{1}{2\pi} \int_{-\pi}^{\pi} e^{j(\beta \sin x - nx)} dx
$$

#### 贝塞尔函数简介
![[Pasted image 20251013023223.png]]

*   **当 $\beta$ 很小时:** $J_n(\beta) \approx \frac{\beta^n}{2^n n!}$
*   **当 $\beta$ 很大时:** $J_n(\beta) \approx \sqrt{\frac{2}{\pi\beta}} \cos\left(\beta - \frac{\pi}{4} - \frac{n\pi}{2}\right)$
*   **对称性:** $J_{-n}(\beta) = (-1)^n J_n(\beta)$, 因此 $|J_{-n}(\beta)| = |J_n(\beta)|$

#### 幅度谱与功率谱
![[Pasted image 20251013023233.png]]
*图：FM 正弦信号的幅度谱*

从上图可以看出：
*   FM 信号的频谱由一个位于 $f_c$ 的载波分量和无数个边带分量组成。
*   边带成对出现在 $f_c \pm n f_m$ 的位置。
*   第 $n$ 对边带的幅度由 $|J_n(\beta)|$ 决定。
*   理论上，FM 正弦信号的**带宽是无限的**。

![[Pasted image 20251013023242.png]]
*图：FM 正弦信号的功率谱*

FM 信号的总功率是恒定的，等于调制前载波的功率：
$$
P_t = \frac{A^2}{2} \left[ J_0^2(\beta) + 2\sum_{n=1}^{\infty} J_n^2(\beta) \right] = \frac{A^2}{2}
$$
这得益于贝塞尔函数的性质： $J_0^2(\beta) + 2\sum_{n=1}^{\infty} J_n^2(\beta) = 1$。

### FM 信号的有效带宽 - 卡森法则 (Carson's Rule)

尽管理论带宽是无限的，但在实际中，当 $n$ 增大时，边带的幅度会迅速减小。我们可以定义一个包含大部分功率（例如98%）的**有效带宽**。

**卡森法则** 给出了一个广泛使用的估算 FM 信号有效带宽的经验公式：
$$
B_T \approx 2(\Delta f + f_m) = 2( \beta + 1)f_m
$$
根据调制指数 $\beta$ 的大小，我们可以区分：
*   **窄带 FM (Narrowband FM, NBFM):** $\beta \ll 1$，带宽 $B_T \approx 2f_m$ (与 AM 类似)。
*   **宽带 FM (Wideband FM, WBFM):** $\beta$ 较大，带宽 $B_T \approx 2\Delta f$。

---

## FM 的带宽效率与优缺点

### 带宽效率 (Bandwidth Efficiency)

我们回顾一下带宽效率的定义：
$$
\gamma = \frac{\text{信息信号带宽}}{\text{已调信号带宽}}
$$
*   **AM-DSB-SC 的带宽效率:** $\gamma_{\text{AM-DSB-SC}} = \frac{B_s}{2B_s} = 50\%$

*   **FM 信号的带宽效率:**
    $$
    \gamma_{\text{FM}} = \frac{B_s}{2(1+\beta)B_s} = \frac{1}{2(1+\beta)} < 50\%
    $$
*   结论：FM 系统的带宽效率**低于** AM 系统。

### 带宽与保真度的权衡

尽管 FM 带宽效率低，但它提供了一个 AM 无法实现的优势：
*   **通过牺牲带宽效率来换取更好的保真度性能。**
*   当调制指数 $\beta$ 增大时：
    *   带宽效率 $\gamma_{FM}$ **降低**。
    *   保真度性能（抗噪声能力）**提升**。

### FM 的优缺点总结

*   **优点 (Pros):**
    1.  **对放大器要求低**，因为 FM 信号是恒定包络的。
    2.  可以在**信道带宽和保真度性能之间进行灵活的权衡**。

*   **缺点 (Cons):**
    1.  **带宽效率低**。

---

## FM 调制器与解调器

> [!INFO] FM 之父
> 现代 FM 广播技术的发明者是 **埃德温·霍华德·阿姆斯特朗 (Edwin Howard Armstrong)**。
> ![[Pasted image 20251013023253.png]]

### FM 调制器

#### 1. 直接调频 (Direct FM)
*   通过一个振荡频率可控的正弦振荡器电路来产生。例如，使用一个压控振荡器 (VCO)。
*   下图展示了一个通过调节可变电容 $C_v$ 来改变 LC 谐振电路频率的例子。
    ![[Pasted image 20251013023301.png]]
*   **缺点：** 难以构建能够被精确电压控制且高度稳定的振荡器。因此，直接调频不常用于广播发射机，主要用于对频率稳定性要求不高的场合（如无线电遥控）。

#### 2. 间接调频 (Indirect FM) - 阿姆斯特朗法
*   这是更广泛采用的方法，因为它更容易实现，且频率稳定性高。
*   主要包含两个步骤：
    1.  首先生成一个高度稳定的**窄带 FM (NBFM)** 信号（$\beta \ll 1$），这不需要压控振荡器。
    2.  然后使用**倍频器 (Frequency Multiplier)** 来增大调制指数 $\beta$，同时进行频率搬移和带宽扩展，得到宽带 FM 信号。

##### 窄带 FM (NBFM) 调制器
当 $\theta(t) = 2\pi k \int s(\tau)d\tau$ 很小时，可以做近似：
$\cos(\theta(t)) \approx 1$ 且 $\sin(\theta(t)) \approx \theta(t)$。
$$
\begin{align}
s_{\text{FM}}(t) &= A\cos(2\pi f_c t)\cos(\theta(t)) - A\sin(2\pi f_c t)\sin(\theta(t)) \\
&\approx A\cos(2\pi f_c t) - A\theta(t)\sin(2\pi f_c t) \\
&\approx A\cos(2\pi f_c t) - A \sin(2\pi f_c t) \left(2\pi k \int_{-\infty}^{t} s(\tau)d\tau \right)
\end{align}
$$
这个近似的 NBFM 信号可以通过以下 **阿姆斯特朗调制器** 结构来产生：
![[Pasted image 20251013023311.png]]

##### 倍频器 (Frequency Multiplier)
*   阿姆斯特朗调制器的主要优点是频率稳定性高，但它只能产生小 $\beta$ 的信号。
*   对于大 $\beta$，可以在其输出端使用倍频器。
*   例如，一个**倍频系数为2的倍频器** (doubler) 可以定义为 $e_o(t) = e_i^2(t)$。
    如果输入 $e_i(t) = \cos(2\pi f_c t + \beta \sin(2\pi f_m t))$，则输出为：
    $$
    e_o(t) = \cos^2(2\pi f_c t + \beta \sin(2\pi f_m t)) = 0.5[1 + \cos(2 \times 2\pi f_c t + 2 \times \beta \sin(2\pi f_m t))]
    $$
*   可以看到，载波频率 $f_c$ 和调制指数 $\beta$ **都被加倍了**。通过级联多个倍频器可以实现更大的倍频系数。

### FM 解调器：斜率检测法 (Slope Detection)

*   对 FM 信号求导：
    $$
    \begin{align}
    \frac{d s_{\text{FM}}(t)}{dt} &= \frac{d}{dt} \left[A \cos\left(2\pi f_c t + \theta(t)\right)\right] \\
    &= -A \sin\left(2\pi f_c t + \theta(t)\right) \cdot (2\pi f_c + 2\pi k s(t))
    \end{align}
    $$
*   这个新信号的**包络**是 $A(2\pi f_c + 2\pi k s(t))$。
*   这个包络是一个直流分量 $A \cdot 2\pi f_c$ 叠加上一个与原始消息信号 $s(t)$ 成比例的项。
*   因此，我们可以通过**包络检波**，然后**去除直流分量**来恢复原始信号 $s(t)$。

---

## FM 与 AM 总结对比

| | 复杂度 | 带宽效率 | 保真度 (以输出SNR评估) |
| :--- | :--- | :--- | :--- |
| **AM** | | | |
| DSB-SC | 高 | 50% | $\sim P_t$ |
| DSB-C | 低 | 50% | (DSB-C 的 SNR 较低) |
| SSB | 高 | 100% | |
| VSB | 高 | $50\% < \frac{B_s}{B_s+\Delta} < 100\%$ | |
| **FM** | 中等 | $\frac{B_s}{2(1+\beta)B_s} < 50\%$ | $\sim P_t, \sim \beta^2$ |

**核心结论：FM 通过牺牲更多的带宽，换来了更好的保真度性能。**